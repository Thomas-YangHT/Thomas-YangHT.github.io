<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta content="text/html; charset=UTF-8" http-equiv="Content-Type"/>

    <title>OpenStack Docs: Trunking</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Bootstrap CSS -->
<link href="_static/css/bootstrap.css" rel="stylesheet">

<!-- Pygments CSS -->
<link href="_static/css/native.css" rel="stylesheet">

<!-- Fonts -->
<link href="_static/css/font-awesome.css" rel="stylesheet">
<link href='https://fonts.googleapis.com/css?family=Open+Sans:300,400,700' rel='stylesheet' type='text/css'>

<!-- Custom CSS -->
<link href="_static/css/combined.css" rel="stylesheet">
<link href="_static/css/styles.css" rel="stylesheet">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->
<link rel="stylesheet" href="_static/sphinxmark.css" type="text/css" />
  


<!-- Google Analytics -->
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-17511903-1', 'auto');
ga('send', 'pageview');
</script>
<!-- End Google Analytics -->

  </head>
  <body>
<nav class="navbar navbar-default inner" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button class="navbar-toggle" data-target="#bs-example-navbar-collapse-1" data-toggle="collapse" type="button">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <div class="brand-wrapper">
        <a class="navbar-brand" href="https://docs.openstack.org/"></a>
      </div>
      <div class="search-icon show"><i class="fa fa-search"></i> Search</div></div>
      <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <div class="search-container tiny">
        <div id="gcse">
          <script type="text/javascript">
(function() {
  var cx = '000108871792296872333:noj9nikm74i';
  var gcse = document.createElement('script');
  gcse.type = 'text/javascript';
  gcse.async = true;
  gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
      '//www.google.com/cse/cse.js?cx=' + cx;
  var s = document.getElementsByTagName('script')[0];
  s.parentNode.insertBefore(gcse, s);
})();
          </script>
          <gcse:search gname="standard"></gcse:search>
        </div>
        <i class="fa fa-times close-search"></i>
      </div>
      <ul class="nav navbar-nav navbar-main show">
        <li>
          <div id="gcse-mobile">
            <gcse:search gname="mobile"></gcse:search>
          </div>
        </li>
        <li>
          <a href="http://www.openstack.org/software/" class="drop" id="dropdownMenuSoftware">Software <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuSoftware">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/">Overview</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/project-navigator/">Project Navigator</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/sample-configs/">Sample Configs</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/software/security/">Security</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/start/">Get Started</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/roadmap/">Roadmap</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/latest-release/">Latest Release</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/sourcecode/">Source Code</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/user-stories/" class="drop" id="dropdownMenuUsers">Users <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuUsers">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/user-stories/">Overview</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/telecoms-and-nfv/">Telecoms and NFV</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/enterprise/">OpenStack in the Enterprise</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/appdev/">Application Developers & ISVs</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://superuser.openstack.org/">Superuser Magazine</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/surveys/landing">User Survey</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/community/" class="drop" id="dropdownMenuCommunity">Community <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuCommunity">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/">Welcome! Start Here</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/foundation/">OpenStack Foundation</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://wiki.openstack.org">OpenStack Wiki</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://groups.openstack.org">User Groups</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/speakers/">Speakers Bureau</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/foundation/companies/">Supporting Companies</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/jobs/">Jobs</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/join/">Join The Community</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/marketplace/">Marketplace</a>
        </li>
        <li>
          <a href="http://www.openstack.org/events/" class="drop" id="dropdownMenuEvents">Events <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuEvents">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/community/events/">Overview</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/summit/">The OpenStack Summit</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/community/events/">More OpenStack Events</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/events/#openstack_days">OpenStack Days</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/learn/" class="drop" id="dropdownMenuLearn">Learn <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu dropdown-hover" role="menu" aria-labelledby="dropdownMenuEvents">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/marketplace/training/">Training</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/marketplace/coa/">Get Certified</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://ask.openstack.org/">Ask a Technical Question</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://superuser.openstack.org/">Superuser Magazine</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/videos/">Summit Videos</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/analysts/">Analyst Reports</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/news/">News</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/blog/">Blog</a></li>
          </ul>
        </li>
        <li>
          <a href="http://docs.openstack.org/">Docs</a>
        </li>
      </ul>
    </div>
  </div>
</nav>
    <div class="container docs-book-wrapper">
      <div class="row">
        <div class="col-lg-9 col-md-8 col-sm-8 col-lg-push-3 col-md-push-4 col-sm-push-4">
<div class="row">
  <div class="col-lg-8">
      <h2>Trunking</h2>
    
  </div>
  <div class="docs-actions">
    
    <a href="config-service-subnets.html"><i class="fa fa-angle-double-left" data-toggle="tooltip" data-placement="top" title="Previous: Service subnets"></i></a>
    
    
    <a href="deploy.html"><i class="fa fa-angle-double-right" data-toggle="tooltip" data-placement="top" title="Next: Deployment examples"></i></a>
    
    <a id="logABugLink1" href="config-trunking.html" target="_blank" title="Found an error? Report a bug against this page"><i class="fa fa-bug" data-toggle="tooltip" data-placement="top" title="Report a Bug"></i></a>
  </div>
</div>
          <div class="row docs-byline">
            <div class="docs-updated">updated: 2018-02-08 07:39</div>
          </div>
          <div class="row">
            <div class="col-lg-12">
              <div class="docs-top-contents">

<h5><a href="index.html">Contents</a></h5>
<ul>
<li><a class="reference internal" href="config-trunking.html#">Trunking</a><ul>
<li><a class="reference internal" href="config-trunking.html#operation">Operation</a></li>
<li><a class="reference internal" href="config-trunking.html#example-configuration">Example configuration</a><ul>
<li><a class="reference internal" href="config-trunking.html#controller-node">Controller node</a></li>
<li><a class="reference internal" href="config-trunking.html#verify-service-operation">Verify service operation</a></li>
<li><a class="reference internal" href="config-trunking.html#workflow">Workflow</a></li>
<li><a class="reference internal" href="config-trunking.html#create-networks-and-subnets-for-the-trunk-and-subports">Create networks and subnets for the trunk and subports</a></li>
<li><a class="reference internal" href="config-trunking.html#create-the-trunk">Create the trunk</a></li>
<li><a class="reference internal" href="config-trunking.html#add-subports-to-the-trunk">Add subports to the trunk</a></li>
<li><a class="reference internal" href="config-trunking.html#launch-an-instance-on-the-trunk">Launch an instance on the trunk</a></li>
</ul>
</li>
<li><a class="reference internal" href="config-trunking.html#using-trunks-and-subports-inside-an-instance">Using trunks and subports inside an instance</a></li>
<li><a class="reference internal" href="config-trunking.html#trunk-states">Trunk states</a></li>
<li><a class="reference internal" href="config-trunking.html#limitations-and-issues">Limitations and issues</a></li>
</ul>
</li>
</ul>

              </div>
              <div class="docs-body">

  <div class="section" id="trunking">
<span id="config-trunking"></span><h1>Trunking<a class="headerlink" href="config-trunking.html#trunking" title="Permalink to this headline">¶</a></h1>
<p>The network trunk service allows multiple networks to be connected to an
instance using a single virtual NIC (vNIC). Multiple networks can be presented
to an instance by connecting it to a single port.</p>
<div class="section" id="operation">
<h2>Operation<a class="headerlink" href="config-trunking.html#operation" title="Permalink to this headline">¶</a></h2>
<p>Network trunking consists of a service plug-in and a set of drivers that
manage trunks on different layer-2 mechanism drivers. Users can create a
port, associate it with a trunk, and launch an instance on that port. Users
can dynamically attach and detach additional networks without disrupting
operation of the instance.</p>
<p>Every trunk has a parent port and can have any number of subports.
The parent port is the port that the trunk is associated with. Users
create instances and specify the parent port of the trunk when launching
instances attached to a trunk.</p>
<p>The network presented by the subport is the network of the associated
port. When creating a subport, a <code class="docutils literal"><span class="pre">segmentation-id</span></code> may be required by
the driver. <code class="docutils literal"><span class="pre">segmentation-id</span></code> defines the segmentation ID on which the
subport network is presented to the instance. <code class="docutils literal"><span class="pre">segmentation-type</span></code> may be
required by certain drivers like OVS, although at this time only <code class="docutils literal"><span class="pre">vlan</span></code> is
supported as a <code class="docutils literal"><span class="pre">segmentation-type</span></code>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <code class="docutils literal"><span class="pre">segmentation-type</span></code> and <code class="docutils literal"><span class="pre">segmentation-id</span></code> parameters are optional
in the Networking API. However, all drivers as of the Newton release
require both to be provided when adding a subport to a trunk. Future
drivers may be implemented without this requirement.</p>
</div>
<p>The <code class="docutils literal"><span class="pre">segmentation-type</span></code> and <code class="docutils literal"><span class="pre">segmentation-id</span></code> specified by the user on the
subports is intentionally decoupled from the <code class="docutils literal"><span class="pre">segmentation-type</span></code> and ID of
the networks. For example, it is possible to configure the Networking service
with <code class="docutils literal"><span class="pre">tenant_network_types</span> <span class="pre">=</span> <span class="pre">vxlan</span></code> and still create subports with
<code class="docutils literal"><span class="pre">segmentation_type</span> <span class="pre">=</span> <span class="pre">vlan</span></code>. The Networking service performs remapping as
necessary.</p>
</div>
<div class="section" id="example-configuration">
<h2>Example configuration<a class="headerlink" href="config-trunking.html#example-configuration" title="Permalink to this headline">¶</a></h2>
<p>The ML2 plug-in supports trunking with the following mechanism drivers:</p>
<ul class="simple">
<li>Open vSwitch (OVS)</li>
<li>Linux bridge</li>
<li>Open Virtual Network (OVN)</li>
</ul>
<p>When using a <code class="docutils literal"><span class="pre">segmentation-type</span></code> of <code class="docutils literal"><span class="pre">vlan</span></code>, the OVS and Linux bridge
drivers present the network of the parent port as the untagged VLAN and all
subports as tagged VLANs.</p>
<div class="section" id="controller-node">
<h3>Controller node<a class="headerlink" href="config-trunking.html#controller-node" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">In the <code class="docutils literal"><span class="pre">neutron.conf</span></code> file, enable the trunk service plug-in:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="k">[DEFAULT]</span>
<span class="na">service_plugins</span> <span class="o">=</span> <span class="s">trunk</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="verify-service-operation">
<h3>Verify service operation<a class="headerlink" href="config-trunking.html#verify-service-operation" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li>Source the administrative project credentials and list the enabled
extensions.</li>
<li>Use the command <strong class="command">openstack extension list --network</strong> to verify
that the <code class="docutils literal"><span class="pre">Trunk</span> <span class="pre">Extension</span></code> and <code class="docutils literal"><span class="pre">Trunk</span> <span class="pre">port</span> <span class="pre">details</span></code> extensions are
enabled.</li>
</ol>
</div>
<div class="section" id="workflow">
<h3>Workflow<a class="headerlink" href="config-trunking.html#workflow" title="Permalink to this headline">¶</a></h3>
<p>At a high level, the basic steps to launching an instance on a trunk are
the following:</p>
<ol class="arabic simple">
<li>Create networks and subnets for the trunk and subports</li>
<li>Create the trunk</li>
<li>Add subports to the trunk</li>
<li>Launch an instance on the trunk</li>
</ol>
</div>
<div class="section" id="create-networks-and-subnets-for-the-trunk-and-subports">
<h3>Create networks and subnets for the trunk and subports<a class="headerlink" href="config-trunking.html#create-networks-and-subnets-for-the-trunk-and-subports" title="Permalink to this headline">¶</a></h3>
<p>Create the appropriate networks for the trunk and subports that will be added
to the trunk. Create subnets on these networks to ensure the desired layer-3
connectivity over the trunk.</p>
</div>
<div class="section" id="create-the-trunk">
<h3>Create the trunk<a class="headerlink" href="config-trunking.html#create-the-trunk" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">Create a parent port for the trunk.</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> openstack port create --network project-net-A trunk
<span class="go">+-------------------+------------------------------------------------------------------------+</span>
<span class="go">| Field             | Value                                                                  |</span>
<span class="go">+-------------------+------------------------------------------------------------------------+</span>
<span class="go">| admin_state_up    | UP                                                                     |</span>
<span class="go">| binding_vif_type  | unbound                                                                |</span>
<span class="go">| binding_vnic_type | normal                                                                 |</span>
<span class="go">| fixed_ips         | ip_address=&#39;192.0.2.7&#39;,subnet_id=&#39;8b957198-d3cf-4953-8449-ad4e4dd712cc&#39; |</span>
<span class="go">| id                | 73fb9d54-43a7-4bb1-a8dc-569e0e0a0a38                                   |</span>
<span class="go">| mac_address       | fa:16:3e:dd:c4:d1                                                      |</span>
<span class="go">| name              | trunk                                                                  |</span>
<span class="go">| network_id        | 1b47d3e7-cda5-48e4-b0c8-d20bd7e35f55                                   |</span>
<span class="go">+-------------------+------------------------------------------------------------------------+</span>
</pre></div>
</div>
</li>
<li><p class="first">Create the trunk using <code class="docutils literal"><span class="pre">--parent-port</span></code> to reference the port from
the previous step:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> openstack network trunk create --parent-port 73fb9d54-43a7-4bb1-a8dc-569e0e0a0a38 trunk
<span class="go">+-----------------+--------------------------------------+</span>
<span class="go">| Field           | Value                                |</span>
<span class="go">+-----------------+--------------------------------------+</span>
<span class="go">| admin_state_up  | UP                                   |</span>
<span class="go">| id              | fdf02fcb-1844-45f1-9d9b-e4c2f522c164 |</span>
<span class="go">| name            | trunk                                |</span>
<span class="go">| port_id         | 73fb9d54-43a7-4bb1-a8dc-569e0e0a0a38 |</span>
<span class="go">| sub_ports       |                                      |</span>
<span class="go">+-----------------+--------------------------------------+</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="add-subports-to-the-trunk">
<h3>Add subports to the trunk<a class="headerlink" href="config-trunking.html#add-subports-to-the-trunk" title="Permalink to this headline">¶</a></h3>
<p>Subports can be added to a trunk in two ways: creating the trunk with subports
or adding subports to an existing trunk.</p>
<ul>
<li><p class="first">Create trunk with subports:</p>
<p>This method entails creating the trunk with subports specified at trunk
creation.</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> openstack port create --network project-net-A trunk-parent
<span class="go">+-------------------+------------------------------------------------------------------------+</span>
<span class="go">| Field             | Value                                                                  |</span>
<span class="go">+-------------------+------------------------------------------------------------------------+</span>
<span class="go">| admin_state_up    | UP                                                                     |</span>
<span class="go">| binding_vif_type  | unbound                                                                |</span>
<span class="go">| binding_vnic_type | normal                                                                 |</span>
<span class="go">| fixed_ips         | ip_address=&#39;192.0.2.7&#39;,subnet_id=&#39;8b957198-d3cf-4953-8449-ad4e4dd712cc&#39; |</span>
<span class="go">| id                | 73fb9d54-43a7-4bb1-a8dc-569e0e0a0a38                                   |</span>
<span class="go">| mac_address       | fa:16:3e:dd:c4:d1                                                      |</span>
<span class="go">| name              | trunk-parent                                                           |</span>
<span class="go">| network_id        | 1b47d3e7-cda5-48e4-b0c8-d20bd7e35f55                                   |</span>
<span class="go">+-------------------+------------------------------------------------------------------------+</span>

<span class="gp">$</span> openstack port create --network trunked-net subport1
<span class="go">+-------------------+------------------------------------------------------------------------+</span>
<span class="go">| Field             | Value                                                                  |</span>
<span class="go">+-------------------+------------------------------------------------------------------------+</span>
<span class="go">| admin_state_up    | UP                                                                     |</span>
<span class="go">| binding_vif_type  | unbound                                                                |</span>
<span class="go">| binding_vnic_type | normal                                                                 |</span>
<span class="go">| fixed_ips         | ip_address=&#39;192.0.2.8&#39;,subnet_id=&#39;2a860e2c-922b-437b-a149-b269a8c9b120&#39; |</span>
<span class="go">| id                | 91f9dde8-80a4-4506-b5da-c287feb8f5d8                                   |</span>
<span class="go">| mac_address       | fa:16:3e:ba:f0:4d                                                      |</span>
<span class="go">| name              | subport1                                                               |</span>
<span class="go">| network_id        | aef78ec5-16e3-4445-b82d-b2b98c6a86d9                                   |</span>
<span class="go">+-------------------+------------------------------------------------------------------------+</span>

<span class="gp">$</span> openstack network trunk create <span class="se">\</span>
  --parent-port 73fb9d54-43a7-4bb1-a8dc-569e0e0a0a38 <span class="se">\</span>
  --subport <span class="nv">port</span><span class="o">=</span>91f9dde8-80a4-4506-b5da-c287feb8f5d8, <span class="se">\</span>
  segmentation-type<span class="o">=</span>vlan,segmentation-id<span class="o">=</span><span class="m">100</span>
<span class="go">+----------------+-------------------------------------------------------------------------------------------------+</span>
<span class="go">| Field          | Value                                                                                           |</span>
<span class="go">+----------------+-------------------------------------------------------------------------------------------------+</span>
<span class="go">| admin_state_up | UP                                                                                              |</span>
<span class="go">| id             | 61d8e620-fe3a-4d8f-b9e6-e1b0dea6d9e3                                                            |</span>
<span class="go">| name           | trunk                                                                                           |</span>
<span class="go">| port_id        | 73fb9d54-43a7-4bb1-a8dc-569e0e0a0a38                                                            |</span>
<span class="go">| sub_ports      | port_id=&#39;73fb9d54-43a7-4bb1-a8dc-569e0e0a0a38&#39;, segmentation_id=&#39;100&#39;, segmentation_type=&#39;vlan&#39; |</span>
<span class="go">+----------------+-------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</li>
<li><p class="first">Add subports to an existing trunk:</p>
<p>This method entails creating a trunk, then adding subports to the trunk
after it has already been created.</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> openstack network trunk <span class="nb">set</span> --subport <span class="se">\</span>
  <span class="nv">port</span><span class="o">=</span>91f9dde8-80a4-4506-b5da-c287feb8f5d8, <span class="se">\</span>
  segmentation-type<span class="o">=</span>vlan, <span class="se">\</span>
  segmentation-id<span class="o">=</span><span class="m">100</span> 61d8e620-fe3a-4d8f-b9e6-e1b0dea6d9e3
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The command provides no output.</p>
</div>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> openstack network trunk show 61d8e620-fe3a-4d8f-b9e6-e1b0dea6d9e3
<span class="go">+----------------+-------------------------------------------------------------------------------------------------+</span>
<span class="go">| Field          | Value                                                                                           |</span>
<span class="go">+----------------+-------------------------------------------------------------------------------------------------+</span>
<span class="go">| admin_state_up | UP                                                                                              |</span>
<span class="go">| id             | 61d8e620-fe3a-4d8f-b9e6-e1b0dea6d9e3                                                            |</span>
<span class="go">| name           | trunk                                                                                           |</span>
<span class="go">| port_id        | 73fb9d54-43a7-4bb1-a8dc-569e0e0a0a38                                                            |</span>
<span class="go">| sub_ports      | port_id=&#39;73fb9d54-43a7-4bb1-a8dc-569e0e0a0a38&#39;, segmentation_id=&#39;100&#39;, segmentation_type=&#39;vlan&#39; |</span>
<span class="go">+----------------+-------------------------------------------------------------------------------------------------+</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="launch-an-instance-on-the-trunk">
<h3>Launch an instance on the trunk<a class="headerlink" href="config-trunking.html#launch-an-instance-on-the-trunk" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p class="first">Show trunk details to get the <code class="docutils literal"><span class="pre">port_id</span></code> of the trunk.</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> openstack network trunk show 61d8e620-fe3a-4d8f-b9e6-e1b0dea6d9e3
<span class="go">+----------------+--------------------------------------+</span>
<span class="go">| Field          | Value                                |</span>
<span class="go">+----------------+--------------------------------------+</span>
<span class="go">| admin_state_up | UP                                   |</span>
<span class="go">| id             | 61d8e620-fe3a-4d8f-b9e6-e1b0dea6d9e3 |</span>
<span class="go">| name           | trunk                                |</span>
<span class="go">| port_id        | 73fb9d54-43a7-4bb1-a8dc-569e0e0a0a38 |</span>
<span class="go">| sub_ports      |                                      |</span>
<span class="go">+----------------+--------------------------------------+</span>
</pre></div>
</div>
</li>
<li><p class="first">Launch the instance by specifying <code class="docutils literal"><span class="pre">port-id</span></code> using the value of <code class="docutils literal"><span class="pre">port_id</span></code>
from the trunk details. Launching an instance on a subport is not supported.</p>
</li>
</ul>
</div>
</div>
<div class="section" id="using-trunks-and-subports-inside-an-instance">
<h2>Using trunks and subports inside an instance<a class="headerlink" href="config-trunking.html#using-trunks-and-subports-inside-an-instance" title="Permalink to this headline">¶</a></h2>
<p>When configuring instances to use a subport, ensure that the interface on the
instance is set to use the MAC address assigned to the port by the Networking
service. Instances are not made aware of changes made to the trunk after they
are active. For example, when a subport with a <code class="docutils literal"><span class="pre">segmentation-type</span></code> of
<code class="docutils literal"><span class="pre">vlan</span></code> is added to a trunk, any operations specific to the instance operating
system that allow the instance to send and receive traffic on the new VLAN must
be handled outside of the Networking service.</p>
<p>When creating subports, the MAC address of the trunk parent port can be set
on the subport. This will allow VLAN subinterfaces inside an instance launched
on a trunk to be configured without explicitly setting a MAC address. Although
unique MAC addresses can be used for subports, this can present issues with
ARP spoof protections and the native OVS firewall driver. If the native OVS
firewall driver is to be used, we recommend that the MAC address of the parent
port be re-used on all subports.</p>
</div>
<div class="section" id="trunk-states">
<h2>Trunk states<a class="headerlink" href="config-trunking.html#trunk-states" title="Permalink to this headline">¶</a></h2>
<ul>
<li><p class="first"><code class="docutils literal"><span class="pre">ACTIVE</span></code></p>
<p>The trunk is <code class="docutils literal"><span class="pre">ACTIVE</span></code> when both the logical and physical resources have
been created. This means that all operations within the Networking and
Compute services have completed and the trunk is ready for use.</p>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">DOWN</span></code></p>
<p>A trunk is <code class="docutils literal"><span class="pre">DOWN</span></code> when it is first created without an instance launched on
it, or when the instance associated with the trunk has been deleted.</p>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">DEGRADED</span></code></p>
<p>A trunk can be in a <code class="docutils literal"><span class="pre">DEGRADED</span></code> state when a temporary failure during
the provisioning process is encountered. This includes situations where a
subport add or remove operation fails. When in a degraded state, the trunk
is still usable and some subports may be usable as well. Operations that
cause the trunk to go into a <code class="docutils literal"><span class="pre">DEGRADED</span></code> state can be retried to fix
temporary failures and move the trunk into an <code class="docutils literal"><span class="pre">ACTIVE</span></code> state.</p>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">ERROR</span></code></p>
<p>A trunk is in <code class="docutils literal"><span class="pre">ERROR</span></code> state if the request leads to a conflict or an
error that cannot be fixed by retrying the request. The <code class="docutils literal"><span class="pre">ERROR</span></code> status
can be encountered if the network is not compatible with the trunk
configuration or the binding process leads to a persistent failure. When
a trunk is in <code class="docutils literal"><span class="pre">ERROR</span></code> state, it must be brought to a sane state
(<code class="docutils literal"><span class="pre">ACTIVE</span></code>), or else requests to add subports will be rejected.</p>
</li>
<li><p class="first"><code class="docutils literal"><span class="pre">BUILD</span></code></p>
<p>A trunk is in <code class="docutils literal"><span class="pre">BUILD</span></code> state while the resources associated with the
trunk are in the process of being provisioned. Once the trunk and all of
the subports have been provisioned successfully, the trunk transitions
to <code class="docutils literal"><span class="pre">ACTIVE</span></code>. If there was a partial failure, the trunk transitions
to <code class="docutils literal"><span class="pre">DEGRADED</span></code>.</p>
<p>When <code class="docutils literal"><span class="pre">admin_state</span></code> is set to <code class="docutils literal"><span class="pre">DOWN</span></code>, the user is blocked from performing
operations on the trunk. <code class="docutils literal"><span class="pre">admin_state</span></code> is set by the user and should not be
used to monitor the health of the trunk.</p>
</li>
</ul>
</div>
<div class="section" id="limitations-and-issues">
<h2>Limitations and issues<a class="headerlink" href="config-trunking.html#limitations-and-issues" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>See <a class="reference external" href="https://bugs.launchpad.net/neutron/+bugs?field.tag=trunk">bugs</a> for
more information.</li>
</ul>
</div>
</div>


              </div>
            </div>
          </div>
          <div class="docs-actions">
          
            <a href="config-service-subnets.html"><i class="fa fa-angle-double-left" data-toggle="tooltip" data-placement="top" title="Previous: Service subnets"></i></a>
          
          
            <a href="deploy.html"><i class="fa fa-angle-double-right" data-toggle="tooltip" data-placement="top" title="Next: Deployment examples"></i></a>
          
            <a id="logABugLink3" href="config-trunking.html" target="_blank" title="Found an error? Report a bug against this page"><i class="fa fa-bug" data-toggle="tooltip" data-placement="top" title="Report a Bug"></i></a>
          </div>
          <div class="row docs-byline bottom">
            <div class="docs-updated">updated: 2018-02-08 07:39</div>
          </div>
          <div class="row">
            <div class="col-lg-8 col-md-8 col-sm-8 docs-license">
<a href="https://creativecommons.org/licenses/by/3.0/">
 <img src="_static/images/docs/license.png" alt="Creative Commons Attribution 3.0 License"/>
</a>
<p>
 Except where otherwise noted, this document is licensed under
 <a href="https://creativecommons.org/licenses/by/3.0/">Creative Commons
 Attribution 3.0 License</a>. See all <a href="http://www.openstack.org/legal">
 OpenStack Legal Documents</a>.
</p>
            </div>
            <div class="col-lg-4 col-md-4 col-sm-4 docs-actions-wrapper">
            <!-- ID buglinkbottom added so that pre-filled doc bugs
                 are sent to Launchpad projects related to the document -->
              <a href="config-trunking.html#" id="logABugLink2" class="docs-footer-actions"><i class="fa fa-bug"></i> found an error? report a bug</a>
              <a href="http://ask.openstack.org" class="docs-footer-actions"><i class="fa fa-question-circle"></i> questions?</a>
            </div>
          </div>
        </div>
<div class="col-lg-3 col-md-4 col-sm-4 col-lg-pull-9 col-md-pull-8 col-sm-pull-8 docs-sidebar">
  <div class="btn-group docs-sidebar-releases">
    <button onclick="location.href='/'" class="btn docs-sidebar-home" data-toggle="tooltip" data-placement="top" title="Docs Home"><i class="fa fa-arrow-circle-o-left"></i></button>
<button href="#" type="button" data-toggle="dropdown" class="btn docs-sidebar-release-select">OpenStack Documentation<i class="fa fa-caret-down"></i></button>
    <ul class="dropdown-menu docs-sidebar-dropdown" role="menu" aria-labelledby="dLabel">
      <li role="presentation" class="dropdown-header">Guides</li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#install-guides">Install Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#user-guides">User Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#configuration-guides">Configuration Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#ops-and-admin-guides">Operations and Administration Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#api-guides">API Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#contributor-guides">Contributor Guides</a></li>
      <li role="presentation" class="dropdown-header">Languages</li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/ja/">日本語 (Japanese)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/de/">Deutsch (German)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/fr/">Français (French)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/pt_BR/">Português (Portuguese)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/zh_CN/">简体中文 (Simplified Chinese)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/ko_KR/">한국어 (Korean)</a></li>
    </ul>
  </div>
  <div class="docs-sidebar-toc">
    <div class="docs-sidebar-section" id="table-of-contents">
      <a href="index.html" class="docs-sidebar-section-title"><h4>Contents</h4></a>
      <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="common/conventions.html">Conventions</a></li>
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="config.html">Configuration</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="config-ml2.html">ML2 plug-in</a></li>
<li class="toctree-l2"><a class="reference internal" href="config-address-scopes.html">Address scopes</a></li>
<li class="toctree-l2"><a class="reference internal" href="config-auto-allocation.html">Automatic allocation of network topologies</a></li>
<li class="toctree-l2"><a class="reference internal" href="config-az.html">Availability zones</a></li>
<li class="toctree-l2"><a class="reference internal" href="config-bgp-dynamic-routing.html">BGP dynamic routing</a></li>
<li class="toctree-l2"><a class="reference internal" href="config-dhcp-ha.html">High-availability for DHCP</a></li>
<li class="toctree-l2"><a class="reference internal" href="config-dns-int.html">DNS integration</a></li>
<li class="toctree-l2"><a class="reference internal" href="config-dns-res.html">Name resolution for instances</a></li>
<li class="toctree-l2"><a class="reference internal" href="config-dvr-ha-snat.html">Distributed Virtual Routing with VRRP</a></li>
<li class="toctree-l2"><a class="reference internal" href="config-ipam.html">IPAM configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="config-ipv6.html">IPv6</a></li>
<li class="toctree-l2"><a class="reference internal" href="config-lbaas.html">Load Balancer as a Service (LBaaS)</a></li>
<li class="toctree-l2"><a class="reference internal" href="config-macvtap.html">Macvtap mechanism driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="config-mtu.html">MTU considerations</a></li>
<li class="toctree-l2"><a class="reference internal" href="config-ovs-dpdk.html">Open vSwitch with DPDK datapath</a></li>
<li class="toctree-l2"><a class="reference internal" href="config-ovsfwdriver.html">Native Open vSwitch firewall driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="config-qos.html">Quality of Service (QoS)</a></li>
<li class="toctree-l2"><a class="reference internal" href="config-rbac.html">Role-Based Access Control (RBAC)</a></li>
<li class="toctree-l2"><a class="reference internal" href="config-routed-networks.html">Routed provider networks</a></li>
<li class="toctree-l2"><a class="reference internal" href="config-sfc.html">Service function chaining</a></li>
<li class="toctree-l2"><a class="reference internal" href="config-sriov.html">SR-IOV</a></li>
<li class="toctree-l2"><a class="reference internal" href="config-subnet-pools.html">Subnet pools</a></li>
<li class="toctree-l2"><a class="reference internal" href="config-service-subnets.html">Service subnets</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="config-trunking.html#">Trunking</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="deploy.html">Deployment examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="ops.html">Operations</a></li>
<li class="toctree-l1"><a class="reference internal" href="migration.html">Migration</a></li>
<li class="toctree-l1"><a class="reference internal" href="misc.html">Miscellaneous</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="common/app-support.html">Community support</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="common/glossary.html">Glossary</a></li>
</ul>

    </div>
  </div>
</div>
      </div>
    </div>
<footer>
  <div class="container">
    <div class="row footer-links">
      <div class="col-lg-2 col-sm-2">
        <h3>OpenStack</h3>
        <ul>
          <li><a href="http://openstack.org/projects/">Projects</a></li>
          <li><a href="http://openstack.org/projects/openstack-security/">OpenStack Security</a></li>
          <li><a href="http://openstack.org/projects/openstack-faq/">Common Questions</a></li>
          <li><a href="http://openstack.org/blog/">Blog</a></li>
          <li><a href="http://openstack.org/news/">News</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Community</h3>
        <ul>
          <li><a href="http://openstack.org/community/">User Groups</a></li>
          <li><a href="http://openstack.org/community/events/">Events</a></li>
          <li><a href="http://openstack.org/community/jobs/">Jobs</a></li>
          <li><a href="http://openstack.org/foundation/companies/">Companies</a></li>
          <li><a href="http://docs.openstack.org/infra/manual/developers.html">Contribute</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Documentation</h3>
        <ul>
          <li><a href="http://docs.openstack.org">OpenStack Manuals</a></li>
          <li><a href="http://openstack.org/software/start/">Getting Started</a></li>
          <li><a href="http://developer.openstack.org">API Documentation</a></li>
          <li><a href="https://wiki.openstack.org">Wiki</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Branding & Legal</h3>
        <ul>
          <li><a href="http://openstack.org/brand/">Logos & Guidelines</a></li>
          <li><a href="http://openstack.org/brand/openstack-trademark-policy/">Trademark Policy</a></li>
          <li><a href="http://openstack.org/privacy/">Privacy Policy</a></li>
          <li><a href="https://wiki.openstack.org/wiki/How_To_Contribute#Contributor_License_Agreement">OpenStack CLA</a></li>
        </ul>
      </div>
      <div class="col-lg-4 col-sm-4">
        <h3>Stay In Touch</h3>
        <a href="https://twitter.com/OpenStack" target="_blank" class="social-icons footer-twitter"></a>
        <a href="https://www.facebook.com/openstack" target="_blank" class="social-icons footer-facebook"></a>
        <a href="https://www.linkedin.com/company/openstack" target="_blank" class="social-icons footer-linkedin"></a>
        <a href="https://www.youtube.com/user/OpenStackFoundation" target="_blank" class="social-icons footer-youtube"></a>
        <p class="fine-print">
          The OpenStack project is provided under the
          <a href="http://www.apache.org/licenses/LICENSE-2.0">Apache 2.0 license</a>. Openstack.org is powered by
          <a href="http://rackspace.com" target="_blank">Rackspace Cloud Computing</a>.
        </p>
      </div>
    </div>
  </div>
</footer>
<!-- jQuery -->
<script type="text/javascript" src="_static/js/jquery-3.1.1.js"></script>

<!-- Bootstrap JavaScript -->
<script type="text/javascript" src="_static/js/bootstrap.js"></script>

<!-- The rest of the JS -->
<script type="text/javascript" src="_static/js/navigation.js"></script>

<!-- Docs JS -->
<script type="text/javascript" src="_static/js/docs.js"></script>

<!-- Popovers -->
<script type="text/javascript" src="_static/js/webui-popover.js"></script>

<!-- Javascript for page -->
<script language="JavaScript">
/* build a description of this page including SHA, source location on git repo,
   build time and the project's launchpad bug tag. Set the HREF of the bug
   buttons */

    var lineFeed = "%0A";
    var gitURL = "Source: Can't derive source file URL";

    /* there have been cases where "pagename" wasn't set; better check for it */
        /* The URL of the source file on Git is based on the giturl variable
           in conf.py, which must be manually initialized to the source file
           URL in Git.
           "pagename" is a standard sphinx parameter containing the name of
           the source file, without extension.                             */

        var sourceFile = "config-trunking" + ".rst";
        gitURL = "Source: https://git.openstack.org/cgit/openstack/openstack-manuals/tree/doc/networking-guide/source" + "/" + sourceFile;

    /* gitsha, project and bug_tag rely on variables in conf.py */
    var gitSha = "SHA: 4ad6860c2d8531fd122db0b8b89a923cefdb682f";
        var bugProject = "openstack-manuals";
        var bugTitle = "Trunking in Networking Guide";
    var fieldTags = "networking-guide";

    /* "last_updated" is the build date and time. It relies on the
       conf.py variable "html_last_updated_fmt", which should include
       year/month/day as well as hours and minutes                   */
    var buildstring = "Release: 15.0.0 on 2018-02-08 07:39";

    var fieldComment = encodeURI(buildstring) +
                       lineFeed + encodeURI(gitSha) +
                       lineFeed + encodeURI(gitURL) ;

    logABug(bugTitle, bugProject, fieldComment, fieldTags);
</script>

<!-- Javascript for search boxes (both sidebar and top nav) -->
<script type="text/javascript">
(function() {
var cx = '000108871792296872333:noj9nikm74i';
var gcse = document.createElement('script');
gcse.type = 'text/javascript';
gcse.async = true;
gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
'//www.google.com/cse/cse.js?cx=' + cx;
var s = document.getElementsByTagName('script')[0];
s.parentNode.insertBefore(gcse, s);
})();
</script>

  </body>
</html>