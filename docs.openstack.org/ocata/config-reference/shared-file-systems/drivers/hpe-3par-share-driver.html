<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html lang="en" xml:lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta content="text/html; charset=UTF-8" http-equiv="Content-Type"/>

    <title>OpenStack Docs: HPE 3PAR driver</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Bootstrap CSS -->
<link href="../../_static/css/bootstrap.css" rel="stylesheet">

<!-- Pygments CSS -->
<link href="../../_static/css/native.css" rel="stylesheet">

<!-- Fonts -->
<link href="../../_static/css/font-awesome.css" rel="stylesheet">
<link href='https://fonts.googleapis.com/css?family=Open+Sans:300,400,700' rel='stylesheet' type='text/css'>

<!-- Custom CSS -->
<link href="../../_static/css/combined.css" rel="stylesheet">
<link href="../../_static/css/styles.css" rel="stylesheet">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->
<link rel="stylesheet" href="../../_static/sphinxmark.css" type="text/css" />
  


<!-- Google Analytics -->
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-17511903-1', 'auto');
ga('send', 'pageview');
</script>
<!-- End Google Analytics -->

  </head>
  <body>
<nav class="navbar navbar-default inner" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button class="navbar-toggle" data-target="#bs-example-navbar-collapse-1" data-toggle="collapse" type="button">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <div class="brand-wrapper">
        <a class="navbar-brand" href="https://docs.openstack.org/"></a>
      </div>
      <div class="search-icon show"><i class="fa fa-search"></i> Search</div></div>
      <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <div class="search-container tiny">
        <div id="gcse">
          <script type="text/javascript">
(function() {
  var cx = '000108871792296872333:noj9nikm74i';
  var gcse = document.createElement('script');
  gcse.type = 'text/javascript';
  gcse.async = true;
  gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
      '//www.google.com/cse/cse.js?cx=' + cx;
  var s = document.getElementsByTagName('script')[0];
  s.parentNode.insertBefore(gcse, s);
})();
          </script>
          <gcse:search gname="standard"></gcse:search>
        </div>
        <i class="fa fa-times close-search"></i>
      </div>
      <ul class="nav navbar-nav navbar-main show">
        <li>
          <div id="gcse-mobile">
            <gcse:search gname="mobile"></gcse:search>
          </div>
        </li>
        <li>
          <a href="http://www.openstack.org/software/" class="drop" id="dropdownMenuSoftware">Software <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuSoftware">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/">Overview</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/project-navigator/">Project Navigator</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/sample-configs/">Sample Configs</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/software/security/">Security</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/start/">Get Started</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/roadmap/">Roadmap</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/latest-release/">Latest Release</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/software/sourcecode/">Source Code</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/user-stories/" class="drop" id="dropdownMenuUsers">Users <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuUsers">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/user-stories/">Overview</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/telecoms-and-nfv/">Telecoms and NFV</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/enterprise/">OpenStack in the Enterprise</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/appdev/">Application Developers & ISVs</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://superuser.openstack.org/">Superuser Magazine</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/surveys/landing">User Survey</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/community/" class="drop" id="dropdownMenuCommunity">Community <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuCommunity">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/">Welcome! Start Here</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/foundation/">OpenStack Foundation</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://wiki.openstack.org">OpenStack Wiki</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://groups.openstack.org">User Groups</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/speakers/">Speakers Bureau</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/foundation/companies/">Supporting Companies</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/jobs/">Jobs</a></li>
            <li role="presentation" class="divider"></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/join/">Join The Community</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/marketplace/">Marketplace</a>
        </li>
        <li>
          <a href="http://www.openstack.org/events/" class="drop" id="dropdownMenuEvents">Events <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenuEvents">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/community/events/">Overview</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/summit/">The OpenStack Summit</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/community/events/">More OpenStack Events</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/community/events/#openstack_days">OpenStack Days</a></li>
          </ul>
        </li>
        <li>
          <a href="http://www.openstack.org/learn/" class="drop" id="dropdownMenuLearn">Learn <i class="fa fa-caret-down"></i></a>
          <ul class="dropdown-menu dropdown-hover" role="menu" aria-labelledby="dropdownMenuEvents">
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/marketplace/training/">Training</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/marketplace/coa/">Get Certified</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://ask.openstack.org/">Ask a Technical Question</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://superuser.openstack.org/">Superuser Magazine</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/videos/">Summit Videos</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="https://www.openstack.org/analysts/">Analyst Reports</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/news/">News</a></li>
            <li role="presentation"><a role="menuitem" tabindex="-1" href="http://www.openstack.org/blog/">Blog</a></li>
          </ul>
        </li>
        <li>
          <a href="http://docs.openstack.org/">Docs</a>
        </li>
      </ul>
    </div>
  </div>
</nav>
    <div class="container docs-book-wrapper">
      <div class="row">
        <div class="col-lg-9 col-md-8 col-sm-8 col-lg-push-3 col-md-push-4 col-sm-push-4">
<div class="row">
  <div class="col-lg-8">
      <h2>HPE 3PAR driver</h2>
    
  </div>
  <div class="docs-actions">
    
    <a href="hitachi-hsp-driver.html"><i class="fa fa-angle-double-left" data-toggle="tooltip" data-placement="top" title="Previous: Hitachi Hyper Scale-Out Platform File Services Driver for OpenStack"></i></a>
    
    
    <a href="huawei-nas-driver.html"><i class="fa fa-angle-double-right" data-toggle="tooltip" data-placement="top" title="Next: Huawei driver"></i></a>
    
    <a id="logABugLink1" href="hpe-3par-share-driver.html" target="_blank" title="Found an error? Report a bug against this page"><i class="fa fa-bug" data-toggle="tooltip" data-placement="top" title="Report a Bug"></i></a>
  </div>
</div>
          <div class="row docs-byline">
            <div class="docs-updated">updated: 2018-02-08 07:41</div>
          </div>
          <div class="row">
            <div class="col-lg-12">
              <div class="docs-top-contents">

<h5><a href="../../index.html">Contents</a></h5>
<ul>
<li><a class="reference internal" href="hpe-3par-share-driver.html#">HPE 3PAR driver</a><ul>
<li><a class="reference internal" href="hpe-3par-share-driver.html#hpe-3par-file-persona-software-suite-concepts-and-terminology">HPE 3PAR File Persona Software Suite concepts and terminology</a></li>
<li><a class="reference internal" href="hpe-3par-share-driver.html#supported-shared-filesystems">Supported shared filesystems</a></li>
<li><a class="reference internal" href="hpe-3par-share-driver.html#operations-supported">Operations supported</a></li>
<li><a class="reference internal" href="hpe-3par-share-driver.html#operations-not-supported">Operations not supported</a></li>
<li><a class="reference internal" href="hpe-3par-share-driver.html#requirements">Requirements</a></li>
<li><a class="reference internal" href="hpe-3par-share-driver.html#pre-configuration-on-the-hpe-3par-storeserv">Pre-configuration on the HPE 3PAR StoreServ</a></li>
<li><a class="reference internal" href="hpe-3par-share-driver.html#hpe-3par-shared-file-system-driver-configuration">HPE 3PAR shared file system driver configuration</a></li>
<li><a class="reference internal" href="hpe-3par-share-driver.html#driver-options">Driver options</a></li>
<li><a class="reference internal" href="hpe-3par-share-driver.html#hpe-3par-manila-driver-configuration-example">HPE 3PAR Manila driver configuration example</a></li>
<li><a class="reference internal" href="hpe-3par-share-driver.html#network-approach">Network approach</a></li>
<li><a class="reference internal" href="hpe-3par-share-driver.html#share-access">Share access</a></li>
<li><a class="reference internal" href="hpe-3par-share-driver.html#share-types">Share types</a></li>
<li><a class="reference internal" href="hpe-3par-share-driver.html#implementation-characteristics">Implementation characteristics</a></li>
</ul>
</li>
</ul>

              </div>
              <div class="docs-body">

  <div class="section" id="hpe-3par-driver">
<h1>HPE 3PAR driver<a class="headerlink" href="hpe-3par-share-driver.html#hpe-3par-driver" title="Permalink to this headline">¶</a></h1>
<p>The HPE 3PAR driver provides NFS and CIFS shared file systems to
OpenStack using HPE 3PAR&#8217;s File Persona capabilities.</p>
<div class="section" id="hpe-3par-file-persona-software-suite-concepts-and-terminology">
<h2>HPE 3PAR File Persona Software Suite concepts and terminology<a class="headerlink" href="hpe-3par-share-driver.html#hpe-3par-file-persona-software-suite-concepts-and-terminology" title="Permalink to this headline">¶</a></h2>
<p>The software suite comprises the following managed objects:</p>
<ul class="simple">
<li>File Provisioning Groups (FPGs)</li>
<li>Virtual File Servers (VFSs)</li>
<li>File Stores</li>
<li>File Shares</li>
</ul>
<p>The File Persona Software Suite is built upon the resilient mesh-active
architecture of HPE 3PAR StoreServ and benefits from HPE 3PAR storage
foundation of wide-striped logical disks and autonomic
<code class="docutils literal"><span class="pre">Common</span> <span class="pre">Provisioning</span> <span class="pre">Groups</span> <span class="pre">(CPGs)</span></code>. A CPG can be shared between file and
block to create the File Shares or the logical unit numbers (LUNs) to
provide true convergence.</p>
<p><code class="docutils literal"><span class="pre">A</span> <span class="pre">File</span> <span class="pre">Provisioning</span> <span class="pre">Group</span> <span class="pre">(FPG)</span></code> is an instance of the HPE intellectual
property Adaptive File System. It controls how files are stored and retrieved.
Each FPG is transparently constructed from one or multiple
Virtual Volumes (VVs) and is the unit for replication and disaster recovery
for File Persona Software Suite. There are up to 16 FPGs supported on a
node pair.</p>
<p><code class="docutils literal"><span class="pre">A</span> <span class="pre">Virtual</span> <span class="pre">File</span> <span class="pre">Server</span> <span class="pre">(VFS)</span></code> is conceptually like a server. As such, it
presents virtual IP addresses to clients, participates in user authentication
services, and can have properties for such things as user/group quota
management and antivirus policies. Up to 16 VFSs are supported on a node pair,
one per FPG.</p>
<p><code class="docutils literal"><span class="pre">File</span> <span class="pre">Stores</span></code> are the slice of a VFS and FPG at which snapshots are taken,
capacity quota management can be performed, and antivirus scan service
policies customized. There are up to 256 File Stores supported on a node pair,
16 File Stores per VFS.</p>
<p><code class="docutils literal"><span class="pre">File</span> <span class="pre">Shares</span></code> are what provide data access to clients via SMB, NFS, and the
Object Access API, subject to the share permissions applied to them. Multiple
File Shares can be created for a File Store and at different directory levels
within a File Store.</p>
</div>
<div class="section" id="supported-shared-filesystems">
<h2>Supported shared filesystems<a class="headerlink" href="hpe-3par-share-driver.html#supported-shared-filesystems" title="Permalink to this headline">¶</a></h2>
<p>The driver supports CIFS and NFS shares.</p>
</div>
<div class="section" id="operations-supported">
<h2>Operations supported<a class="headerlink" href="hpe-3par-share-driver.html#operations-supported" title="Permalink to this headline">¶</a></h2>
<ul>
<li><p class="first">Create a share.</p>
<p>– Share is not accessible until access rules allow access.</p>
</li>
<li><p class="first">Delete a share.</p>
</li>
<li><p class="first">Allow share access.</p>
<p>Note the following limitations:</p>
<p>– IP access rules are required for NFS share access.</p>
<p>– User access rules are not allowed for NFS shares.</p>
<p>– User access rules are required for SMB share access.</p>
<p>– User access requires a File Persona local user for SMB shares.</p>
<p>– Shares are read/write (and subject to ACLs).</p>
</li>
<li><p class="first">Deny share access.</p>
</li>
<li><p class="first">Create a snapshot.</p>
</li>
<li><p class="first">Delete a snapshot.</p>
</li>
<li><p class="first">Create a share from a snapshot.</p>
</li>
<li><p class="first">Extend a share.</p>
</li>
<li><p class="first">Shrink a share.</p>
</li>
<li><p class="first">Share networks.</p>
</li>
</ul>
<p>HPE 3PAR File Persona driver can be configured to work with or without
share networks. When using share networks, the HPE 3PAR
driver allocates an FSIP on the back end FPG (VFS) to match the share
network&#8217;s subnet and segmentation ID. Security groups associated
with share networks are ignored.</p>
</div>
<div class="section" id="operations-not-supported">
<h2>Operations not supported<a class="headerlink" href="hpe-3par-share-driver.html#operations-not-supported" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Manage and unmanage</li>
<li>Manila Experimental APIs (consistency groups, replication, and migration)
were added in Mitaka but have not yet been implemented by the HPE 3PAR
File Persona driver.</li>
</ul>
</div>
<div class="section" id="requirements">
<h2>Requirements<a class="headerlink" href="hpe-3par-share-driver.html#requirements" title="Permalink to this headline">¶</a></h2>
<p>On the OpenStack host running the Manila share service:</p>
<ul class="simple">
<li>python-3parclient version 4.2.0 or newer from PyPI.</li>
</ul>
<p>On the HPE 3PAR array:</p>
<ul class="simple">
<li>HPE 3PAR Operating System software version 3.2.1 MU3 or higher.</li>
<li>A license that enables the File Persona feature.</li>
<li>The array class and hardware configuration must support File Persona.</li>
</ul>
</div>
<div class="section" id="pre-configuration-on-the-hpe-3par-storeserv">
<h2>Pre-configuration on the HPE 3PAR StoreServ<a class="headerlink" href="hpe-3par-share-driver.html#pre-configuration-on-the-hpe-3par-storeserv" title="Permalink to this headline">¶</a></h2>
<p>The following HPE 3PAR CLI commands show how to set up the HPE 3PAR StoreServ
to use File Persona with OpenStack Manila. HPE 3PAR File Persona must be
licensed, initialized, and started on the HPE 3PAR storage.</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="go">cli% startfs 0:2:1 1:2:1</span>
<span class="go">cli% setfs nodeip -ipaddress 10.10.10.11 -subnet 255.255.240.0 0</span>
<span class="go">cli% setfs nodeip -ipaddress 10.10.10.12 -subnet 255.255.240.0 1</span>
<span class="go">cli% setfs dns 192.168.8.80,127.127.5.50 foo.com,bar.com</span>
<span class="go">cli% setfs gw 10.10.10.10</span>
</pre></div>
</div>
<ul>
<li><p class="first">A File Provisioning Group (FPG) must be created for use with the
Shared File Systems service.</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="go">cli% createfpg examplecpg examplefpg 18T</span>
</pre></div>
</div>
</li>
<li><p class="first">A Virtual File Server (VFS) must be created on the FPG.</p>
</li>
<li><p class="first">The VFS must be configured with an appropriate share export IP
address.</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="go">cli% createvfs -fpg examplefpg 10.10.10.101 255.255.0.0 examplevfs</span>
</pre></div>
</div>
</li>
<li><p class="first">A local user in the Administrators group is needed for CIFS (SMB) shares.</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="go">cli% createfsgroup fsusers</span>
<span class="go">cli% createfsuser –passwd &lt;password&gt; -enable true -grplist</span>
<span class="go">Users,Administrators –primarygroup fsusers fsadmin</span>
</pre></div>
</div>
</li>
<li><p class="first">The WSAPI with HTTP and/or HTTPS must be enabled and started.</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="go">cli% setwsapi -https enable</span>
<span class="go">cli% startwsapi</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="hpe-3par-shared-file-system-driver-configuration">
<h2>HPE 3PAR shared file system driver configuration<a class="headerlink" href="hpe-3par-share-driver.html#hpe-3par-shared-file-system-driver-configuration" title="Permalink to this headline">¶</a></h2>
<ul>
<li><p class="first">Install the python-3parclient python package on the OpenStack Block Storage
system:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> pip install <span class="s1">&#39;python-3parclient&gt;=4.0,&lt;5.0&#39;</span>
</pre></div>
</div>
</li>
<li><p class="first">Manila configuration file</p>
<p>The Manila configuration file (typically <code class="docutils literal"><span class="pre">/etc/manila/manila.conf</span></code>)
defines and configures the Manila drivers and backends. After updating the
configuration file, the Manila share service must be restarted for changes
to take effect.</p>
</li>
<li><p class="first">Enable share protocols</p>
<p>To enable share protocols, an optional list of supported protocols can be
specified using the <code class="docutils literal"><span class="pre">enabled_share_protocols</span></code> setting in the <code class="docutils literal"><span class="pre">DEFAULT</span></code>
section of the <code class="docutils literal"><span class="pre">manila.conf</span></code> file. The default is <code class="docutils literal"><span class="pre">NFS,</span> <span class="pre">CIFS</span></code> which
allows both protocols supported by HPE 3PAR (NFS and SMB). Where Manila
uses the term <code class="docutils literal"><span class="pre">CIFS</span></code>, HPE 3PAR uses the term <code class="docutils literal"><span class="pre">SMB</span></code>. Use the
<code class="docutils literal"><span class="pre">enabled_share_protocols</span></code> option if you want to only provide one type of
share (for example, only NFS) or if you want to explicitly avoid the
introduction of other protocols that can be added for other drivers in the
future.</p>
</li>
<li><p class="first">Enable share back ends</p>
<p>In the <code class="docutils literal"><span class="pre">[DEFAULT]</span></code> section of the Manila configuration file, use the
<code class="docutils literal"><span class="pre">enabled_share_backends</span></code> option to specify the name of one or more
back-end configuration sections to be enabled. To enable multiple
back ends, use a comma-separated list.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The name of the backend&#8217;s configuration section is used (which may
be different from the <code class="docutils literal"><span class="pre">share_backend_name</span></code> value)</p>
</div>
</li>
<li><p class="first">Configure each back end</p>
<p>For each back end, a configuration section defines the driver and back end
options. These include common Manila options, as well as driver-specific
options. The following <code class="docutils literal"><span class="pre">Driver</span> <span class="pre">options</span></code> section describes
the parameters that need to be configured in the Manila
configuration file for the HPE 3PAR driver.</p>
</li>
</ul>
</div>
<div class="section" id="driver-options">
<h2>Driver options<a class="headerlink" href="hpe-3par-share-driver.html#driver-options" title="Permalink to this headline">¶</a></h2>
<p>The following table contains the configuration options specific to the
share driver.</p>
<span id="manila-hpe3par"></span><table border="1" class="config-ref-table docutils" id="id2">
<caption><span class="caption-text">Description of HPE 3PAR share driver configuration options</span><a class="headerlink" href="hpe-3par-share-driver.html#id2" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Configuration option = Default value</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>[DEFAULT]</strong></td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">hpe3par_api_url</span></code> =</td>
<td>(String) 3PAR WSAPI Server Url like <a class="reference external" href="https:/">https:/</a>/&lt;3par ip&gt;:8080/api/v1</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">hpe3par_cifs_admin_access_domain</span></code> = <code class="docutils literal"><span class="pre">LOCAL_CLUSTER</span></code></td>
<td>(String) File system domain for the CIFS admin user.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">hpe3par_cifs_admin_access_password</span></code> =</td>
<td>(String) File system admin password for CIFS.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">hpe3par_cifs_admin_access_username</span></code> =</td>
<td>(String) File system admin user name for CIFS.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">hpe3par_debug</span></code> = <code class="docutils literal"><span class="pre">False</span></code></td>
<td>(Boolean) Enable HTTP debugging to 3PAR</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">hpe3par_fpg</span></code> = <code class="docutils literal"><span class="pre">None</span></code></td>
<td>(Unknown) The File Provisioning Group (FPG) to use</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">hpe3par_fstore_per_share</span></code> = <code class="docutils literal"><span class="pre">False</span></code></td>
<td>(Boolean) Use one filestore per share</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">hpe3par_password</span></code> =</td>
<td>(String) 3PAR password for the user specified in hpe3par_username</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">hpe3par_require_cifs_ip</span></code> = <code class="docutils literal"><span class="pre">False</span></code></td>
<td>(Boolean) Require IP access rules for CIFS (in addition to user)</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">hpe3par_san_ip</span></code> =</td>
<td>(String) IP address of SAN controller</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">hpe3par_san_login</span></code> =</td>
<td>(String) Username for SAN controller</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">hpe3par_san_password</span></code> =</td>
<td>(String) Password for SAN controller</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">hpe3par_san_ssh_port</span></code> = <code class="docutils literal"><span class="pre">22</span></code></td>
<td>(Port number) SSH port to use with SAN</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">hpe3par_share_mount_path</span></code> = <code class="docutils literal"><span class="pre">/mnt/</span></code></td>
<td>(String) The path where shares will be mounted when deleting nested file trees.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">hpe3par_username</span></code> =</td>
<td>(String) 3PAR username with the &#8216;edit&#8217; role</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="hpe-3par-manila-driver-configuration-example">
<h2>HPE 3PAR Manila driver configuration example<a class="headerlink" href="hpe-3par-share-driver.html#hpe-3par-manila-driver-configuration-example" title="Permalink to this headline">¶</a></h2>
<p>The following parameters shows a sample subset of the <code class="docutils literal"><span class="pre">manila.conf</span></code> file,
which configures two backends and the relevant <code class="docutils literal"><span class="pre">[DEFAULT]</span></code> options. A real
configuration would include additional <code class="docutils literal"><span class="pre">[DEFAULT]</span></code> options and additional
sections that are not discussed in this document. In this example, the
backends are using different FPGs on the same array:</p>
<div class="highlight-ini"><div class="highlight"><pre><span></span><span class="k">[DEFAULT]</span>
<span class="na">enabled_share_backends</span> <span class="o">=</span> <span class="s">HPE1,HPE2</span>
<span class="na">enabled_share_protocols</span> <span class="o">=</span> <span class="s">NFS,CIFS</span>
<span class="na">default_share_type</span> <span class="o">=</span> <span class="s">default</span>
<span class="k">[HPE1]</span>
<span class="na">share_backend_name</span> <span class="o">=</span> <span class="s">HPE3PAR1</span>
<span class="na">share_driver</span> <span class="o">=</span> <span class="s">manila.share.drivers.hpe.hpe_3par_driver.HPE3ParShareDriver</span>
<span class="na">driver_handles_share_servers</span> <span class="o">=</span> <span class="s">False</span>
<span class="na">max_over_subscription_ratio</span> <span class="o">=</span> <span class="s">1</span>
<span class="na">hpe3par_fpg</span> <span class="o">=</span> <span class="s">examplefpg,10.10.10.101</span>
<span class="na">hpe3par_san_ip</span> <span class="o">=</span> <span class="s">10.20.30.40</span>
<span class="na">hpe3par_api_url</span> <span class="o">=</span> <span class="s">https://10.20.30.40:8080/api/v1</span>
<span class="na">hpe3par_username</span> <span class="o">=</span> <span class="s">&lt;username&gt;</span>
<span class="na">hpe3par_password</span> <span class="o">=</span> <span class="s">&lt;password&gt;</span>
<span class="na">hpe3par_san_login</span> <span class="o">=</span> <span class="s">&lt;san_username&gt;</span>
<span class="na">hpe3par_san_password</span> <span class="o">=</span> <span class="s">&lt;san_password&gt;</span>
<span class="na">hpe3par_debug</span> <span class="o">=</span> <span class="s">False</span>
<span class="na">hpe3par_cifs_admin_access_username</span> <span class="o">=</span> <span class="s">&lt;fs_admin&gt;</span>
<span class="na">hpe3par_cifs_admin_access_password</span> <span class="o">=</span> <span class="s">&lt;fs_password&gt;</span>
<span class="k">[HPE2]</span>
<span class="na">share_backend_name</span> <span class="o">=</span> <span class="s">HPE3PAR2</span>
<span class="na">share_driver</span> <span class="o">=</span> <span class="s">manila.share.drivers.hpe.hpe_3par_driver.HPE3ParShareDriver</span>
<span class="na">driver_handles_share_servers</span> <span class="o">=</span> <span class="s">False</span>
<span class="na">max_over_subscription_ratio</span> <span class="o">=</span> <span class="s">1</span>
<span class="na">hpe3par_fpg</span> <span class="o">=</span> <span class="s">examplefpg2,10.10.10.102</span>
<span class="na">hpe3par_san_ip</span> <span class="o">=</span> <span class="s">10.20.30.40</span>
<span class="na">hpe3par_api_url</span> <span class="o">=</span> <span class="s">https://10.20.30.40:8080/api/v1</span>
<span class="na">hpe3par_username</span> <span class="o">=</span> <span class="s">&lt;username&gt;</span>
<span class="na">hpe3par_password</span> <span class="o">=</span> <span class="s">&lt;password&gt;</span>
<span class="na">hpe3par_san_login</span> <span class="o">=</span> <span class="s">&lt;san_username&gt;</span>
<span class="na">hpe3par_san_password</span> <span class="o">=</span> <span class="s">&lt;san_password&gt;</span>
<span class="na">hpe3par_debug</span> <span class="o">=</span> <span class="s">False</span>
<span class="na">hpe3par_cifs_admin_access_username</span> <span class="o">=</span> <span class="s">&lt;fs_admin&gt;</span>
<span class="na">hpe3par_cifs_admin_access_password</span> <span class="o">=</span> <span class="s">&lt;password&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="network-approach">
<h2>Network approach<a class="headerlink" href="hpe-3par-share-driver.html#network-approach" title="Permalink to this headline">¶</a></h2>
<p>Network connectivity between the storage array (SSH/CLI and WSAPI) and the
Manila host is required for share management. Network connectivity between
the clients and the VFS is required for mounting and using the shares.
This includes:</p>
<ul class="simple">
<li>Routing from the client to the external network.</li>
<li>Assigning the client an external IP address, for example a floating IP.</li>
<li>Configuring the Shared File Systems service host networking properly
for IP forwarding.</li>
<li>Configuring the VFS networking properly for client subnets.</li>
<li>Configuring network segmentation, if applicable.</li>
</ul>
<p>In the OpenStack Kilo release, the HPE 3PAR driver did not support share
networks. Share access from clients to HPE 3PAR shares required external
network access (external to OpenStack) and was set up and configured outside
of Manila.</p>
<p>In the OpenStack Liberty release, the HPE 3PAR driver could run with or
without share networks. The configuration option
<code class="docutils literal"><span class="pre">driver_handles_share_servers``(</span> <span class="pre">``True</span></code> or <code class="docutils literal"><span class="pre">False</span></code> ) indicated whether
share networks could be used. When set to <code class="docutils literal"><span class="pre">False</span></code>, the HPE 3PAR driver
behaved as described earlier for Kilo. When set to <code class="docutils literal"><span class="pre">True</span></code>, the share
network’s subnet, segmentation ID and IP address range were used to allocate
an FSIP on the HPE 3PAR. There is a limit of four FSIPs per VFS. For clients
to communicate with shares via this FSIP, the client must have access to the
external network using the subnet and segmentation ID of the share network.</p>
<p>For example, the client must be routed to the neutron provider network with
external access. The Manila host networking configuration and network
switches must support the subnet routing. If the VLAN segmentation ID is used,
communication with the share will use the FSIP IP address. Neutron networking
is required for HPE 3PAR share network support. Flat and VLAN provider
networks are supported, but the HPE 3PAR driver does not support share network
security groups.</p>
</div>
<div class="section" id="share-access">
<h2>Share access<a class="headerlink" href="hpe-3par-share-driver.html#share-access" title="Permalink to this headline">¶</a></h2>
<p>A share that is mounted before access is allowed can appear to be an empty
read-only share. After granting access, the share must be remounted.</p>
<ul class="simple">
<li>IP access rules are required for NFS.</li>
<li>SMB shares require user access rules.</li>
</ul>
<p>With the proper access rules, share access is not limited to the OpenStack
environment. Access rules added via Manila or directly in HPE 3PAR CLI can be
used to allow access to clients outside of the stack. The HPE 3PAR VFS/FSIP
settings determine the subnets visible for HPE 3PAR share access.</p>
<ul>
<li><p class="first">IP access rules</p>
<p>To allow IP access to a share in the horizon UI, find the share in the
Project|Manage Compute|Shares view. Use the <code class="docutils literal"><span class="pre">Manage</span> <span class="pre">Rules</span></code> action to add
a rule. Select IP as the access type, and enter the external IP address
(for example, the floating IP) of the client in the <code class="docutils literal"><span class="pre">Access</span> <span class="pre">to</span></code> box.</p>
<p>You can also use the command line to allow IP access to a share in the
horizon UI with the command:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> manila access-allow &lt;share-id&gt; ip &lt;ip-address&gt;
</pre></div>
</div>
</li>
<li><p class="first">User access rules</p>
<p>To allow user access to a share in the horizon UI, find the share in the
Project|Manage Compute|Shares view. Use the <code class="docutils literal"><span class="pre">Manage</span> <span class="pre">Rules</span></code> action to add
a rule. Select user as the access type and enter user name in the
<code class="docutils literal"><span class="pre">Access</span> <span class="pre">to</span></code> box.</p>
<p>You can also use the command line to allow user access to a share in the
horizon UI with the command:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> manila access-allow &lt;share-id&gt; user &lt;user name&gt;
</pre></div>
</div>
<p>The user name must be an HPE 3PAR user.</p>
<p>Share access is different from file system permissions,
for example, ACLs on files and folders. If a user wants to read a file,
the user must have at least read permissions on the share and an ACL that
grants him read permissions on the file or folder. Even with
full control share access, it does not mean every user can do
everything due to the additional restrictions of the folder ACLs.</p>
<p>To modify the file or folder ACLs, allow access to an HPE 3PAR File Persona
local user that is in the administrator&#8217;s group and connect to the share
using that user&#8217;s credentials. Then, use the appropriate mechanism to
modify the ACL or permissions to allow different access than what is
provided by default.</p>
</li>
</ul>
</div>
<div class="section" id="share-types">
<span id="id1"></span><h2>Share types<a class="headerlink" href="hpe-3par-share-driver.html#share-types" title="Permalink to this headline">¶</a></h2>
<p>When creating a share, a share type can be specified to determine where and
how the share will be created. If a share type is not specified, the
<code class="docutils literal"><span class="pre">default_share_type</span></code> set in the Shared File Systems service configuration
file is used.</p>
<p>Manila share types are a type or label that can be selected at share creation
time in OpenStack. These types can be created either in the <code class="docutils literal"><span class="pre">Admin</span></code> horizon
UI or using the command line, as follows:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> manila --os-username admin --os-tenant-name demo type-create
<span class="go">–is_public false &lt;name&gt; false</span>
</pre></div>
</div>
<p>The <code class="docutils literal"><span class="pre">&lt;name&gt;</span></code> is the name of the new share type. False at the end specifies
<code class="docutils literal"><span class="pre">driver_handles_share_servers=False</span></code>. The <code class="docutils literal"><span class="pre">driver_handles_share_servers</span></code>
setting in the share type needs to match the setting configured for the
back end in the <code class="docutils literal"><span class="pre">manila.conf</span></code> file.</p>
<p><code class="docutils literal"><span class="pre">is_public</span></code> is used to indicate whether this share type is applicable to all
tenants or will be assigned to specific tenants.</p>
<p><code class="docutils literal"><span class="pre">--os-username</span> <span class="pre">admin</span> <span class="pre">--os-tenant-name</span> <span class="pre">demo</span></code> are only needed if your
environment variables do not specify the desired user and tenant.</p>
<p>For share types that are not public, use Manila <code class="docutils literal"><span class="pre">type-access-add</span></code> to assign
the share type to a tenant.</p>
<ul>
<li><p class="first">Using share types to require share networks</p>
<p>The Shared File Systems service requires that the share type include the
<code class="docutils literal"><span class="pre">driver_handles_share_servers</span></code> extra-spec. This ensures that the share is
created on a back end that supports the requested
<code class="docutils literal"><span class="pre">driver_handles_share_servers</span></code> (share networks) capability. From the
Liberty release forward, both <code class="docutils literal"><span class="pre">True</span></code> and <code class="docutils literal"><span class="pre">False</span></code> are supported.</p>
<p>The <code class="docutils literal"><span class="pre">driver_handles_share_servers</span></code> setting in the share type must match
the setting in the back end configuration.</p>
</li>
<li><p class="first">Using share types to select backends by name</p>
<p>Administrators can optionally specify that a particular share type be
explicitly associated with a single back end (or group of backends) by
including the extra spec share_backend_name to match the name specified
within the <code class="docutils literal"><span class="pre">share_backend_name</span></code> option in the back end configuration.</p>
<p>When a share type is not selected during share creation, the default share
type is used. To prevent creating these shares on any back end, the default
share type needs to be specific enough to find appropriate default backends
(or to find none if the default should not be used). The following example
shows how to set share_backend_name for a share type.</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> manila --os-username admin --os-tenant-name demo type-key &lt;share-type&gt;
<span class="go">set share_backend_name=HPE3PAR2</span>
</pre></div>
</div>
</li>
<li><p class="first">Using share types to select backends with capabilities</p>
<p>The HPE 3PAR driver automatically reports capabilities based on the FPG
used for each back end. An administrator can create share types with extra
specs, which controls share types that can use FPGs with or without
specific capabilities.</p>
<p>With the OpenStack Liberty release or later, below section shows the extra
specs used with the capabilities filter and the HPE 3PAR driver:</p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">hpe3par_flash_cache</span></code></dt>
<dd><p class="first">When the value is set to <code class="docutils literal"><span class="pre">&lt;is&gt;</span> <span class="pre">True</span></code> (or <code class="docutils literal"><span class="pre">&lt;is&gt;</span> <span class="pre">False</span></code>), shares of
this type are only created on a back end that uses HPE 3PAR Adaptive
Flash Cache. For Adaptive Flash Cache, the HPE 3PAR StoreServ Storage
array must meet the following requirements:</p>
<ul class="last">
<li><p class="first">Adaptive Flash Cache license installed</p>
</li>
<li><p class="first">Available SSDs</p>
</li>
<li><p class="first">Adaptive Flash Cache must be enabled on the HPE 3PAR StoreServ
Storage array. This is done with the following CLI command:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="go">cli% createflashcache &lt;size&gt;</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">&lt;size&gt;</span></code> must be in 16 GB increments. For example, the below command
creates 128 GB of Flash Cache for each node pair in the array.</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="go">cli% createflashcache 128g</span>
</pre></div>
</div>
</li>
<li><p class="first">Adaptive Flash Cache must be enabled for the VV set used by an FPG.
For example, <code class="docutils literal"><span class="pre">setflashcache</span> <span class="pre">vvset:&lt;fpgname&gt;</span></code>. The VV set name is the
same as the FPG name.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This setting affects all shares in that FPG (on that back end).</p>
</div>
</li>
</ul>
</dd>
<dt><code class="docutils literal"><span class="pre">Dedupe</span></code></dt>
<dd><p class="first last">When the value is set to <code class="docutils literal"><span class="pre">&lt;is&gt;</span> <span class="pre">True</span></code> (or <code class="docutils literal"><span class="pre">&lt;is&gt;</span> <span class="pre">False</span></code>), shares of
this type are only created on a back end that uses deduplication. For HPE
3PAR File Persona, the provisioning type is determined when the FPG is
created. Using the <code class="docutils literal"><span class="pre">createfpg</span> <span class="pre">–tdvv</span></code> option creates an FPG that
supports both dedupe and thin provisioning. A thin deduplication license
must be installed to use the tdvv option.</p>
</dd>
<dt><code class="docutils literal"><span class="pre">thin_provisioning</span></code></dt>
<dd><p class="first last">When the value is set to <code class="docutils literal"><span class="pre">&lt;is&gt;</span> <span class="pre">True</span></code> (or <code class="docutils literal"><span class="pre">&lt;is&gt;</span> <span class="pre">False</span></code>), shares of
this type are only created on a back end that uses thin (or full)
provisioning. For HPE 3PAR File Persona, the provisioning type is
determined when the FPG is created. By default, FPGs are created with
thin provisioning. The capacity filter uses the total provisioned space
and configured <code class="docutils literal"><span class="pre">max_oversubscription_ratio</span></code> when filtering and weighing
backends that use thin provisioning.</p>
</dd>
</dl>
</li>
<li><p class="first">Using share types to influence share creation options</p>
<p>Scoped extra-specs are used to influence vendor-specific implementation
details. Scoped extra-specs use a prefix followed by a colon. For HPE 3PAR,
these extra specs have a prefix of hpe3par.</p>
<p>The following HPE 3PAR extra-specs are used when creating CIFS (SMB)
shares:</p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">hpe3par:smb_access_based_enum</span></code></dt>
<dd><p class="first last"><code class="docutils literal"><span class="pre">smb_access_based_enum</span></code> (Access Based Enumeration) specifies if users
can see only the files and directories to which they have been allowed
access on the shares. Valid values are <code class="docutils literal"><span class="pre">True</span></code> or <code class="docutils literal"><span class="pre">False</span></code>.
The default is <code class="docutils literal"><span class="pre">False</span></code>.</p>
</dd>
<dt><code class="docutils literal"><span class="pre">hpe3par:smb_continuous_avail</span></code></dt>
<dd><p class="first last"><code class="docutils literal"><span class="pre">smb_continuous_avail</span></code> (Continuous Availability) specifies if
continuous availability features of SMB3 should be enabled for this
share. Valid values are <code class="docutils literal"><span class="pre">True</span></code> or <code class="docutils literal"><span class="pre">False</span></code>. The default is <code class="docutils literal"><span class="pre">True</span></code>.</p>
</dd>
<dt><code class="docutils literal"><span class="pre">hpe3par:smb_cache</span></code></dt>
<dd><p class="first"><code class="docutils literal"><span class="pre">smb_cache</span></code> specifies client-side caching for offline files. The
default value is <code class="docutils literal"><span class="pre">manual</span></code>. Valid values are:</p>
<ul class="last simple">
<li><code class="docutils literal"><span class="pre">off</span></code> — the client must not cache any files from this share. The
share is configured to disallow caching.</li>
<li><code class="docutils literal"><span class="pre">manual</span></code> — the client must allow only manual caching for the files
open from this share.</li>
<li><code class="docutils literal"><span class="pre">optimized</span></code> — the client may cache every file that it opens from
this share. Also, the client may satisfy the file requests from its
local cache. The share is configured to allow automatic caching of
programs and documents.</li>
<li><code class="docutils literal"><span class="pre">auto</span></code> — the client may cache every file that it opens from this
share. The share is configured to allow automatic caching of
documents.</li>
</ul>
</dd>
</dl>
<p>When creating NFS shares, the following HPE 3PAR extra-specs are used:</p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">hpe3par:nfs_options</span></code></dt>
<dd><p class="first">Comma separated list of NFS export options.</p>
<p>The NFS export options have the following limitations:</p>
<p><code class="docutils literal"><span class="pre">ro</span></code> and <code class="docutils literal"><span class="pre">rw</span></code> are not allowed (will be determined by the driver)</p>
<p><code class="docutils literal"><span class="pre">no_subtree_check</span></code> and <code class="docutils literal"><span class="pre">fsid</span></code> are not allowed per HPE 3PAR CLI
support</p>
<p><code class="docutils literal"><span class="pre">(in)secure</span></code> and <code class="docutils literal"><span class="pre">(no_)root_squash</span></code> are not allowed because the HPE
3PAR driver controls those settings</p>
<p class="last">All other NFS options are forwarded to the HPE 3PAR as part of share
creation. The HPE 3PAR performs additional validation at share creation
time. For details, see the HPE 3PAR CLI help.</p>
</dd>
</dl>
</li>
</ul>
</div>
<div class="section" id="implementation-characteristics">
<h2>Implementation characteristics<a class="headerlink" href="hpe-3par-share-driver.html#implementation-characteristics" title="Permalink to this headline">¶</a></h2>
<ul>
<li><p class="first">Shares from snapshots</p>
<ul class="simple">
<li>When a share is created from a snapshot, the share must be deleted
before the snapshot can be deleted. This is enforced by the driver.</li>
<li>A snapshot of an empty share will appear to work correctly, but
attempting to create a share from an empty share snapshot may fail with
an <code class="docutils literal"><span class="pre">NFS</span> <span class="pre">Create</span> <span class="pre">export</span></code> error.</li>
<li>HPE 3PAR File Persona snapshots are for an entire File Store. In Manila,
they appear as snapshots of shares. A share sub-directory is used to
give the appearance of a share snapshot when using <code class="docutils literal"><span class="pre">create</span> <span class="pre">share</span> <span class="pre">from</span>
<span class="pre">snapshot</span></code> .</li>
</ul>
</li>
<li><p class="first">Snapshots</p>
<ul class="simple">
<li>For HPE 3PAR File Persona, snapshots are per File Store and not per
share. So, the HPE 3PAR limit of 1024 snapshots per File Store results
in a Manila limit of 1024 snapshots per tenant on each back end FPG.</li>
<li>Before deleting a share, you must delete its snapshots. This is enforced
by Manila. For HPE 3PAR File Persona, this also kicks off a snapshot
reclamation.</li>
</ul>
</li>
<li><p class="first">Size enforcement</p>
<p>Manila users create shares with size limits. HPE 3PAR enforces size limits
by using File Store quotas. When using <code class="docutils literal"><span class="pre">hpe3par_fstore_per_share``=</span>
<span class="pre">``True``(the</span> <span class="pre">non-default</span> <span class="pre">setting)</span> <span class="pre">there</span> <span class="pre">is</span> <span class="pre">only</span> <span class="pre">one</span> <span class="pre">share</span> <span class="pre">per</span> <span class="pre">File</span> <span class="pre">Store,</span>
<span class="pre">so</span> <span class="pre">the</span> <span class="pre">size</span> <span class="pre">enforcement</span> <span class="pre">acts</span> <span class="pre">as</span> <span class="pre">expected.</span> <span class="pre">When</span> <span class="pre">using</span>
<span class="pre">``hpe3par_fstore_per_share</span></code> = <code class="docutils literal"><span class="pre">False</span></code> (the default), the HPE 3PAR Manila
driver uses one File Store for multiple shares. In this case, the size of
the File Store limit is set to the cumulative limit of its Manila share
sizes. This can allow one tenant share to exceed the limit and affect the
space available for the same tenant’s other shares. One tenant cannot use
another tenant’s File Store.</p>
</li>
<li><p class="first">File removal</p>
<p>When shares are removed and the <code class="docutils literal"><span class="pre">hpe3par_fstore_per_share``=``False</span></code>
setting is used (the default), files may be left behind in the File Store.
Prior to Mitaka, removal of obsolete share directories and files that have
been stranded would require tools outside of OpenStack/Manila. In Mitaka
and later, the driver mounts the File Store to remove the deleted share’s
subdirectory and files. For SMB/CIFS share, it requires the
<code class="docutils literal"><span class="pre">hpe3par_cifs_admin_access_username</span></code> and
<code class="docutils literal"><span class="pre">hpe3par_cifs_admin_access_password</span></code> configuration. If the mount and
delete cannot be performed, an error is logged and the share is deleted
in Manila. Due to the potential space held by leftover files, File Store
quotas are not reduced when shares are removed.</p>
</li>
<li><p class="first">Multi-tenancy</p>
<ul>
<li><p class="first">Network</p>
<p>The <code class="docutils literal"><span class="pre">driver_handles_share_servers</span></code> configuration setting determines
whether share networks are supported. When
<code class="docutils literal"><span class="pre">driver_handles_share_servers</span></code> is set to <code class="docutils literal"><span class="pre">True</span></code>, a share network is
required to create a share. The administrator creates share networks
with the desired network, subnet, IP range, and segmentation ID. The HPE
3PAR is configured with an FSIP using the same subnet and
segmentation ID and an IP address allocated from the neutron network.
Using share network-specific IP addresses, subnets, and segmentation IDs
give the appearance of better tenant isolation. Shares on an FPG,
however, are accessible via any of the FSIPs (subject to access rules).
Back end filtering should be used for further separation.</p>
</li>
<li><p class="first">Back end filtering</p>
<p>A Manila HPE 3PAR back end configuration refers to a specific array and
a specific FPG. With multiple backends and multiple tenants, the
scheduler determines where shares will be created. In a scenario where
an array or back end needs to be restricted to one or more specific
tenants, share types can be used to influence the selection of a
back end. For more information on using share types,
see <a class="reference internal" href="hpe-3par-share-driver.html#share-types">Share types</a> .</p>
</li>
<li><p class="first">Tenant limit</p>
<p>The HPE 3PAR driver uses one File Store per tenant per protocol in each
configured FPG. When only one back end is configured, this results in a
limit of eight tenants (16 if only using one protocol). Use multiple
back end configurations to introduce additional FPGs on the same array
to increase the tenant limit.</p>
<p>When using share networks, an FSIP is created for each share network
(when its first share is created on the back end). The HPE 3PAR supports
4 FSIPs per FPG (VFS). One of those 4 FSIPs is reserved for the initial
VFS IP, so the share network limit is 48 share networks per node pair.</p>
</li>
</ul>
</li>
</ul>
</div>
</div>


              </div>
            </div>
          </div>
          <div class="docs-actions">
          
            <a href="hitachi-hsp-driver.html"><i class="fa fa-angle-double-left" data-toggle="tooltip" data-placement="top" title="Previous: Hitachi Hyper Scale-Out Platform File Services Driver for OpenStack"></i></a>
          
          
            <a href="huawei-nas-driver.html"><i class="fa fa-angle-double-right" data-toggle="tooltip" data-placement="top" title="Next: Huawei driver"></i></a>
          
            <a id="logABugLink3" href="hpe-3par-share-driver.html" target="_blank" title="Found an error? Report a bug against this page"><i class="fa fa-bug" data-toggle="tooltip" data-placement="top" title="Report a Bug"></i></a>
          </div>
          <div class="row docs-byline bottom">
            <div class="docs-updated">updated: 2018-02-08 07:41</div>
          </div>
          <div class="row">
            <div class="col-lg-8 col-md-8 col-sm-8 docs-license">
<a href="https://creativecommons.org/licenses/by/3.0/">
 <img src="../../_static/images/docs/license.png" alt="Creative Commons Attribution 3.0 License"/>
</a>
<p>
 Except where otherwise noted, this document is licensed under
 <a href="https://creativecommons.org/licenses/by/3.0/">Creative Commons
 Attribution 3.0 License</a>. See all <a href="http://www.openstack.org/legal">
 OpenStack Legal Documents</a>.
</p>
            </div>
            <div class="col-lg-4 col-md-4 col-sm-4 docs-actions-wrapper">
            <!-- ID buglinkbottom added so that pre-filled doc bugs
                 are sent to Launchpad projects related to the document -->
              <a href="hpe-3par-share-driver.html#" id="logABugLink2" class="docs-footer-actions"><i class="fa fa-bug"></i> found an error? report a bug</a>
              <a href="http://ask.openstack.org" class="docs-footer-actions"><i class="fa fa-question-circle"></i> questions?</a>
            </div>
          </div>
        </div>
<div class="col-lg-3 col-md-4 col-sm-4 col-lg-pull-9 col-md-pull-8 col-sm-pull-8 docs-sidebar">
  <div class="btn-group docs-sidebar-releases">
    <button onclick="location.href='/'" class="btn docs-sidebar-home" data-toggle="tooltip" data-placement="top" title="Docs Home"><i class="fa fa-arrow-circle-o-left"></i></button>
<button href="#" type="button" data-toggle="dropdown" class="btn docs-sidebar-release-select">OpenStack Documentation<i class="fa fa-caret-down"></i></button>
    <ul class="dropdown-menu docs-sidebar-dropdown" role="menu" aria-labelledby="dLabel">
      <li role="presentation" class="dropdown-header">Guides</li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#install-guides">Install Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#user-guides">User Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#configuration-guides">Configuration Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#ops-and-admin-guides">Operations and Administration Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#api-guides">API Guides</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/index.html#contributor-guides">Contributor Guides</a></li>
      <li role="presentation" class="dropdown-header">Languages</li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/ja/">日本語 (Japanese)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/de/">Deutsch (German)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/fr/">Français (French)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/pt_BR/">Português (Portuguese)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/zh_CN/">简体中文 (Simplified Chinese)</a></li>
      <li role="presentation"><a role="menuitem" tabindex="-1" href="http://docs.openstack.org/ko_KR/">한국어 (Korean)</a></li>
    </ul>
  </div>
  <div class="docs-sidebar-toc">
    <div class="docs-sidebar-section" id="table-of-contents">
      <a href="../../index.html" class="docs-sidebar-section-title"><h4>Contents</h4></a>
      <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../config-overview.html">OpenStack configuration overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../common-configurations.html">Common configurations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../application-catalog.html">Application Catalog service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../bare-metal.html">Bare Metal service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../block-storage.html">Block Storage service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../clustering.html">Clustering service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../compute.html">Compute service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dashboard.html">Dashboard</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../data-processing.html">Data Processing service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../database.html">Database service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../identity.html">Identity service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../image.html">Image service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../message.html">Message service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../networking.html">Networking service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../object-storage.html">Object Storage service</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../orchestration.html">Orchestration service</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../shared-file-systems.html">Shared File Systems service</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../overview.html">Introduction to the Shared File Systems service</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api.html">Shared File Systems API configuration</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../drivers.html">Share drivers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../log-files.html">Log files used by Shared File Systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../config-options.html">Additional options</a></li>
<li class="toctree-l2"><a class="reference internal" href="../samples/index.html">Shared File Systems service sample configuration files</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tables/conf-changes/manila.html">New, updated, and deprecated options in Ocata for Shared File Systems service</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../telemetry.html">Telemetry service</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../policy-yaml-file.html">The policy.yaml file</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../policy-json-file.html">The policy.json file</a></li>
</ul>

    </div>
  </div>
</div>
      </div>
    </div>
<footer>
  <div class="container">
    <div class="row footer-links">
      <div class="col-lg-2 col-sm-2">
        <h3>OpenStack</h3>
        <ul>
          <li><a href="http://openstack.org/projects/">Projects</a></li>
          <li><a href="http://openstack.org/projects/openstack-security/">OpenStack Security</a></li>
          <li><a href="http://openstack.org/projects/openstack-faq/">Common Questions</a></li>
          <li><a href="http://openstack.org/blog/">Blog</a></li>
          <li><a href="http://openstack.org/news/">News</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Community</h3>
        <ul>
          <li><a href="http://openstack.org/community/">User Groups</a></li>
          <li><a href="http://openstack.org/community/events/">Events</a></li>
          <li><a href="http://openstack.org/community/jobs/">Jobs</a></li>
          <li><a href="http://openstack.org/foundation/companies/">Companies</a></li>
          <li><a href="http://docs.openstack.org/infra/manual/developers.html">Contribute</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Documentation</h3>
        <ul>
          <li><a href="http://docs.openstack.org">OpenStack Manuals</a></li>
          <li><a href="http://openstack.org/software/start/">Getting Started</a></li>
          <li><a href="http://developer.openstack.org">API Documentation</a></li>
          <li><a href="https://wiki.openstack.org">Wiki</a></li>
        </ul>
      </div>
      <div class="col-lg-2 col-sm-2">
        <h3>Branding & Legal</h3>
        <ul>
          <li><a href="http://openstack.org/brand/">Logos & Guidelines</a></li>
          <li><a href="http://openstack.org/brand/openstack-trademark-policy/">Trademark Policy</a></li>
          <li><a href="http://openstack.org/privacy/">Privacy Policy</a></li>
          <li><a href="https://wiki.openstack.org/wiki/How_To_Contribute#Contributor_License_Agreement">OpenStack CLA</a></li>
        </ul>
      </div>
      <div class="col-lg-4 col-sm-4">
        <h3>Stay In Touch</h3>
        <a href="https://twitter.com/OpenStack" target="_blank" class="social-icons footer-twitter"></a>
        <a href="https://www.facebook.com/openstack" target="_blank" class="social-icons footer-facebook"></a>
        <a href="https://www.linkedin.com/company/openstack" target="_blank" class="social-icons footer-linkedin"></a>
        <a href="https://www.youtube.com/user/OpenStackFoundation" target="_blank" class="social-icons footer-youtube"></a>
        <p class="fine-print">
          The OpenStack project is provided under the
          <a href="http://www.apache.org/licenses/LICENSE-2.0">Apache 2.0 license</a>. Openstack.org is powered by
          <a href="http://rackspace.com" target="_blank">Rackspace Cloud Computing</a>.
        </p>
      </div>
    </div>
  </div>
</footer>
<!-- jQuery -->
<script type="text/javascript" src="../../_static/js/jquery-3.1.1.js"></script>

<!-- Bootstrap JavaScript -->
<script type="text/javascript" src="../../_static/js/bootstrap.js"></script>

<!-- The rest of the JS -->
<script type="text/javascript" src="../../_static/js/navigation.js"></script>

<!-- Docs JS -->
<script type="text/javascript" src="../../_static/js/docs.js"></script>

<!-- Popovers -->
<script type="text/javascript" src="../../_static/js/webui-popover.js"></script>

<!-- Javascript for page -->
<script language="JavaScript">
/* build a description of this page including SHA, source location on git repo,
   build time and the project's launchpad bug tag. Set the HREF of the bug
   buttons */

    var lineFeed = "%0A";
    var gitURL = "Source: Can't derive source file URL";

    /* there have been cases where "pagename" wasn't set; better check for it */
        /* The URL of the source file on Git is based on the giturl variable
           in conf.py, which must be manually initialized to the source file
           URL in Git.
           "pagename" is a standard sphinx parameter containing the name of
           the source file, without extension.                             */

        var sourceFile = "shared-file-systems/drivers/hpe-3par-share-driver" + ".rst";
        gitURL = "Source: https://git.openstack.org/cgit/openstack/openstack-manuals/tree/doc/config-reference/source" + "/" + sourceFile;

    /* gitsha, project and bug_tag rely on variables in conf.py */
    var gitSha = "SHA: 4ad6860c2d8531fd122db0b8b89a923cefdb682f";
        var bugProject = "openstack-manuals";
        var bugTitle = "HPE 3PAR driver in Configuration Reference";
    var fieldTags = "config-reference";

    /* "last_updated" is the build date and time. It relies on the
       conf.py variable "html_last_updated_fmt", which should include
       year/month/day as well as hours and minutes                   */
    var buildstring = "Release: 15.0.0 on 2018-02-08 07:41";

    var fieldComment = encodeURI(buildstring) +
                       lineFeed + encodeURI(gitSha) +
                       lineFeed + encodeURI(gitURL) ;

    logABug(bugTitle, bugProject, fieldComment, fieldTags);
</script>

<!-- Javascript for search boxes (both sidebar and top nav) -->
<script type="text/javascript">
(function() {
var cx = '000108871792296872333:noj9nikm74i';
var gcse = document.createElement('script');
gcse.type = 'text/javascript';
gcse.async = true;
gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
'//www.google.com/cse/cse.js?cx=' + cx;
var s = document.getElementsByTagName('script')[0];
s.parentNode.insertBefore(gcse, s);
})();
</script>

  </body>
</html>