<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<HTML><HEAD><TITLE>ecpg</TITLE><META NAME="GENERATOR" CONTENT="Modular DocBook HTML Stylesheet Version 1.79"><LINK REV="MADE" HREF="mailto:pgsql-docs@postgresql.org"><LINK REL="HOME" TITLE="PostgreSQL 9.3.1 中文手册" HREF="http://school.yunwei.edu/manual/PostgreSQL/index.html"><LINK REL="UP" TITLE="PostgreSQL 客户端应用程序" HREF="http://school.yunwei.edu/manual/PostgreSQL/reference-client.html"><LINK REL="PREVIOUS" TITLE="dropuser" HREF="app-dropuser.html"><LINK REL="NEXT" TITLE="pg_basebackup" HREF="app-pgbasebackup.html"><LINK REL="STYLESHEET" TYPE="text/css" HREF="http://school.yunwei.edu/manual/PostgreSQL/stylesheet.css"><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8"><META NAME="creation" CONTENT="2015-07-11T14:00:17"></HEAD><BODY CLASS="REFENTRY">
<div style="text-align:right">
<a style="margin : 0px 0px 0px 10px;" href="https://github.com/postgres-cn/pgdoc-cn/issues/new" target="_blank" title="在Github上报告问题（请注明问题内容及所在章节）">问题报告</a>
<a style="margin : 0px 0px 0px 10px;" href="https://github.com/postgres-cn/pgdoc-cn/edit/master/postgresql/doc/src/sgml/ref/ecpg-ref.sgml" target="_blank" title="直接在Github上纠错本页面">纠错本页面</a>
</div>
<DIV CLASS="NAVHEADER"><TABLE SUMMARY="Header navigation table" WIDTH="100%" BORDER="0" CELLPADDING="0" CELLSPACING="0"><TR><TH COLSPAN="5" ALIGN="center" VALIGN="bottom"><A HREF="http://school.yunwei.edu/manual/PostgreSQL/index.html">PostgreSQL 9.3.1 中文手册</A></TH></TR><TR><TD WIDTH="10%" ALIGN="left" VALIGN="top"><A TITLE="dropuser" HREF="app-dropuser.html" ACCESSKEY="P">&#19978;&#19968;&#39029;</A></TD><TD WIDTH="10%" ALIGN="left" VALIGN="top"><A HREF="http://school.yunwei.edu/manual/PostgreSQL/reference-client.html" ACCESSKEY="U">&#19978;&#19968;&#32423;</A></TD><TD WIDTH="60%" ALIGN="center" VALIGN="bottom"></TD><TD WIDTH="20%" ALIGN="right" VALIGN="top"><A TITLE="pg_basebackup" HREF="app-pgbasebackup.html" ACCESSKEY="N">&#19979;&#19968;&#39029;</A></TD></TR></TABLE><HR ALIGN="LEFT" WIDTH="100%"></DIV><H1><A NAME="APP-ECPG"></A><SPAN CLASS="APPLICATION">ecpg</SPAN></H1><DIV CLASS="REFNAMEDIV"><A NAME="AEN83644"></A><H2>&#21517;&#31216;</H2><SPAN CLASS="APPLICATION">ecpg</SPAN>&nbsp;--&nbsp;嵌入的 SQL C 预处理器</DIV><DIV CLASS="REFSYNOPSISDIV"><A NAME="AEN83650"></A><H2>&#22823;&#32434;</H2><P><TT CLASS="COMMAND">ecpg</TT> [<TT CLASS="REPLACEABLE"><I>option</I></TT>...] <TT CLASS="REPLACEABLE"><I>file</I></TT>... </P></DIV><DIV CLASS="REFSECT1"><A NAME="APP-ECPG-DESCRIPTION"></A><H2>描述</H2><P><TT CLASS="COMMAND">ecpg</TT>是一个嵌入的用于 C 语言的 SQL 预编译器。
它把嵌有 SQL 语句的 C 程序通过将 SQL 调用替换成特殊的函数调用的方法转换成普通的 C 代码。
然后输出的文件就可以用任何 C 编译工具进行处理。</P><P><TT CLASS="COMMAND">ecpg</TT>将把命令行上给出的每个输入文件转换成对应的 C 输出文件。
输入文件最好有<TT CLASS="FILENAME">.pgc</TT>扩展名，这样，这个扩展将被替换成
<TT CLASS="FILENAME">.c</TT>来决定输出文件名。如果输入文件的扩展不是<TT CLASS="FILENAME">.pgc</TT>，
那么输出文件名将通过在全文件名后面附加<TT CLASS="LITERAL">.c</TT>来生成。
输出文件名也可以用<TT CLASS="OPTION">-o</TT>选项覆盖。</P><P>本手册页并不描述嵌入的 SQL 语句，参阅<A HREF="http://school.yunwei.edu/manual/PostgreSQL/ecpg.html">第 33 &#31456;</A>获更多信息。</P></DIV><DIV CLASS="REFSECT1"><A NAME="AEN83670"></A><H2>选项</H2><P><TT CLASS="COMMAND">ecpg</TT>接受下面命令行参数：
<P></P></P><DIV CLASS="VARIABLELIST"><DL><DT><TT CLASS="OPTION">-c</TT></DT><DD><P>为 SQL 代码自动生成某种 C 代码。目前，这个选项可以用于<TT CLASS="LITERAL">EXEC SQL TYPE</TT>。</P></DD><DT><TT CLASS="OPTION">-C <TT CLASS="REPLACEABLE"><I>mode</I></TT></TT></DT><DD><P>设置一个兼容模式。<TT CLASS="REPLACEABLE"><I>mode</I></TT>可以是<TT CLASS="LITERAL">INFORMIX</TT>
或<TT CLASS="LITERAL">INFORMIX_SE</TT>之一。</P></DD><DT><TT CLASS="OPTION">-D <TT CLASS="REPLACEABLE"><I>symbol</I></TT></TT></DT><DD><P>定义一个 C 预处理器符号。</P></DD><DT><TT CLASS="OPTION">-i</TT></DT><DD><P>同时也分析系统包含文件。</P></DD><DT><TT CLASS="OPTION">-I <TT CLASS="REPLACEABLE"><I>directory</I></TT></TT></DT><DD><P>声明一个附加的包含路径。用于寻找通过<TT CLASS="LITERAL">EXEC SQL INCLUDE</TT>包含的文件。
缺省是：<TT CLASS="FILENAME">.</TT>(当前目录)、<TT CLASS="FILENAME">/usr/local/include</TT>、
在编译时定义的<SPAN CLASS="PRODUCTNAME">PostgreSQL</SPAN>包含路径(缺省为：
<TT CLASS="FILENAME">/usr/local/pgsql/include</TT>)、<TT CLASS="FILENAME">/usr/include</TT>。顺序同上。</P></DD><DT><TT CLASS="OPTION">-o <TT CLASS="REPLACEABLE"><I>filename</I></TT></TT></DT><DD><P>指定<TT CLASS="COMMAND">ecpg</TT>应该把它的所有输出写到给出的<TT CLASS="REPLACEABLE"><I>filename</I></TT>里。</P></DD><DT><TT CLASS="OPTION">-r <TT CLASS="REPLACEABLE"><I>option</I></TT></TT></DT><DD><P>
选择一个运行时行为。<TT CLASS="REPLACEABLE"><I>Option</I></TT>可以是下列的：
<P></P></P><DIV CLASS="VARIABLELIST"><DL><DT><TT CLASS="OPTION">no_indicator</TT></DT><DD><P>不使用指示器，但是使用特殊的值来表示空值。历史上有过数据库使用这种方法。</P></DD><DT><TT CLASS="OPTION">prepare</TT></DT><DD><P>使用它们之前预备所有语句。Libecpg将保存一个预备语句的缓冲，并且如果再次执行就重复使用一个语句。
如果缓存运行满了，Libecpg将释放最近使用的语句。</P></DD><DT><TT CLASS="OPTION">questionmarks</TT></DT><DD><P>允许问号标识为了兼容原因作为占位符。很久以前这是缺省。</P></DD></DL></DIV><P></P></DD><DT><TT CLASS="OPTION">-t</TT></DT><DD><P>打开自动提交模式。在这种模式下，每个查询都自动提交，除非它是包围在一个明确的事务块中。
在缺省模式下，命令只是在发出<TT CLASS="COMMAND">EXEC SQL COMMIT</TT>的时候提交。</P></DD><DT><TT CLASS="OPTION">-v</TT></DT><DD><P>打印额外的信息，包括版本和"include"路径。</P></DD><DT><TT CLASS="OPTION">--version</TT></DT><DD><P>打印<SPAN CLASS="APPLICATION">ecpg</SPAN>版本然后退出。</P></DD><DT><TT CLASS="OPTION">-?</TT><BR><TT CLASS="OPTION">--help</TT></DT><DD><P>显示关于<SPAN CLASS="APPLICATION">ecpg</SPAN>命令行参数的帮助，然后退出。</P></DD></DL></DIV><P>
</P></DIV><DIV CLASS="REFSECT1"><A NAME="AEN83769"></A><H2>注意</H2><P>在编译预处理的 C 代码文件的时候，编译器需要能够找到<SPAN CLASS="PRODUCTNAME">PostgreSQL</SPAN>
包含目录里面的<SPAN CLASS="APPLICATION">ECPG</SPAN>头文件。因此，在调用编译器的时候可能需要使用
<TT CLASS="OPTION">-I</TT>选项(比如<TT CLASS="LITERAL">-I/usr/local/pgsql/include</TT>)。</P><P>使用了嵌入 SQL 的 C 代码必须和<TT CLASS="FILENAME">libecpg</TT>库链接，比如，
使用这样的链接选项：<TT CLASS="LITERAL">-L/usr/local/pgsql/lib -lecpg</TT>。</P><P>这些目录的实际值可以通过<A HREF="app-pgconfig.html">pg_config</A>找到。</P></DIV><DIV CLASS="REFSECT1"><A NAME="AEN83781"></A><H2>例子</H2><P>如果你有一个叫<TT CLASS="FILENAME">prog1.pgc</TT>的嵌入 SQL 的 C 源代码，
你可以用下面的命令序列创建一个可执行程序：
</P><PRE CLASS="PROGRAMLISTING">ecpg prog1.pgc
cc -I/usr/local/pgsql/include -c prog1.c
cc -o prog1 prog1.o -L/usr/local/pgsql/lib -lecpg</PRE><P></P></DIV><DIV CLASS="NAVFOOTER"><HR ALIGN="LEFT" WIDTH="100%"><TABLE SUMMARY="Footer navigation table" WIDTH="100%" BORDER="0" CELLPADDING="0" CELLSPACING="0"><TR><TD WIDTH="33%" ALIGN="left" VALIGN="top"><A HREF="app-dropuser.html" ACCESSKEY="P">&#19978;&#19968;&#39029;</A></TD><TD WIDTH="34%" ALIGN="center" VALIGN="top"><A HREF="http://school.yunwei.edu/manual/PostgreSQL/index.html" ACCESSKEY="H">&#36215;&#22987;&#39029;</A></TD><TD WIDTH="33%" ALIGN="right" VALIGN="top"><A HREF="app-pgbasebackup.html" ACCESSKEY="N">&#19979;&#19968;&#39029;</A></TD></TR><TR><TD WIDTH="33%" ALIGN="left" VALIGN="top"><SPAN CLASS="APPLICATION">dropuser</SPAN></TD><TD WIDTH="34%" ALIGN="center" VALIGN="top"><A HREF="http://school.yunwei.edu/manual/PostgreSQL/reference-client.html" ACCESSKEY="U">&#19978;&#19968;&#32423;</A></TD><TD WIDTH="33%" ALIGN="right" VALIGN="top">pg_basebackup</TD></TR></TABLE></DIV></BODY></HTML>
