<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<HTML><HEAD><TITLE>ALTER SEQUENCE</TITLE><META NAME="GENERATOR" CONTENT="Modular DocBook HTML Stylesheet Version 1.79"><LINK REV="MADE" HREF="mailto:pgsql-docs@postgresql.org"><LINK REL="HOME" TITLE="PostgreSQL 9.3.1 中文手册" HREF="http://school.yunwei.edu/manual/PostgreSQL/index.html"><LINK REL="UP" TITLE="SQL 命令" HREF="http://school.yunwei.edu/manual/PostgreSQL/sql-commands.html"><LINK REL="PREVIOUS" TITLE="ALTER SCHEMA" HREF="sql-alterschema.html"><LINK REL="NEXT" TITLE="ALTER SERVER" HREF="sql-alterserver.html"><LINK REL="STYLESHEET" TYPE="text/css" HREF="http://school.yunwei.edu/manual/PostgreSQL/stylesheet.css"><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8"><META NAME="creation" CONTENT="2015-07-11T14:00:17"></HEAD><BODY CLASS="REFENTRY">
<div style="text-align:right">
<a style="margin : 0px 0px 0px 10px;" href="https://github.com/postgres-cn/pgdoc-cn/issues/new" target="_blank" title="在Github上报告问题（请注明问题内容及所在章节）">问题报告</a>
<a style="margin : 0px 0px 0px 10px;" href="https://github.com/postgres-cn/pgdoc-cn/edit/master/postgresql/doc/src/sgml/ref/alter_sequence.sgml" target="_blank" title="直接在Github上纠错本页面">纠错本页面</a>
</div>
<DIV CLASS="NAVHEADER"><TABLE SUMMARY="Header navigation table" WIDTH="100%" BORDER="0" CELLPADDING="0" CELLSPACING="0"><TR><TH COLSPAN="5" ALIGN="center" VALIGN="bottom"><A HREF="http://school.yunwei.edu/manual/PostgreSQL/index.html">PostgreSQL 9.3.1 中文手册</A></TH></TR><TR><TD WIDTH="10%" ALIGN="left" VALIGN="top"><A TITLE="ALTER SCHEMA" HREF="sql-alterschema.html" ACCESSKEY="P">&#19978;&#19968;&#39029;</A></TD><TD WIDTH="10%" ALIGN="left" VALIGN="top"><A HREF="http://school.yunwei.edu/manual/PostgreSQL/sql-commands.html" ACCESSKEY="U">&#19978;&#19968;&#32423;</A></TD><TD WIDTH="60%" ALIGN="center" VALIGN="bottom"></TD><TD WIDTH="20%" ALIGN="right" VALIGN="top"><A TITLE="ALTER SERVER" HREF="sql-alterserver.html" ACCESSKEY="N">&#19979;&#19968;&#39029;</A></TD></TR></TABLE><HR ALIGN="LEFT" WIDTH="100%"></DIV><H1><A NAME="SQL-ALTERSEQUENCE"></A>ALTER SEQUENCE</H1><DIV CLASS="REFNAMEDIV"><A NAME="AEN66178"></A><H2>&#21517;&#31216;</H2>ALTER SEQUENCE&nbsp;--&nbsp; 更改一个序列生成器的定义
</DIV><DIV CLASS="REFSYNOPSISDIV"><A NAME="AEN66183"></A><H2>&#22823;&#32434;</H2><PRE CLASS="SYNOPSIS">ALTER SEQUENCE [ IF EXISTS ] <TT
CLASS="REPLACEABLE"
><I
>name</I
></TT
> [ INCREMENT [ BY ] <TT
CLASS="REPLACEABLE"
><I
>increment</I
></TT
> ]
    [ MINVALUE <TT
CLASS="REPLACEABLE"
><I
>minvalue</I
></TT
> | NO MINVALUE ] [ MAXVALUE <TT
CLASS="REPLACEABLE"
><I
>maxvalue</I
></TT
> | NO MAXVALUE ]
    [ START [ WITH ] <TT
CLASS="REPLACEABLE"
><I
>start</I
></TT
> ]
    [ RESTART [ [ WITH ] <TT
CLASS="REPLACEABLE"
><I
>restart</I
></TT
> ] ]
    [ CACHE <TT
CLASS="REPLACEABLE"
><I
>cache</I
></TT
> ] [ [ NO ] CYCLE ]
    [ OWNED BY { <TT
CLASS="REPLACEABLE"
><I
>table_name</I
></TT
>.<TT
CLASS="REPLACEABLE"
><I
>column_name</I
></TT
> | NONE } ]
ALTER SEQUENCE [ IF EXISTS ] <TT
CLASS="REPLACEABLE"
><I
>name</I
></TT
> OWNER TO <TT
CLASS="REPLACEABLE"
><I
>new_owner</I
></TT
>
ALTER SEQUENCE [ IF EXISTS ] <TT
CLASS="REPLACEABLE"
><I
>name</I
></TT
> RENAME TO <TT
CLASS="REPLACEABLE"
><I
>new_name</I
></TT
>
ALTER SEQUENCE [ IF EXISTS ] <TT
CLASS="REPLACEABLE"
><I
>name</I
></TT
> SET SCHEMA <TT
CLASS="REPLACEABLE"
><I
>new_schema</I
></TT
></PRE></DIV><DIV CLASS="REFSECT1"><A NAME="AEN66200"></A><H2>描述</H2><P><TT CLASS="COMMAND">ALTER SEQUENCE</TT> 命令修改一个现有的序列发生器的参数。 任何没有明确在
<TT CLASS="COMMAND">ALTER SEQUENCE</TT> 命令里声明的参数都将保留原先的设置。</P><P>要使用<TT CLASS="COMMAND">ALTER SEQUENCE</TT>，你必须是该序列的所有者。
要改变一个序列的模式，你必须在新的模式上有 <TT CLASS="LITERAL">CREATE</TT> 权限。
要改变一个序列的所有者，你必须也是新的所有角色的直接或者间接的成员，并且那个角色必须有序列模式上的<TT CLASS="LITERAL">CREATE</TT> 权限。
（这些约束强制在改变所有者时只能做删除或者创建序列时能做的操作。然而，超级用户可以以任何方式改变任意序列的成员关系。）&#13;</P></DIV><DIV CLASS="REFSECT1"><A NAME="AEN66209"></A><H2>参数</H2><P> <P></P></P><DIV CLASS="VARIABLELIST"><DL><DT><TT CLASS="REPLACEABLE"><I>name</I></TT></DT><DD><P>一个要修改的序列的名字(可以有模式修饰)。</P></DD><DT><TT CLASS="LITERAL">IF EXISTS</TT></DT><DD><P>当序列不存在时使用该选项不会出现错误信息，仅有一个提示信息。</P></DD><DT><TT CLASS="REPLACEABLE"><I>increment</I></TT></DT><DD><P><TT CLASS="LITERAL">INCREMENT BY <TT CLASS="REPLACEABLE"><I>increment</I></TT></TT>选项是可选的。
一个正数会让序列成为递增序列，负数则成为递减序列。如果没有声明，将沿用原来的递增值。</P></DD><DT><TT CLASS="REPLACEABLE"><I>minvalue</I></TT><BR><TT CLASS="LITERAL">NO MINVALUE</TT></DT><DD><P><TT CLASS="LITERAL">MINVALUE <TT CLASS="REPLACEABLE"><I>minvalue</I></TT></TT>是一个可选选项，它决定一个序列可以生成的最小的值。
如果声明了<TT CLASS="LITERAL">NO MINVALUE</TT>，那么将使用缺省值，对于递增和递减的序列分别是1和-2<SUP>63</SUP>-1。
如果没有声明则沿用当前的最小值。</P></DD><DT><TT CLASS="REPLACEABLE"><I>maxvalue</I></TT><BR><TT CLASS="LITERAL">NO MAXVALUE</TT></DT><DD><P><TT CLASS="LITERAL">MAXVALUE <TT CLASS="REPLACEABLE"><I>maxvalue</I></TT></TT>是一个可选选项，它决定一个序列可以生成的最大的值。
如果声明了<TT CLASS="LITERAL">NO MAXVALUE</TT>那么将使用缺省值，对于递增和递减的序列分别是2<SUP>63</SUP>-1和-1。
如果没有声明则沿用当前的最大值。</P></DD><DT><TT CLASS="REPLACEABLE"><I>start</I></TT></DT><DD><P><TT CLASS="LITERAL">START WITH <TT CLASS="REPLACEABLE"><I>start</I></TT></TT>是一个可选选项，它修改序列的起始值。
这对序列<SPAN CLASS="emphasis"><I CLASS="EMPHASIS">当前</I></SPAN>值没有影响；它仅设置将来的<TT CLASS="COMMAND">ALTER SEQUENCE RESTART</TT>命令将会使用的值。</P></DD><DT><TT CLASS="REPLACEABLE"><I>restart</I></TT></DT><DD><P><TT CLASS="LITERAL">RESTART [ WITH <TT CLASS="REPLACEABLE"><I>restart</I></TT> ]</TT>是一个可选选项，它改变序列的当前值。
这相当于用<TT CLASS="LITERAL">is_called</TT> = <TT CLASS="LITERAL">false</TT>参数调用<CODE CLASS="FUNCTION">setval</CODE> 函数 ：指定的值将会通过<CODE CLASS="FUNCTION">nextval</CODE>的<SPAN CLASS="emphasis"><I CLASS="EMPHASIS">next</I></SPAN>调用返回。
不使用<TT CLASS="REPLACEABLE"><I>restart</I></TT>参数值来使用<TT CLASS="LITERAL">RESTART</TT>选项相当于使用<TT CLASS="COMMAND">CREATE SEQUENCE</TT>或由<TT CLASS="COMMAND">ALTER SEQUENCE START WITH</TT>设置的初始值。</P></DD><DT><TT CLASS="REPLACEABLE"><I>cache</I></TT></DT><DD><P><TT CLASS="LITERAL">CACHE <TT CLASS="REPLACEABLE"><I>cache</I></TT></TT>选项打开序列号预分配功能以及为了快速存取而在内存中存储的功能。
最小值是1（表示每次只能生成一个数值，没有缓冲）。如果没有声明，将沿用旧的缓冲值。</P></DD><DT><TT CLASS="LITERAL">CYCLE</TT></DT><DD><P>可选的 <TT CLASS="LITERAL">CYCLE</TT>选项用于设置升序序列或是降序序列在达到<TT CLASS="REPLACEABLE"><I>maxvalue</I></TT>或者<TT CLASS="REPLACEABLE"><I>minvalue</I></TT>的时候循环使用。
如果达到了极限， 那么生成的下一个数字将分别是<TT CLASS="REPLACEABLE"><I>minvalue</I></TT>或者<TT CLASS="REPLACEABLE"><I>maxvalue</I></TT>。</P></DD><DT><TT CLASS="LITERAL">NO CYCLE</TT></DT><DD><P>如果声明了可选的<TT CLASS="LITERAL">NO CYCLE</TT>选项，任何在序列达到其极限后对<CODE CLASS="FUNCTION">nextval</CODE>的调用都将返回错误。
如果未声明<TT CLASS="LITERAL">CYCLE</TT>或者<TT CLASS="LITERAL">NO CYCLE</TT>，那么将沿用原有的循环行为。</P></DD><DT><TT CLASS="LITERAL">OWNED BY</TT> <TT CLASS="REPLACEABLE"><I>table_name</I></TT>.<TT CLASS="REPLACEABLE"><I>column_name</I></TT><BR><TT CLASS="LITERAL">OWNED BY NONE</TT></DT><DD><P><TT CLASS="LITERAL">OWNED BY</TT>选项将序列和一个表的特定字段关联， 这样，如果那个字段(或整个表)被删除了，那么序列也将被自动删除。
如果序列已经与表有关联后，使用这个选项后新关联将覆盖旧有的关联。
指定的表必须与序列的所有者相同并且在同一个模式中。
使用<TT CLASS="LITERAL">OWNED BY NONE</TT>将删除任何已经存在的关联，也就是让该序列变成"独立"序列。</P></DD><DT><TT CLASS="REPLACEABLE"><I>new_owner</I></TT></DT><DD><P>序列新所有者的用户名。</P></DD><DT><TT CLASS="REPLACEABLE"><I>new_name</I></TT></DT><DD><P>序列的新名称。</P></DD><DT><TT CLASS="REPLACEABLE"><I>new_schema</I></TT></DT><DD><P>序列的新模式。</P></DD></DL></DIV><P>
</P></DIV><DIV CLASS="REFSECT1"><A NAME="AEN66329"></A><H2>注意</H2><P>为避免从同一序列获取序列值的并发事务阻塞，在序列产生参数上的<TT CLASS="COMMAND">ALTER SEQUENCE</TT>的影响从不回滚；
这些改变会立刻生效并且是不可逆的；然而，<TT CLASS="LITERAL">OWNED BY</TT>、<TT CLASS="LITERAL">OWNER TO</TT>、<TT CLASS="LITERAL">RENAME TO</TT>和<TT CLASS="LITERAL">SET SCHEMA</TT>选项会引起可被回滚的普通更新。</P><P>除了当前的正在运行取值操作，<TT CLASS="COMMAND">ALTER SEQUENCE</TT>不会立刻影响后台的<CODE CLASS="FUNCTION">nextval</CODE>结果 。
序列在使用完所有缓存的序列值后才会使用变化后的序列参数值。当前后台正在运行取值操作将会立刻受到影响。</P><P><TT CLASS="COMMAND">ALTER SEQUENCE</TT>不影响序列的<CODE CLASS="FUNCTION">currval</CODE>状态。（在PostgreSQL 8.3之前，有时会影响。）</P><P>由于历史原因，<TT CLASS="COMMAND">ALTER TABLE</TT>也可用于序列；但是<TT CLASS="COMMAND">ALTER TABLE</TT>仅有的与序列有关的变化等价于前面所示的形式。</P></DIV><DIV CLASS="REFSECT1"><A NAME="AEN66346"></A><H2>例子</H2><P>将序列serial设置为从105重新开始取值：
</P><PRE CLASS="PROGRAMLISTING">ALTER SEQUENCE serial RESTART WITH 105;</PRE><P></P></DIV><DIV CLASS="REFSECT1"><A NAME="AEN66350"></A><H2>兼容性</H2><P><TT CLASS="COMMAND">ALTER SEQUENCE</TT>遵从<ACRONYM CLASS="ACRONYM">SQL</ACRONYM>标准，但<TT CLASS="LITERAL">START WITH</TT>、
<TT CLASS="LITERAL">OWNED BY</TT>、<TT CLASS="LITERAL">OWNER TO</TT>、<TT CLASS="LITERAL">RENAME TO</TT>和<TT CLASS="LITERAL">SET SCHEMA</TT>选项是
<SPAN CLASS="PRODUCTNAME">PostgreSQL</SPAN>的扩展。</P></DIV><DIV CLASS="REFSECT1"><A NAME="AEN66361"></A><H2>参见</H2><A HREF="sql-createsequence.html">CREATE SEQUENCE</A>, <A HREF="sql-dropsequence.html">DROP SEQUENCE</A></DIV><DIV CLASS="NAVFOOTER"><HR ALIGN="LEFT" WIDTH="100%"><TABLE SUMMARY="Footer navigation table" WIDTH="100%" BORDER="0" CELLPADDING="0" CELLSPACING="0"><TR><TD WIDTH="33%" ALIGN="left" VALIGN="top"><A HREF="sql-alterschema.html" ACCESSKEY="P">&#19978;&#19968;&#39029;</A></TD><TD WIDTH="34%" ALIGN="center" VALIGN="top"><A HREF="http://school.yunwei.edu/manual/PostgreSQL/index.html" ACCESSKEY="H">&#36215;&#22987;&#39029;</A></TD><TD WIDTH="33%" ALIGN="right" VALIGN="top"><A HREF="sql-alterserver.html" ACCESSKEY="N">&#19979;&#19968;&#39029;</A></TD></TR><TR><TD WIDTH="33%" ALIGN="left" VALIGN="top">ALTER SCHEMA</TD><TD WIDTH="34%" ALIGN="center" VALIGN="top"><A HREF="http://school.yunwei.edu/manual/PostgreSQL/sql-commands.html" ACCESSKEY="U">&#19978;&#19968;&#32423;</A></TD><TD WIDTH="33%" ALIGN="right" VALIGN="top">ALTER SERVER</TD></TR></TABLE></DIV></BODY></HTML>
