<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<HTML><HEAD><TITLE>postgres</TITLE><META NAME="GENERATOR" CONTENT="Modular DocBook HTML Stylesheet Version 1.79"><LINK REV="MADE" HREF="mailto:pgsql-docs@postgresql.org"><LINK REL="HOME" TITLE="PostgreSQL 9.3.1 中文手册" HREF="http://school.yunwei.edu/manual/PostgreSQL/index.html"><LINK REL="UP" TITLE="PostgreSQL 服务器应用程序" HREF="http://school.yunwei.edu/manual/PostgreSQL/reference-server.html"><LINK REL="PREVIOUS" TITLE="pg_resetxlog" HREF="app-pgresetxlog.html"><LINK REL="NEXT" TITLE="postmaster" HREF="app-postmaster.html"><LINK REL="STYLESHEET" TYPE="text/css" HREF="http://school.yunwei.edu/manual/PostgreSQL/stylesheet.css"><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8"><META NAME="creation" CONTENT="2015-07-11T14:00:17"></HEAD><BODY CLASS="REFENTRY">
<div style="text-align:right">
<a style="margin : 0px 0px 0px 10px;" href="https://github.com/postgres-cn/pgdoc-cn/issues/new" target="_blank" title="在Github上报告问题（请注明问题内容及所在章节）">问题报告</a>
<a style="margin : 0px 0px 0px 10px;" href="https://github.com/postgres-cn/pgdoc-cn/edit/master/postgresql/doc/src/sgml/ref/postgres-ref.sgml" target="_blank" title="直接在Github上纠错本页面">纠错本页面</a>
</div>
<DIV CLASS="NAVHEADER"><TABLE SUMMARY="Header navigation table" WIDTH="100%" BORDER="0" CELLPADDING="0" CELLSPACING="0"><TR><TH COLSPAN="5" ALIGN="center" VALIGN="bottom"><A HREF="http://school.yunwei.edu/manual/PostgreSQL/index.html">PostgreSQL 9.3.1 中文手册</A></TH></TR><TR><TD WIDTH="10%" ALIGN="left" VALIGN="top"><A TITLE="pg_resetxlog" HREF="app-pgresetxlog.html" ACCESSKEY="P">&#19978;&#19968;&#39029;</A></TD><TD WIDTH="10%" ALIGN="left" VALIGN="top"><A HREF="http://school.yunwei.edu/manual/PostgreSQL/reference-server.html" ACCESSKEY="U">&#19978;&#19968;&#32423;</A></TD><TD WIDTH="60%" ALIGN="center" VALIGN="bottom"></TD><TD WIDTH="20%" ALIGN="right" VALIGN="top"><A TITLE="postmaster" HREF="app-postmaster.html" ACCESSKEY="N">&#19979;&#19968;&#39029;</A></TD></TR></TABLE><HR ALIGN="LEFT" WIDTH="100%"></DIV><H1><A NAME="APP-POSTGRES"></A><SPAN CLASS="APPLICATION">postgres</SPAN></H1><DIV CLASS="REFNAMEDIV"><A NAME="AEN89958"></A><H2>&#21517;&#31216;</H2>postgres&nbsp;--&nbsp;<SPAN CLASS="PRODUCTNAME">PostgreSQL</SPAN> 数据库服务器</DIV><DIV CLASS="REFSYNOPSISDIV"><A NAME="AEN89964"></A><H2>&#22823;&#32434;</H2><P><TT CLASS="COMMAND">postgres</TT> [<TT CLASS="REPLACEABLE"><I>option</I></TT>...]</P></DIV><DIV CLASS="REFSECT1"><A NAME="AEN89969"></A><H2>描述</H2><P><TT CLASS="COMMAND">postgres</TT>是<SPAN CLASS="PRODUCTNAME">PostgreSQL</SPAN>数据库服务器。
客户端应用程序为了访问数据库，将通过网络或本地连接到一个运行中的
<TT CLASS="COMMAND">postgres</TT>进程。然后该<TT CLASS="COMMAND">postgres</TT>
实例将启动一个独立的服务器进程来处理这个连接。</P><P>一个<TT CLASS="COMMAND">postgres</TT>总是管理来自同一个数据库集群的数据。
一个数据库集群是一组在同一个文件系统位置(<SPAN CLASS="QUOTE">"数据区"</SPAN>)存放数据的数据库。
一个系统上可以同时运行多个<TT CLASS="COMMAND">postgres</TT>进程，
只要他们使用不同的数据区和不同的端口号(见下文)。<TT CLASS="COMMAND">postgres</TT>
启动时需要知道数据区的位置，该位置必须通过<TT CLASS="OPTION">-D</TT>选项或<TT CLASS="ENVAR">PGDATA</TT>
环境变量指定；没有缺省值。通常，<TT CLASS="OPTION">-D</TT>或<TT CLASS="ENVAR">PGDATA</TT>
都直接指向由<A HREF="app-initdb.html">initdb</A>创建的数据区。其他可能的文件布局在
<A HREF="runtime-config-file-locations.html">第 18.2 &#33410;</A>里面有讨论。</P><P>缺省时<TT CLASS="COMMAND">postgres</TT>在前台启动并将日志信息输出到标准错误。
但在实际应用中，<TT CLASS="COMMAND">postgres</TT>应当作为后台进程启动，而且多数是在系统启动时自动启动。</P><P><TT CLASS="COMMAND">postgres</TT>还能以单用户模式运行。这种用法主要用于<A HREF="app-initdb.html">initdb</A>
的初始化过程中。有时候它也被用于调试或灾难性恢复。注意，
单用户模式运行的服务器并不适合于调试，因为没有实际的进程间通讯和锁动作发生。
当从 shell 上以单用户模式调用时，用户可以输入查询，
然后结果会在屏幕上以一种更适合开发者阅读(不适合普通用户)的格式显示出来。
在单用户模式下，将把会话用户 ID 设为 1 并赋予超级用户权限。该用户不必实际存在，
因此单用户模式运行的服务器可以用于对某些意外损坏的系统表进行手工恢复。</P></DIV><DIV CLASS="REFSECT1"><A NAME="APP-POSTGRES-OPTIONS"></A><H2>选项</H2><P><TT CLASS="COMMAND">postgres</TT>接受下列命令行参数。关于这些选项的更详细讨论请参考
<A HREF="http://school.yunwei.edu/manual/PostgreSQL/runtime-config.html">第 18 &#31456;</A>。你也可以通过设置一个配置文件来减少敲击这些选项。
有些(安全的)选项还可以从连接过来的客户端设置，以一种应用相关的方法仅对该会话生效。
比如，如果设置了<TT CLASS="ENVAR">PGOPTIONS</TT>环境变量，那么基于<SPAN CLASS="APPLICATION">libpq</SPAN>
的客户端就都把那个字符串传递给服务器，并被服务器解释成<TT CLASS="COMMAND">postgres</TT>命令行选项。</P><DIV CLASS="REFSECT2"><A NAME="AEN90001"></A><H3>通用用途</H3><P></P><DIV CLASS="VARIABLELIST"><DL><DT><TT CLASS="OPTION">-A 0|1</TT></DT><DD><P>打开运行时断言检查，是检测编程错误的调试帮助。只有在编译<SPAN CLASS="PRODUCTNAME">PostgreSQL</SPAN>
时打开了它，你才能使用它。缺省是打开。</P></DD><DT><TT CLASS="OPTION">-B <TT CLASS="REPLACEABLE"><I>nbuffers</I></TT></TT></DT><DD><P>为服务器进程分配和管理的共享内存缓冲区数量。这个参数的缺省值是
<SPAN CLASS="APPLICATION">initdb</SPAN>自动选择的；声明这个选项等同于设置
<A HREF="runtime-config-resource.html#GUC-SHARED-BUFFERS">shared_buffers</A>配置参数。</P></DD><DT><TT CLASS="OPTION">-c <TT CLASS="REPLACEABLE"><I>name</I></TT>=<TT CLASS="REPLACEABLE"><I>value</I></TT></TT></DT><DD><P>设置一个命名的运行时参数。<SPAN CLASS="PRODUCTNAME">PostgreSQL</SPAN>支持的配置参数在
<A HREF="http://school.yunwei.edu/manual/PostgreSQL/runtime-config.html">第 18 &#31456;</A>里描述。大多数其它命令行选项实际上都是这样的参数赋值的短形式。
<TT CLASS="OPTION">-c</TT>可以出现多次从而设置多个参数。</P></DD><DT><TT CLASS="OPTION">-C <TT CLASS="REPLACEABLE"><I>name</I></TT></TT></DT><DD><P>打印命名的运行时参数的值，然后退出。（参阅上面的<TT CLASS="OPTION">-c</TT>选项获取详细信息。）
这个选项可以在一个运行的服务器上使用，返回来自<TT CLASS="FILENAME">postgresql.conf</TT>的值，
通过在这个调用中提供的参数修改。当集群启动时，它不反应提供的参数。</P><P>这个选项本应为与服务器进程交互的其他程序，例如<A HREF="app-pg-ctl.html"><SPAN CLASS="APPLICATION">pg_ctl</SPAN></A>，
查询配置参数值。面向用户的应用应该使用xref linkend="sql-show"&#62;或
<TT CLASS="STRUCTNAME">pg_settings</TT>视图。</P></DD><DT><TT CLASS="OPTION">-d <TT CLASS="REPLACEABLE"><I>debug-level</I></TT></TT></DT><DD><P>设置调试级别。数值越高，写到服务器日志的调试输出越多。取值范围是 1 到 5 。
还可以针对某次单独的会话使用<TT CLASS="LITERAL">-d 0</TT>来防止从父<TT CLASS="COMMAND">postgres</TT>
进程继承日志级别。</P></DD><DT><TT CLASS="OPTION">-D <TT CLASS="REPLACEABLE"><I>datadir</I></TT></TT></DT><DD><P>声明数据库配置文件的文件系统路径。细节详见<A HREF="runtime-config-file-locations.html">第 18.2 &#33410;</A>。</P></DD><DT><TT CLASS="OPTION">-e</TT></DT><DD><P>把缺省日期风格设置为<SPAN CLASS="QUOTE">"European"</SPAN>，也就是说用<TT CLASS="LITERAL">DMY</TT>规则解释日期输入，
并且在一些日期输出格式里日子在月份前面打印。参阅<A HREF="datatype-datetime.html">第 8.5 &#33410;</A>获取更多细节。</P></DD><DT><TT CLASS="OPTION">-F</TT></DT><DD><P>关闭<CODE CLASS="FUNCTION">fsync</CODE>调用以提高性能，但是要冒系统崩溃时数据毁坏的风险。
声明这个选项等效关闭了<A HREF="runtime-config-wal.html#GUC-FSYNC">fsync</A>参数。在使用之前阅读详细文档！</P></DD><DT><TT CLASS="OPTION">-h <TT CLASS="REPLACEABLE"><I>hostname</I></TT></TT></DT><DD><P>指定<TT CLASS="COMMAND">postgres</TT>侦听来自前端应用 TCP/IP 连接的 IP 主机名或地址。
数值也可以是一个用逗号分隔的地址列表，或者<TT CLASS="LITERAL">*</TT>表示监听所有可用的地址。
空值表示不监听任何 IP 地址，而只使用 Unix 域套接字与服务器连接。
缺省只监听<SPAN CLASS="SYSTEMITEM">localhost</SPAN>。
声明这个选项等效于设置<A HREF="runtime-config-connection.html#GUC-LISTEN-ADDRESSES">listen_addresses</A>配置参数。</P></DD><DT><TT CLASS="OPTION">-i</TT></DT><DD><P>这个选项允许远程客户通过 TCP/IP(网际域套接字)与服务器通讯。没有这个选项，
服务器将只接受本地连接。这个选项等效于在<TT CLASS="FILENAME">postgresql.conf</TT>
中或者通过<TT CLASS="OPTION">-h</TT>选项将<TT CLASS="VARNAME">listen_addresses</TT>设为<TT CLASS="LITERAL">*</TT>。</P><P>这个选项已经废弃了，因为它不能实现<A HREF="runtime-config-connection.html#GUC-LISTEN-ADDRESSES">listen_addresses</A>的所有功能。
所以最好直接设置<TT CLASS="VARNAME">listen_addresses</TT>。</P></DD><DT><TT CLASS="OPTION">-k <TT CLASS="REPLACEABLE"><I>directory</I></TT></TT></DT><DD><P>指定<TT CLASS="COMMAND">postgres</TT>侦听来自前端应用连接的 Unix 域套接字的目录。
该值也可以是逗号分隔的目录列表。空值表明不监听任何 Unix 域套接字，在这种情况下，
只有TCP/IP套接字可以用来连接到服务器。缺省通常是<TT CLASS="FILENAME">/tmp</TT>，
但是可以在编译的时候修改。声明这个选项等同于设置<A HREF="runtime-config-connection.html#GUC-UNIX-SOCKET-DIRECTORIES">unix_socket_directories</A>
配置参数。</P></DD><DT><TT CLASS="OPTION">-l</TT></DT><DD><P>这个选项使用<ACRONYM CLASS="ACRONYM">SSL</ACRONYM>进行的安全通讯。要使用这个选项，
编译<SPAN CLASS="PRODUCTNAME">PostgreSQL</SPAN>时你必须打开了<ACRONYM CLASS="ACRONYM">SSL</ACRONYM>支持。
有关使用<ACRONYM CLASS="ACRONYM">SSL</ACRONYM>的信息，请参考<A HREF="ssl-tcp.html">第 17.9 &#33410;</A>。</P></DD><DT><TT CLASS="OPTION">-N <TT CLASS="REPLACEABLE"><I>max-connections</I></TT></TT></DT><DD><P>设置最多允许同时连接多少个客户端(也就是最多同时运行多少个服务器进程)。
这个参数的缺省值自动通过<SPAN CLASS="APPLICATION">initdb</SPAN>选择。
声明这个选项等效于声明<A HREF="runtime-config-connection.html#GUC-MAX-CONNECTIONS">max_connections</A>配置参数。</P></DD><DT><TT CLASS="OPTION">-o <TT CLASS="REPLACEABLE"><I>extra-options</I></TT></TT></DT><DD><P>在<TT CLASS="REPLACEABLE"><I>extra-options</I></TT>
里面指定的命令行选项将被传递给所有由这个<TT CLASS="COMMAND">postgres</TT>派生的服务进程。
如果选项字符串包含任何空白，那么整个字符串必须用引号界定。</P><P>反对使用该选项，所有服务器进程的命令行选项都可以直接在<TT CLASS="COMMAND">postgres</TT>
命令行上指定。</P></DD><DT><TT CLASS="OPTION">-p <TT CLASS="REPLACEABLE"><I>port</I></TT></TT></DT><DD><P>指定<TT CLASS="COMMAND">postgres</TT>侦听客户端连接的 TCP/IP 端口或本地 Unix 域套接字文件的扩展。
缺省的端口号是环境变量<TT CLASS="ENVAR">PGPORT</TT>的值。如果<TT CLASS="ENVAR">PGPORT</TT>没有设置，
那么缺省是 PostgreSQL 编译时指定的值(通常是 5432)。如果你声明了一个非缺省端口，
那么所有前端应用都必须用命令行选项或者<TT CLASS="ENVAR">PGPORT</TT>声明同一个端口。</P></DD><DT><TT CLASS="OPTION">-s</TT></DT><DD><P>在每条命令结束时打印时间信息和其它统计信息。这个选项对测试性能和调节缓冲区数量有好处。</P></DD><DT><TT CLASS="OPTION">-S</TT> <TT CLASS="REPLACEABLE"><I>work-mem</I></TT></DT><DD><P>声明内部排序和散列在求助于临时磁盘文件之前可以使用的内存数量。
参阅<A HREF="runtime-config-resource.html#RUNTIME-CONFIG-RESOURCE-MEMORY">第 18.4.1 &#33410;</A>里描述的配置变量<TT CLASS="VARNAME">work_mem</TT>。 </P></DD><DT><TT CLASS="OPTION">-V</TT><BR><TT CLASS="OPTION">--version</TT></DT><DD><P>打印<SPAN CLASS="APPLICATION">postgres</SPAN>版本然后退出。</P></DD><DT><TT CLASS="OPTION">--<TT CLASS="REPLACEABLE"><I>name</I></TT>=<TT CLASS="REPLACEABLE"><I>value</I></TT></TT></DT><DD><P>设置一个命名的运行时参数；其缩写形式是<TT CLASS="OPTION">-c</TT>。</P></DD><DT><TT CLASS="OPTION">--describe-config</TT></DT><DD><P>以制表符分隔的<TT CLASS="COMMAND">COPY</TT>格式，导出服务器内部配置变量、描述、缺省值。
设计它主要是给管理工具使用。</P></DD><DT><TT CLASS="OPTION">-?</TT><BR><TT CLASS="OPTION">--help</TT></DT><DD><P>显示关于<SPAN CLASS="APPLICATION">postgres</SPAN>命令行参数的帮助然后退出。</P></DD></DL></DIV></DIV><DIV CLASS="REFSECT2"><A NAME="AEN90181"></A><H3>部分内部选项</H3><P>这里描述的选项主要用于调试用途，并且在某些情况下帮助严重损坏的数据库恢复。
不应该在生产数据库的设置中使用这些选项。在这里列出只是给<SPAN CLASS="PRODUCTNAME">PostgreSQL</SPAN>
系统开发人员使用的。另外这些选项都可能在未来版本中改变或删除而不加说明。</P><P></P><DIV CLASS="VARIABLELIST"><DL><DT><TT CLASS="OPTION">-f</TT> <TT CLASS="LITERAL">{ s | i | o | b | t | n | m | h }</TT></DT><DD><P>禁止某种扫描和连接方法的使用：<TT CLASS="LITERAL">s</TT>和<TT CLASS="LITERAL">i</TT>
分别关闭顺序和索引扫描，<TT CLASS="LITERAL">o</TT>, <TT CLASS="LITERAL">b</TT> 和
<TT CLASS="LITERAL">t</TT>分别关闭只有索引扫描、位图索引扫描和TID扫描，
而<TT CLASS="LITERAL">n</TT>, <TT CLASS="LITERAL">m</TT>, 和 <TT CLASS="LITERAL">h</TT>
分别关闭嵌套循环，融合(merge)和 Hash 连接。</P><P>顺序扫描和嵌套循环都不可能完全被关闭。<TT CLASS="LITERAL">-fs</TT>和<TT CLASS="LITERAL">-fn</TT>
选项仅仅是在存在其它方法时阻碍优化器使用这些方法罢了。</P></DD><DT><TT CLASS="OPTION">-n</TT></DT><DD><P>该选项主要用于调试导致服务器进程异常崩溃的问题。
对付这种情况的一般策略是通知所有其它服务器进程终止并重新初始化共享内存和信号灯。
这是因为一个出错的服务器进程可能在终止之前就已经对共享的东西造成了破坏。
该选项指定<TT CLASS="COMMAND">postgres</TT>不重新初始化共享数据结构。
一个有经验的系统程序员这时就可以使用调试器检查共享内存和信号灯状态。</P></DD><DT><TT CLASS="OPTION">-O</TT></DT><DD><P>允许修改系统表的结构。这个参数用于<TT CLASS="COMMAND">initdb</TT>。</P></DD><DT><TT CLASS="OPTION">-P</TT></DT><DD><P>读取系统表时忽略系统索引，但在更改数据时仍然更新索引。
这对于从索引已经损坏的系统表中恢复是很有帮助的。</P></DD><DT><TT CLASS="OPTION">-t</TT> <TT CLASS="LITERAL">pa[rser] | pl[anner] | e[xecutor]</TT></DT><DD><P>打印与每个主要系统模块相关的查询记时统计。它不能和<TT CLASS="OPTION">-s</TT>选项一起使用。</P></DD><DT><TT CLASS="OPTION">-T</TT></DT><DD><P>该选项主要用于调试导致服务器进程异常崩溃的问题。
对付这种情况的一般策略是通知所有其它服务器进程终止并重新初始化共享内存和信号灯。
这是因为一个出错的服务器进程可能在终止之前就已经对共享的东西造成了破坏。
该选项指定<TT CLASS="COMMAND">postgres</TT>通过发送<TT CLASS="LITERAL">SIGSTOP</TT>
信号停止其他所有服务器进程，但是并不让它们退出。
这样就允许系统程序员手动从所有服务器进程搜集内核转储。</P></DD><DT><TT CLASS="OPTION">-v</TT> <TT CLASS="REPLACEABLE"><I>protocol</I></TT></DT><DD><P>声明这次会话使用的前/后服务器协议的版本数。该选项仅在内部使用。</P></DD><DT><TT CLASS="OPTION">-W</TT> <TT CLASS="REPLACEABLE"><I>seconds</I></TT></DT><DD><P>一旦看见这个选项，进程就睡眠标出的秒数。这样就给开发者一些时间把调试器附着在该服务器进程上。</P></DD></DL></DIV></DIV><DIV CLASS="REFSECT2"><A NAME="AEN90246"></A><H3>单用户模式的选项</H3><P>下面的选项仅在单用户模式下可用。</P><P></P><DIV CLASS="VARIABLELIST"><DL><DT><TT CLASS="OPTION">--single</TT></DT><DD><P>选中单用户模式。这个必须是命令行中的第一个选项。</P></DD><DT><TT CLASS="REPLACEABLE"><I>database</I></TT></DT><DD><P>要访问的数据库名字。这个必须是命令行中的最后一个选项。如果忽略掉则缺省为用户名。</P></DD><DT><TT CLASS="OPTION">-E</TT></DT><DD><P>回显所有命令。</P></DD><DT><TT CLASS="OPTION">-j</TT></DT><DD><P>禁止使用新行作为语句分隔符。</P></DD><DT><TT CLASS="OPTION">-r</TT> <TT CLASS="REPLACEABLE"><I>filename</I></TT></DT><DD><P>将所有服务器输出日志保存到<TT CLASS="REPLACEABLE"><I>filename</I></TT>中。
在多用户模式下该选项将被忽略，所有进程都将使用<SPAN CLASS="SYSTEMITEM">stderr</SPAN>。</P></DD></DL></DIV></DIV></DIV><DIV CLASS="REFSECT1"><A NAME="AEN90278"></A><H2>环境变量</H2><P></P><DIV CLASS="VARIABLELIST"><DL><DT><TT CLASS="ENVAR">PGCLIENTENCODING</TT></DT><DD><P>客户端使用的缺省字符编码。客户端可以独立地覆盖它。这个值也可以在配置文件里设置。</P></DD><DT><TT CLASS="ENVAR">PGDATA</TT></DT><DD><P>缺省数据目录位置。</P></DD><DT><TT CLASS="ENVAR">PGDATESTYLE</TT></DT><DD><P>运行时参数<A HREF="runtime-config-client.html#GUC-DATESTYLE">DateStyle</A>的缺省值。现在反对使用该环境变量。</P></DD><DT><TT CLASS="ENVAR">PGPORT</TT></DT><DD><P>缺省端口号(最好在配置文件中设置)。</P></DD><DT><TT CLASS="ENVAR">TZ</TT></DT><DD><P>服务器的时区。</P></DD></DL></DIV></DIV><DIV CLASS="REFSECT1"><A NAME="AEN90307"></A><H2>诊断</H2><P>一个提到了<TT CLASS="LITERAL">semget</TT>或<TT CLASS="LITERAL">shmget</TT>的错误信息可能意味着你需要重新配置你的内核，
提供足够的共享内存和信号灯。更多讨论，参阅<A HREF="kernel-resources.html">第 17.4 &#33410;</A>。
你也可以通过降低<A HREF="runtime-config-resource.html#GUC-SHARED-BUFFERS">shared_buffers</A>值以减少<SPAN CLASS="PRODUCTNAME">PostgreSQL</SPAN>
的共享内存的消耗，或者降低<A HREF="runtime-config-connection.html#GUC-MAX-CONNECTIONS">max_connections</A>值减少
<SPAN CLASS="PRODUCTNAME">PostgreSQL</SPAN>的信号灯的消耗。</P><P>如果碰到一个说另外一个服务器正在运行的错误信息，可以根据不同的系统使用命令
</P><PRE CLASS="SCREEN"><SAMP
CLASS="PROMPT"
>$</SAMP
> <KBD
CLASS="USERINPUT"
>ps ax | grep postgres</KBD
></PRE><P>
或
</P><PRE CLASS="SCREEN"><SAMP
CLASS="PROMPT"
>$</SAMP
> <KBD
CLASS="USERINPUT"
>ps -ef | grep postgres</KBD
></PRE><P>
如果确信没有冲突的服务器正在运行，那么你可以删除消息里提到的锁文件然后再次运行。</P><P>抱怨无法绑定端口的错误信息可能表明该端口已经被其它非<SPAN CLASS="PRODUCTNAME">PostgreSQL</SPAN>
进程使用。如果终止<TT CLASS="COMMAND">postgres</TT>后又马上用同一个端口运行它，
也可能得到这个错误信息；这时，你必须多等几秒，等操作系统关闭了该端口后再试。
最后，如果你使用了一个操作系统认为是保留的端口，也可能导致这个错误信息。例如，
许多 Unix 版本认为低于 1024 的端口号是<SPAN CLASS="QUOTE">"可信任的"</SPAN>，
因而只有 Unix 超级用户可以使用它们。</P></DIV><DIV CLASS="REFSECT1"><A NAME="AEN90328"></A><H2>注意</H2><P><A HREF="app-pg-ctl.html"><SPAN CLASS="APPLICATION">pg_ctl</SPAN></A>工具可以用于安全而有效地启停<TT CLASS="COMMAND">postgres</TT>服务器。</P><P>如果有可能，<SPAN CLASS="emphasis"><I CLASS="EMPHASIS">不要</I></SPAN>使用<TT CLASS="LITERAL">SIGKILL</TT>
杀死主<TT CLASS="COMMAND">postgres</TT>服务器进程。这样会阻止<TT CLASS="COMMAND">postgres</TT>
在退出前释放它持有的系统资源(例如共享内存和信号灯)。这样可能会影响到将来启动新的
<TT CLASS="COMMAND">postgres</TT>进程。</P><P>可以使用<TT CLASS="LITERAL">SIGTERM</TT>, <TT CLASS="LITERAL">SIGINT</TT>, <TT CLASS="LITERAL">SIGQUIT</TT>
信号正常结束<TT CLASS="COMMAND">postgres</TT>服务器进程。
第一个信号将等待所有的客户端退出后才退出。第二个将强制断开所有客户端，
而第三个将不停止立刻退出，导致在重启时的恢复运行。</P><P><TT CLASS="LITERAL">SIGHUP</TT>会重新加载服务器配置文件。
也可以向一个单独的服务器进程发送<TT CLASS="LITERAL">SIGHUP</TT>信号，但是这样做没什么意义。</P><P>要取消一个正在运行的查询，可以向正在执行该查询的进程发送<TT CLASS="LITERAL">SIGINT</TT>信号。
要终止一个后端进程，可以向那个进程发送<TT CLASS="LITERAL">SIGTERM</TT>信号。也可以参阅
<A HREF="functions-admin.html#FUNCTIONS-ADMIN-SIGNAL">第 9.26.2 &#33410;</A>里面的<CODE CLASS="FUNCTION">pg_cancel_backend</CODE> 和
<CODE CLASS="FUNCTION">pg_terminate_backend</CODE>获取这两个动作的相等SQL调用。</P><P><TT CLASS="COMMAND">postgres</TT>服务器发送<TT CLASS="LITERAL">SIGQUIT</TT>
信号告诉子服务器进程立即退出且不做清理工作，用户应当尽量<SPAN CLASS="emphasis"><I CLASS="EMPHASIS">避免</I></SPAN>
使用该信号。同时，发送<TT CLASS="LITERAL">SIGKILL</TT>信号也是不明智的：
主<TT CLASS="COMMAND">postgres</TT>进程将把这个信号当作崩溃信号，
然后会强制其他兄弟进程作为标准的崩溃回复过程退出。</P></DIV><DIV CLASS="REFSECT1"><A NAME="APP-POSTGRES-BUGS"></A><H2>Bug</H2><P><TT CLASS="OPTION">--</TT>选项在<SPAN CLASS="SYSTEMITEM">FreeBSD</SPAN>或
<SPAN CLASS="SYSTEMITEM">OpenBSD</SPAN>上无法运行，应该使用<TT CLASS="OPTION">-c</TT>。
这在受影响的系统里是个Bug；如果这个毛病没有修补好，
将来的<SPAN CLASS="PRODUCTNAME">PostgreSQL</SPAN>版本将提供一个绕开的办法。</P></DIV><DIV CLASS="REFSECT1"><A NAME="AEN90367"></A><H2>用法</H2><P>启动一个单用户模式的服务器：
</P><PRE CLASS="SCREEN"><KBD
CLASS="USERINPUT"
>postgres --single -D /usr/local/pgsql/data <TT
CLASS="REPLACEABLE"
><I
>other-options</I
></TT
> my_database</KBD
></PRE><P>
用<TT CLASS="OPTION">-D</TT>给服务器提供正确的数据库目录的路径，
或者确保环境变量<TT CLASS="ENVAR">PGDATA</TT>已经正确设置。同时还要声名你想用的特定数据库名字。</P><P>通常，单用户模式的服务器把换行符当做命令输入完成字符；它还不懂分号的作用，
因为那些东西是在<SPAN CLASS="APPLICATION">psql</SPAN>里的。要想把一行分成多行写，
你必需在除最后一个换行符以外的每个换行符前面敲一个反斜杠。</P><P>但是如果使用了<TT CLASS="OPTION">-j</TT>命令行选项，新行将不被当作命令结束符。
此时服务器将从标准输入一直读取到<ACRONYM CLASS="ACRONYM">EOF</ACRONYM>标志为止，
然后把所有读到的内容当作一个完整的命令字符串看待，
并且反斜杠与换行符也被当作普通字符来看待。</P><P>输入<ACRONYM CLASS="ACRONYM">EOF</ACRONYM>(<B CLASS="KEYCAP">Control</B>+<B CLASS="KEYCAP">D</B>)
即可退出会话。如果你已经使用了<TT CLASS="OPTION">-j</TT>则必须连续使用两个<ACRONYM CLASS="ACRONYM">EOF</ACRONYM>才行。</P><P>请注意单用户模式运行的服务器不会提供复杂的行编辑功能(比如，没有命令行历史)。
单用户模式也不做任何后台处理，像自动检查点。</P></DIV><DIV CLASS="REFSECT1"><A NAME="APP-POSTGRES-EXAMPLES"></A><H2>例子</H2><P>用缺省值在后台启动<TT CLASS="COMMAND">postgres</TT>：
</P><PRE CLASS="SCREEN"><SAMP
CLASS="PROMPT"
>$</SAMP
> <KBD
CLASS="USERINPUT"
>nohup postgres &gt;logfile 2&gt;&amp;1 &lt;/dev/null &amp;</KBD
></PRE><P></P><P>在指定的端口启动<TT CLASS="COMMAND">postgres</TT>，如1234：
</P><PRE CLASS="SCREEN"><SAMP
CLASS="PROMPT"
>$</SAMP
> <KBD
CLASS="USERINPUT"
>postgres -p 1234</KBD
></PRE><P>
要连接到这个服务器使用<SPAN CLASS="APPLICATION">psql</SPAN>，用 -P 选项指定这个端口：
</P><PRE CLASS="SCREEN"><SAMP
CLASS="PROMPT"
>$</SAMP
> <KBD
CLASS="USERINPUT"
>psql -p 1234</KBD
></PRE><P>
或者设置环境变量<TT CLASS="ENVAR">PGPORT</TT>：
</P><PRE CLASS="SCREEN"><SAMP
CLASS="PROMPT"
>$</SAMP
> <KBD
CLASS="USERINPUT"
>export PGPORT=1234</KBD
>
<SAMP
CLASS="PROMPT"
>$</SAMP
> <KBD
CLASS="USERINPUT"
>psql</KBD
></PRE><P></P><P>命名的运行时参数可以用下列的风格之一设置：
</P><PRE CLASS="SCREEN"><SAMP
CLASS="PROMPT"
>$</SAMP
> <KBD
CLASS="USERINPUT"
>postgres -c work_mem=1234</KBD
>
<SAMP
CLASS="PROMPT"
>$</SAMP
> <KBD
CLASS="USERINPUT"
>postgres --work-mem=1234</KBD
></PRE><P>
两种形式都覆盖那些现有的在<TT CLASS="FILENAME">postgresql.conf</TT>里面的<TT CLASS="VARNAME">work_mem</TT>设置。
请注意在参数名里的下划线在命令行上可以写成下划线，也可以写成连字符。
除了用于短期的实验以外，更好的习惯是编辑<TT CLASS="FILENAME">postgresql.conf</TT>里面的设置，
而不是倚赖命令行开关设置参数。</P></DIV><DIV CLASS="REFSECT1"><A NAME="AEN90419"></A><H2>又见</H2><P> <A HREF="app-initdb.html">initdb</A>,
<A HREF="app-pg-ctl.html"><SPAN CLASS="APPLICATION">pg_ctl</SPAN></A>
</P></DIV><DIV CLASS="NAVFOOTER"><HR ALIGN="LEFT" WIDTH="100%"><TABLE SUMMARY="Footer navigation table" WIDTH="100%" BORDER="0" CELLPADDING="0" CELLSPACING="0"><TR><TD WIDTH="33%" ALIGN="left" VALIGN="top"><A HREF="app-pgresetxlog.html" ACCESSKEY="P">&#19978;&#19968;&#39029;</A></TD><TD WIDTH="34%" ALIGN="center" VALIGN="top"><A HREF="http://school.yunwei.edu/manual/PostgreSQL/index.html" ACCESSKEY="H">&#36215;&#22987;&#39029;</A></TD><TD WIDTH="33%" ALIGN="right" VALIGN="top"><A HREF="app-postmaster.html" ACCESSKEY="N">&#19979;&#19968;&#39029;</A></TD></TR><TR><TD WIDTH="33%" ALIGN="left" VALIGN="top"><SPAN CLASS="APPLICATION">pg_resetxlog</SPAN></TD><TD WIDTH="34%" ALIGN="center" VALIGN="top"><A HREF="http://school.yunwei.edu/manual/PostgreSQL/reference-server.html" ACCESSKEY="U">&#19978;&#19968;&#32423;</A></TD><TD WIDTH="33%" ALIGN="right" VALIGN="top"><SPAN CLASS="APPLICATION">postmaster</SPAN></TD></TR></TABLE></DIV></BODY></HTML>
