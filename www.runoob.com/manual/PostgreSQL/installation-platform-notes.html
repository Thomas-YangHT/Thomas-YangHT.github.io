<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<HTML><HEAD><TITLE>特定平台注意事项</TITLE><META NAME="GENERATOR" CONTENT="Modular DocBook HTML Stylesheet Version 1.79"><LINK REV="MADE" HREF="mailto:pgsql-docs@postgresql.org"><LINK REL="HOME" TITLE="PostgreSQL 9.3.1 中文手册" HREF="http://school.yunwei.edu/manual/PostgreSQL/index.html"><LINK REL="UP" TITLE="  源码安装" HREF="http://school.yunwei.edu/manual/PostgreSQL/installation.html"><LINK REL="PREVIOUS" TITLE="支持的平台" HREF="supported-platforms.html"><LINK REL="NEXT" TITLE="Windows下用源代码安装" HREF="http://school.yunwei.edu/manual/PostgreSQL/install-windows.html"><LINK REL="STYLESHEET" TYPE="text/css" HREF="http://school.yunwei.edu/manual/PostgreSQL/stylesheet.css"><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8"><META NAME="creation" CONTENT="2015-07-11T14:00:17"></HEAD><BODY CLASS="SECT1">
<div style="text-align:right">
<a style="margin : 0px 0px 0px 10px;" href="https://github.com/postgres-cn/pgdoc-cn/issues/new" target="_blank" title="在Github上报告问题（请注明问题内容及所在章节）">问题报告</a>
<a style="margin : 0px 0px 0px 10px;" href="https://github.com/postgres-cn/pgdoc-cn/edit/master/postgresql/doc/src/sgml/installation.sgml" target="_blank" title="直接在Github上纠错本页面">纠错本页面</a>
</div>
<DIV CLASS="NAVHEADER"><TABLE SUMMARY="Header navigation table" WIDTH="100%" BORDER="0" CELLPADDING="0" CELLSPACING="0"><TR><TH COLSPAN="5" ALIGN="center" VALIGN="bottom"><A HREF="http://school.yunwei.edu/manual/PostgreSQL/index.html">PostgreSQL 9.3.1 中文手册</A></TH></TR><TR><TD WIDTH="10%" ALIGN="left" VALIGN="top"><A TITLE="支持的平台" HREF="supported-platforms.html" ACCESSKEY="P">&#19978;&#19968;&#39029;</A></TD><TD WIDTH="10%" ALIGN="left" VALIGN="top"><A HREF="http://school.yunwei.edu/manual/PostgreSQL/installation.html" ACCESSKEY="U">&#19978;&#19968;&#32423;</A></TD><TD WIDTH="60%" ALIGN="center" VALIGN="bottom">&#31456; 15. 源码安装</TD><TD WIDTH="20%" ALIGN="right" VALIGN="top"><A TITLE="Windows下用源代码安装" HREF="http://school.yunwei.edu/manual/PostgreSQL/install-windows.html" ACCESSKEY="N">&#19979;&#19968;&#39029;</A></TD></TR></TABLE><HR ALIGN="LEFT" WIDTH="100%"></DIV><DIV CLASS="SECT1"><H1 CLASS="SECT1"><A NAME="INSTALLATION-PLATFORM-NOTES">15.7. 特定平台注意事项</A></H1><P> 这部分提供额外的关于PostgreSQL的安装和设置的特定平台的问题。
一定要阅读安装说明，尤其是<A HREF="install-requirements.html">第 15.2 &#33410;</A>。
另外，检查
<A HREF="http://school.yunwei.edu/manual/PostgreSQL/regress.html">第 30 &#31456;</A>有关回归测试结果的说明。</P><P> 此处未覆盖的平台没有已知的特定平台安装问题。</P><DIV CLASS="SECT2"><H2 CLASS="SECT2"><A NAME="INSTALLATION-NOTES-AIX">15.7.1. AIX</A></H2><P> PostgreSQL工作在AIX上，但正确安装它具有挑战性。
支持AIX 4.3.3到6.1版本。
您可以使用GCC或本机的IBM编译器<TT CLASS="COMMAND">xlc</TT>。
一般情况下，采用近期版本的AIX和PostgreSQL会有所帮助。
检查bulid farm获得最新的支持的AIX版本信息。</P><P> 为支持的AIX版本推荐的最低修复级别是：</P><P></P><DIV CLASS="VARIABLELIST"><DL><DT>AIX 4.3.3</DT><DD><P>Maintenance Level 11 + post ML11 bundle</P></DD><DT>AIX 5.1</DT><DD><P>Maintenance Level 9 + post ML9 bundle</P></DD><DT>AIX 5.2</DT><DD><P>Technology Level 10 Service Pack 3</P></DD><DT>AIX 5.3</DT><DD><P>Technology Level 7</P></DD><DT>AIX 6.1</DT><DD><P>Base Level</P></DD></DL></DIV><P> 查看当前修复级别，使用AIX 4.3.3到AIX 5.2 ML7中的
<TT CLASS="COMMAND">oslevel -r</TT>，或者更高版本的
<TT CLASS="COMMAND">oslevel -s</TT>。</P><P> 如果你在<TT CLASS="LITERAL">/usr/local</TT>中已经安装了Readline或者libz，
在你自己的选项外，请使用以下的<TT CLASS="COMMAND">configure</TT>选项：
<TT CLASS="LITERAL">--with-includes=/usr/local/include
--with-libraries=/usr/local/lib</TT></P><DIV CLASS="SECT3"><H3 CLASS="SECT3"><A NAME="AEN25698">15.7.1.1. GCC问题</A></H3><P> 在AIX 5.3上，使用GCC时PostgreSQL的编译以及运行存在一些问题。</P><P> 您想要使用之后的GCC 3.3.2的版本，特别是如果你使用一个预先打包的版本。
我们在使用4.0.1时很成功。比起GCC的实际问题来说，早期版本问题似乎与IBM包装GCC有更大关系，
因此，如果你自己编译GCC，使用GCC早期版本你也可能成功。</P></DIV><DIV CLASS="SECT3"><H3 CLASS="SECT3"><A NAME="AEN25702">15.7.1.2. Unix-域套接字中断</A></H3><P> AIX 5.3有一个问题，其中<TT CLASS="STRUCTNAME">sockaddr_storage</TT>没有被定义为足够大。
在5.3版本中，IBM增加了<TT CLASS="STRUCTNAME">sockaddr_un</TT>（Unix域套接字的地址结构）的大小，
但并没有相应地增加<TT CLASS="STRUCTNAME">sockaddr_storage</TT>的大小。
这样的结果是试图使用Unix域套接字与PostgreSQL时，导致libpq溢出的数据结构。
TCP/IP连接工作正常，但不是Unix域套接字，以防止回归测试工作。</P><P> 这个问题已经报道给IBM，并且作为bug报告PMR29657进行记录。
如果您升级到维护级别5300-03或更高版本，将包括此修复。
一个快速解决方法是改变<TT CLASS="FILENAME">/usr/include/sys/socket.h</TT>中的
<TT CLASS="SYMBOL">_SS_MAXSIZE</TT>到1025。在这两种情况下，
一旦你修改了头文件，则要重新编译PostgreSQL。</P></DIV><DIV CLASS="SECT3"><H3 CLASS="SECT3"><A NAME="AEN25711">15.7.1.3. 网络地址问题</A></H3><P> PostgreSQL依赖于系统的<CODE CLASS="FUNCTION">getaddrinfo</CODE>函数解析<TT CLASS="VARNAME">listen_addresses</TT>，<TT CLASS="FILENAME">pg_hba.conf</TT>等中的IP地址，
较旧版本的AIX已经划分出这个函数中的bug。
如果您有关于这些设置的问题，
更新到上面显示的相应的AIX修复级别应特别注意。</P><P> 一个用户报告：</P><P> 当在AIX 5.3上使用PostgreSQL版本8.1的时候，
我们周期性地遇到了问题，
其中统计收集器可能<SPAN CLASS="QUOTE">"莫名其妙"</SPAN>的失败。
这似乎是IPv6实行中意外行为的结果。
它看起来像PostgreSQL和IPv6在AIX 5.3中不能很好地兼容。</P><P>
下面的任意一个操作可以<SPAN CLASS="QUOTE">"修复"</SPAN>这个问题。
<P></P></P><UL><LI><P>
删除本地主机的IPv6地址：
</P><PRE CLASS="SCREEN">(as root)
# ifconfig lo0 inet6 ::1/0 delete</PRE><P>
</P></LI><LI><P>
从网络服务中删除IPv6。在AIX上的文件<TT CLASS="FILENAME">/etc/netsvc.conf</TT>大致
等同于Solaris/Linux上的<TT CLASS="FILENAME">/etc/nsswitch.conf</TT>。
默认情况下，AIX上是这样的:
</P><PRE CLASS="PROGRAMLISTING">hosts=local,bind</PRE><P>
替换为：
</P><PRE CLASS="PROGRAMLISTING">hosts=local4,bind4</PRE><P>
解除搜索IPv6地址。
</P></LI></UL><P>
</P><DIV CLASS="WARNING"><P></P><TABLE CLASS="WARNING" BORDER="1" WIDTH="100%"><TR><TD ALIGN="CENTER"><B>&#35686;&#21578;</B></TD></TR><TR><TD ALIGN="LEFT"><P> 这的确是IPv6支持的不成熟问题的解决方法，
这在AIX 5.3版本中有明显改善。
该方法在AIX 5.3版本中被实施，但并不是一个优雅的解决问题的办法。
报道称这种解决方法不仅是不必要的，而且会在AIX 6.1上导致问题，
其中IPv6的支持日渐成熟。</P></TD></TR></TABLE></DIV></DIV><DIV CLASS="SECT3"><H3 CLASS="SECT3"><A NAME="AEN25734">15.7.1.4. 内存管理</A></H3><P>
AIX关于内存管理方式上有些特别。
你可以有很多倍MB的RAM空闲的服务器，
但是当运行应用程序时，仍然有内存或地址空间不足的错误。
一个例子是<TT CLASS="COMMAND">createlang</TT>发生不寻常错误的例子。
比如，作为PostgreSQL安装的所有者运行：
</P><PRE CLASS="SCREEN">-bash-3.00$ createlang plperl template1
createlang: language installation failed: ERROR:  could not load library "/opt/dbs/pgsql748/lib/plperl.so": A memory address is not in the address space for the process.</PRE><P>
作为PostgreSQL安装的非拥有者进行运行：
</P><PRE CLASS="SCREEN">-bash-3.00$ createlang plperl template1
createlang: language installation failed: ERROR:  could not load library "/opt/dbs/pgsql748/lib/plperl.so": Bad address</PRE><P>
另一个例子是在PostgreSQL服务器日志中内存不足的错误，
每个内存分配接近或者大于256 MB时失败。
</P><P> 所有这些问题的总体原因是默认bittedness以及使用的服务器进程的内存模型。
默认情况下，所有的在AIX上编译的二进制文件是32位。
这不依赖于使用的硬件类型或内核。
这些32位进程被限制了4GB的内存消耗在段大小为256MB时使用一些模型中的一个。
默认允许少于256 MB在堆与栈共享一个段。</P><P> 在上面的<TT CLASS="COMMAND">createlang</TT>的例子中，
检查你的PostgreSQL安装中的umask和二进制文件的权限。
该示例中的二进制文件是32位的并且以权限750而不是755的模式安装。
因为权限被设置成这种模式，
只有进程组中的所有者或成员才可以加载库。
因为它不是所有人可读的，
加载器将对象放入进程堆中而不是它应该放置的共享库段中。</P><P> 此问题的<SPAN CLASS="QUOTE">"理想"</SPAN>解决方案是使用64位的PostgreSQL编译，
但事实并非总是可行的，因为32位处理器系统可以编译，
但不能运行64位的二进制文件。</P><P> 如果需要32位二进制文件，在启动PostgreSQL服务器之前
设置<TT CLASS="SYMBOL">LDR_CNTRL</TT>为<TT CLASS="LITERAL">MAXDATA=0x<TT CLASS="REPLACEABLE"><I>n</I></TT>0000000</TT>，
其中1 &lt;= n &lt;= 8，并尝试不同的值。同时设置<TT CLASS="FILENAME">postgresql.conf</TT>以找到合理运行的配置。
<TT CLASS="SYMBOL">LDR_CNTRL</TT>的使用告诉AIX你想要服务器给堆分配<TT CLASS="SYMBOL">MAXDATA</TT>字节，分配256 MB的段。
当你找到一个可行的配置，<TT CLASS="COMMAND">ldedit</TT>可以用来修改二进制文件，
这样他们会默认使用所需的堆大小。 PostgreSQL可以也被重新编译，
通过配置<TT CLASS="LITERAL">configure LDFLAGS="-Wl,-bmaxdata:0x<TT CLASS="REPLACEABLE"><I>n</I></TT>0000000"</TT>达到同样的效果。</P><P> 对于64位的编译，设置<TT CLASS="ENVAR">OBJECT_MODE</TT>为64
并且传递<TT CLASS="LITERAL">CC="gcc -maix64"</TT>和<TT CLASS="LITERAL">LDFLAGS="-Wl,-bbigtoc"</TT>到<TT CLASS="COMMAND">configure</TT>。
（<TT CLASS="COMMAND">xlc</TT>选项可能有所不同。）
如果你省略<TT CLASS="ENVAR">OBJECT_MODE</TT>的设置，
可能产生链接错误。当<TT CLASS="ENVAR">OBJECT_MODE</TT>被设置的时候，
它告诉AIX编译工具如<TT CLASS="COMMAND">ar</TT>, <TT CLASS="COMMAND">as</TT>和<TT CLASS="COMMAND">ld</TT>
默认处理对象的类型。</P><P> 默认情况下，可能发生分页空间过量使用。
虽然我们还没有看到这种情况发生，当进程用完内存并且产生过量访问时，AIX将杀死该进程。
最接近这一点的是我们所看到的交叉失败，因为系统认为没有足够的内存用于另一个进程。
像许多其他的AIX部分，如果产生这样的问题，那么
分页空间分配方法及内存不足杀进程在系统或进程范围基础上是可配置的。</P><H3><A NAME="AEN25767">参考文献和资源</A></H3><DIV CLASS="BIBLIOENTRY"><A NAME="AEN25769"></A><P>"<A HREF="http://publib.boulder.ibm.com/infocenter/pseries/topic/com.ibm.aix.doc/aixprggd/genprogc/lrg_prg_support.htm" TARGET="_top">Large Program Support</A>", <I>AIX Documentation: General Programming Concepts: Writing and Debugging Programs</I>.</P><DIV CLASS="BIBLIOENTRYBLOCK" STYLE="margin-left: 0.5in"></DIV></DIV><DIV CLASS="BIBLIOENTRY"><A NAME="AEN25775"></A><P>"<A HREF="http://publib.boulder.ibm.com/infocenter/pseries/topic/com.ibm.aix.doc/aixprggd/genprogc/address_space.htm" TARGET="_top">Program Address Space Overview</A>", <I>AIX Documentation: General Programming Concepts: Writing and Debugging Programs</I>.</P><DIV CLASS="BIBLIOENTRYBLOCK" STYLE="margin-left: 0.5in"></DIV></DIV><DIV CLASS="BIBLIOENTRY"><A NAME="AEN25781"></A><P>"<A HREF="http://publib.boulder.ibm.com/infocenter/pseries/v5r3/topic/com.ibm.aix.doc/aixbman/prftungd/resmgmt2.htm" TARGET="_top">Performance Overview of the Virtual Memory Manager (VMM)</A>", <I>AIX Documentation: Performance Management Guide</I>.</P><DIV CLASS="BIBLIOENTRYBLOCK" STYLE="margin-left: 0.5in"></DIV></DIV><DIV CLASS="BIBLIOENTRY"><A NAME="AEN25787"></A><P>"<A HREF="http://publib.boulder.ibm.com/infocenter/pseries/v5r3/topic/com.ibm.aix.doc/aixbman/prftungd/memperf7.htm" TARGET="_top">Page Space Allocation</A>", <I>AIX Documentation: Performance Management Guide</I>.</P><DIV CLASS="BIBLIOENTRYBLOCK" STYLE="margin-left: 0.5in"></DIV></DIV><DIV CLASS="BIBLIOENTRY"><A NAME="AEN25793"></A><P>"<A HREF="http://publib.boulder.ibm.com/infocenter/pseries/v5r3/topic/com.ibm.aix.doc/aixbman/prftungd/memperf6.htm" TARGET="_top">Paging-space thresholds tuning</A>", <I>AIX Documentation: Performance Management Guide</I>.</P><DIV CLASS="BIBLIOENTRYBLOCK" STYLE="margin-left: 0.5in"></DIV></DIV><DIV CLASS="BIBLIOENTRY"><A NAME="AEN25799"></A><P><I><A HREF="http://www.redbooks.ibm.com/abstracts/sg245674.html?Open" TARGET="_top">Developing and Porting C and C++ Applications on AIX</A></I>, IBM Redbook.</P><DIV CLASS="BIBLIOENTRYBLOCK" STYLE="margin-left: 0.5in"></DIV></DIV></DIV></DIV><DIV CLASS="SECT2"><H2 CLASS="SECT2"><A NAME="INSTALLATION-NOTES-CYGWIN">15.7.2. Cygwin</A></H2><P> PostgreSQL可以使用Cygwin（Windows的类Linux环境）进行编译，
但该方法不如本地Windows编译(参阅<A HREF="http://school.yunwei.edu/manual/PostgreSQL/install-windows.html">第 16 &#31456;</A>)，
并且不再推荐在Cygwin下运行服务器。</P><P>
当从源码进行编译时，按照正常的安装程序进行（也就是<TT CLASS="LITERAL">./configure;make</TT>），
注意下面的Cygwin的特殊差异：
<P></P></P><UL><LI><P>
设定你的环境变量path，将Cygwin的bin目录设置在Windows应用之前。这有助于避免编译问题。
</P></LI><LI><P> GNU make命令称为<TT CLASS="COMMAND">make</TT>而不是<TT CLASS="COMMAND">gmake</TT>。</P></LI><LI><P> 不支持<TT CLASS="COMMAND">adduser</TT>命令；在Windows NT,2000或者XP上使用适当的用户管理应用。否则，忽略这一步。</P></LI><LI><P> 不支持<TT CLASS="COMMAND">su</TT>命令；在Windows NT,2000或者XP上使用ssh模拟su。否则，忽略这一步。</P></LI><LI><P> 不支持OpenSSL。</P></LI><LI><P> 为了支持共享内存开启<TT CLASS="COMMAND">cygserver</TT>。
要做到这一点，输入命令<TT CLASS="LITERAL">/usr/sbin/cygserver&amp;</TT>。
确保这个程序运行在任何当你启动PostgreSQL服务器或初始化一个数据库集群（<TT CLASS="COMMAND">initdb</TT>）的时候。
可能需要改变默认的<TT CLASS="COMMAND">cygserver</TT>配置（例如，增加<TT CLASS="SYMBOL">SEMMNS</TT>）以避免
由于缺乏系统资源而导致的PostgreSQL失败。</P></LI><LI><P> 在某些locale不是C的系统上编译可能会失败。
为了解决这个问题，在编译之前通过执行<TT CLASS="COMMAND">export LANG=C.utf8</TT>设置locale到C，
然后，在你安装完PostgreSQL之后，再将它设置回之前的内容。</P></LI><LI><P>
由于<CODE CLASS="FUNCTION">listen()</CODE>积压队列溢出，
平行回归测试（<TT CLASS="LITERAL">make check</TT>）会产生伪回归测试失败，
导致连接拒绝错误或挂起。
你可以使用make变量<TT CLASS="VARNAME">MAX_CONNECTIONS</TT>限制连接数，因此：
</P><PRE CLASS="PROGRAMLISTING">make MAX_CONNECTIONS=5 check</PRE><P>
在某些系统上你最多可以有10个并发连接。
</P></LI></UL><P>
</P><P> 可以将<TT CLASS="COMMAND">cygserver</TT>和PostgreSQL服务安装成Windows NT的服务。
关于如何做的信息，请参阅包含在Cygwin上的PostgreSQL二进制包中的<TT CLASS="FILENAME">README</TT>文档。
它被安装在目录<TT CLASS="FILENAME">/usr/share/doc/Cygwin</TT>中。</P></DIV><DIV CLASS="SECT2"><H2 CLASS="SECT2"><A NAME="INSTALLATION-NOTES-HPUX">15.7.3. HP-UX</A></H2><P> PostgreSQL 7.3+应该在运行HP-UX 10.X或者11.X的系列700/800 PA-RISC机器上工作，
给予相应的系统补丁级别和编译工具。
至少有一个开发者经常在HP-UX 10.20上测试。
并且，我们在HP-UX 11.00和11.11上有成功安装的报道。</P><P>
除了PostgreSQL源代码发布外，您将需要GNU make（HP make不能执行），
以及GCC或HP的完整ANSI C 编译器。
如果你打算从Git 源代码而不是发布包编译，你还需要Flex（GNU lex）和Bison
(GNU yacc)。我们建议你确保已经打了最新的HP补丁。至少，如果你正在HP-UX 11.11上编译64位二进制文件，您可能需要PHSS_30966 (11.11)或
者后继补丁，否则<TT CLASS="COMMAND">initdb</TT>可能会挂起：
<P CLASS="LITERALLAYOUT">PHSS_30966&nbsp;&nbsp;s700_800&nbsp;ld(1)&nbsp;and&nbsp;linker&nbsp;tools&nbsp;cumulative&nbsp;patch</P>
一般原则，你应该经常为libc和ld/dld打补丁，正如当你使用HP C编译器时，
为其编译器打补丁一样。
请参阅HP支持网站，比如<A HREF="http://itrc.hp.com" TARGET="_top">http://itrc.hp.com</A>和
<A HREF="ftp://us-ffs.external.hp.com/" TARGET="_top">ftp://us-ffs.external.hp.com/</A>，免费的最新补丁副本。
</P><P> 如果你正在PA-RISC 2.0的机器上编译，并希望
使用GCC获得64位的二进制文件，你必须使用GCC的64位版本。支持HP-UX PA-RISC和Itanium的GCC二进制可以从
<A HREF="http://www.hp.com/go/gcc" TARGET="_top">http://www.hp.com/go/gcc</A>获得。不要忘了在同一时间获取并安装binutils。</P><P> 如果你在PA-RISC 2.0机器上编译，并且想让编译出的二进制文件在PA-RISC 1.1机器上运行，
你需要在<TT CLASS="ENVAR">CFLAGS</TT>中指定<TT CLASS="OPTION">+DAportable</TT>。 </P><P>
如果你在HP-UX Itanium机器上进行编译，你将需要带有依赖包或者继承补丁的最新HP ANSI C编译器。
<P CLASS="LITERALLAYOUT">PHSS_30848&nbsp;&nbsp;s700_800&nbsp;HP&nbsp;C&nbsp;Compiler&nbsp;(A.05.57)<br>
PHSS_30849&nbsp;&nbsp;s700_800&nbsp;u2comp/be/plugin&nbsp;library&nbsp;Patch</P>
</P><P>
如果你同时有HP和GCC的C编译器，那么当你运行<TT CLASS="COMMAND">configure</TT>时，可能想要明确选择使用的编译器。
</P><PRE CLASS="PROGRAMLISTING">./configure CC=cc</PRE><P>
使用HP的C编译器，或者
</P><PRE CLASS="PROGRAMLISTING">./configure CC=gcc</PRE><P>
使用GCC的。如果你忽略这些设置，那么如果可选的话，configure将选择<TT CLASS="COMMAND">gcc</TT>。
</P><P> 缺省的安装目录是<TT CLASS="FILENAME">/usr/local/pgsql</TT>，你可能想要把<TT CLASS="FILENAME">/opt</TT>下的一些内容换到那里去。
如果这样，使用<TT CLASS="OPTION">--prefix</TT>切换<TT CLASS="COMMAND">configure</TT>。</P><P> 在回归测试中，可能有一些几何测试中的低位数有差异，这取决于您使用的编译器和数学库的版本。
任何其他的错误都值得怀疑。</P></DIV><DIV CLASS="SECT2"><H2 CLASS="SECT2"><A NAME="INSTALLATION-NOTES-IRIX">15.7.4. IRIX</A></H2><P> PostgreSQL已在MIPS r8000，r10000 (ip25和ip27)以及r12000(ip35)处理器上成功运行，
运行在IRIX 6.5.5m, 6.5.12, 6.5.13和6.5.26与MIPSPro编译器版本7.30, 7.3.1.2m, 7.3和7.4.4m。</P><P> 您将需要MIPSPro完整ANSI C编译器。尝试使用GCC编译存在问题。
这是关于使用函数返回某种特定类型的结构体时的众所周知的GCC bug（不固定为3.0版本）。
此问题会影响函数，如<CODE CLASS="FUNCTION">inet_ntoa</CODE>, <CODE CLASS="FUNCTION">inet_lnaof</CODE>, <CODE CLASS="FUNCTION">inet_netof</CODE>, <CODE CLASS="FUNCTION">inet_makeaddr</CODE>,
和<CODE CLASS="FUNCTION">semctl</CODE>。该问题应该已经通过强迫那些函数与libgcc链接修复过了，但是这还没有被测试过。</P><P> MIPSPro编译器的7.4.1m版本会产生错误的代码。当尝试启动数据库时，现象是<SPAN CLASS="QUOTE">"无效主节点记录"</SPAN>。
版本7.4.4m没有问题；中间版本的情况不确定。</P><P>
有可能是编译问题，如下：
</P><PRE CLASS="SCREEN">cc-1020 cc: ERROR File = pqcomm.c, Line = 427
  The identifier "TCP_NODELAY" is undefined.

                if (setsockopt(port-&#62;sock, IPPROTO_TCP, TCP_NODELAY,</PRE><P>
一些版本包括<TT CLASS="FILENAME">sys/xti.h</TT>中的TCP定义，
因此需要在<TT CLASS="FILENAME">src/backend/libpq/pqcomm.c</TT>和
<TT CLASS="FILENAME">src/interfaces/libpq/fe-connect.c</TT>中添加<TT CLASS="LITERAL">#include &lt;sys/xti.h&gt;</TT>
。如果你遇到这类问题，请告诉我们，以便于我们可以提供合适的修复。
</P><P> 在回归测试中，可能有一些几何测试中的低位数的差异，这取决于您使用的FPU。
任何其他的错误都值得怀疑。</P></DIV><DIV CLASS="SECT2"><H2 CLASS="SECT2"><A NAME="INSTALLATION-NOTES-MINGW">15.7.5. MinGW/Native Windows</A></H2><P> Windows下的PostgreSQL可以使用MinGW编译（微软操作系统上的类Unix编译环境），或者使用
微软的<SPAN CLASS="PRODUCTNAME">Visual C++</SPAN>编译器套件编译。
MinGW的编译采用本章中描述的通常的编译系统;
Visual C++编译工作完全不同，在<A HREF="http://school.yunwei.edu/manual/PostgreSQL/install-windows.html">第 16 &#31456;</A>中描述。
它完全是一种本地编译，并且没有使用像MinGW的额外软件。
现成的安装程序可以从PostgreSQL的网站上获得。</P><P> 本地Windows端口需要32或64位版本的Windows 2000或更高版本。早期操作系统
没有足够的基础设施（但Cygwin可能被使用）。
MinGW，类Unix编译工具，以及MSYS，这些Unix工具集合
在运行像<TT CLASS="COMMAND">configure</TT>这样的shell脚本时是需要的，
可以从<A HREF="http://www.mingw.org/" TARGET="_top">http://www.mingw.org/</A>下载。
两者在运行生成的二进制文件时不需要;
他们只在创建二进制文件时需要。</P><P> 使用MinGW编译64位的二进制文件时，安装来自<A HREF="http://mingw-w64.sourceforge.net/" TARGET="_top">http://mingw-w64.sourceforge.net/</A>的64位工具集，
将其bin目录放在<TT CLASS="ENVAR">PATH</TT>中，
并在运行<TT CLASS="COMMAND">configure</TT>命令时，指定<TT CLASS="COMMAND">--host=x86_64-w64-mingw</TT>选项。</P><P> 您已经安装了一切之后，建议您在<TT CLASS="COMMAND">CMD.EXE</TT>下运行<SPAN CLASS="APPLICATION">psql</SPAN>，
MSYS控制台有缓冲问题。</P><DIV CLASS="SECT3"><H3 CLASS="SECT3"><A NAME="WINDOWS-CRASH-DUMPS">15.7.5.1. Windows上崩溃Dump的搜集</A></H3><P> 如果PostgreSQL在Windows上崩溃，有可能产生<SPAN CLASS="PRODUCTNAME">minidumps</SPAN>可用于跟踪崩溃的原因，
类似于在Unix上的core dump。这些dump可以使用<SPAN CLASS="PRODUCTNAME">Windows调试器工具</SPAN>或者<SPAN CLASS="PRODUCTNAME">Visual Studio</SPAN>读取。
为了让Windows上Dump生成功能有效，
需要在集群数据目录里创建名为<TT CLASS="FILENAME">crashdumps</TT>的子目录。
Dump文件之后将被写入到该目录，基于崩溃进程的识别符和崩溃的当前时间保证dump文件名称的唯一。 </P></DIV></DIV><DIV CLASS="SECT2"><H2 CLASS="SECT2"><A NAME="INSTALLATION-NOTES-SCO">15.7.6. SCO OpenServer和SCO UnixWare</A></H2><P> PostgreSQL可以在SCO UnixWare 7和SCO OpenServer 5上编译。在OpenServer上，
你可以使用OpenServer Development Kit或者Universal Development Kit。
然而，可能需要一些调整，正如下面描述的。</P><DIV CLASS="SECT3"><H3 CLASS="SECT3"><A NAME="AEN25933">15.7.6.1. Skunkware</A></H3><P> 你应该找到你的SCO Skunkware CD的副本。
Skunkware CD附带UnixWare 7和OpenServer 5当前版本。
Skunkware包括可从互联网获得的许多流行程序的准备安装版本。
例如，包含gzip, gunzip, GNU Make, Flex和Bison。
对于UnixWare 7.1，这个光盘现在标有"开放式许可软件补充"，如果你没有这个光盘，
可以从<A HREF="http://www.sco.com/skunkware/" TARGET="_top">http://www.sco.com/skunkware/</A>获得。</P><P> Skunkware有UnixWare和OpenServer的不同版本。
请确保您为您的操作系统安装了的正确版本，除非有如下说明。</P><P> 在UnixWare 7.1.3及以上，包含在UDK CD上的GCC编译器作为GNU Make。</P></DIV><DIV CLASS="SECT3"><H3 CLASS="SECT3"><A NAME="AEN25939">15.7.6.2. GNU Make</A></H3><P> 您需要使用GNU make程序，位于Skunkware
CD上。默认情况下，它被安装成<TT CLASS="FILENAME">/usr/local/bin/make</TT>。
为了避免混淆SCO <TT CLASS="FILENAME">make</TT>程序，你可能需要重命名GNU<TT CLASS="FILENAME">make</TT>为<TT CLASS="FILENAME">gmake</TT>。</P><P> 由于UnixWare 7.1.3及以上，GNU Make程序是UDK CD的OSTK部分，
并且位于<TT CLASS="FILENAME">/usr/gnu/bin/gmake</TT>。</P></DIV><DIV CLASS="SECT3"><H3 CLASS="SECT3"><A NAME="AEN25948">15.7.6.3. Readline</A></H3><P> Readline库在Skunkware CD上。但它不包括在UnixWare 7.1 Skunkware CD上。如果你有UnixWare 7.0.0或者7.0.1 Skunkware CD，您可以从那里安装。
否则，尝试<A HREF="http://www.sco.com/skunkware/" TARGET="_top">http://www.sco.com/skunkware/</A>。</P><P>
缺省情况下，Readline安装在<TT CLASS="FILENAME">/usr/local/lib</TT>和
<TT CLASS="FILENAME">/usr/local/include</TT>。
然而，没有帮助的情况下PostgreSQL <TT CLASS="COMMAND">configure</TT>程序找不到它。
如果你安装了Readline,那么使用<TT CLASS="COMMAND">configure</TT>的下列选项：
</P><PRE CLASS="PROGRAMLISTING">./configure --with-libraries=/usr/local/lib --with-includes=/usr/local/include</PRE><P>
</P></DIV><DIV CLASS="SECT3"><H3 CLASS="SECT3"><A NAME="AEN25958">15.7.6.4. 在OpenServer上使用UDK</A></H3><P>
如果你正在OpenServer上使用新的通用开发Kit (UDK)编译器，你需要声明UDK库的位置：
</P><PRE CLASS="PROGRAMLISTING">./configure --with-libraries=/udk/usr/lib --with-includes=/udk/usr/include</PRE><P>
将上面这些与Readline选项放在一起：
</P><PRE CLASS="PROGRAMLISTING">./configure --with-libraries="/udk/usr/lib /usr/local/lib" --with-includes="/udk/usr/include /usr/local/include"</PRE><P>
</P></DIV><DIV CLASS="SECT3"><H3 CLASS="SECT3"><A NAME="AEN25963">15.7.6.5. 阅读PostgreSQL手册页</A></H3><P>
缺省情况下，PostgreSQL手册页安装在<TT CLASS="FILENAME">/usr/local/pgsql/man</TT>。
但是缺省时，UnixWare不会到那里查阅手册页。为了能够查看，你需要修改<TT CLASS="FILENAME">/etc/default/man</TT>中的<TT CLASS="VARNAME">MANPATH</TT>
变量，比如：
</P><PRE CLASS="PROGRAMLISTING">MANPATH=/usr/lib/scohelp/%L/man:/usr/dt/man:/usr/man:/usr/share/man:scohelp:/usr/local/man:/usr/local/pgsql/man</PRE><P>
</P><P> 在OpenServer上，需要投入一些额外调查使手册页可用，因为帮助系统和其他的平台有一点差异。
目前，PostgreSQL根本不安装它们。</P></DIV><DIV CLASS="SECT3"><H3 CLASS="SECT3"><A NAME="AEN25971">15.7.6.6. 7.1.1b功能补充的C99问题</A></H3><P> 对于先于OpenUnix 8.0.0（UnixWare 7.1.2)发布的编译器，包括7.1.1b功能补充，
你可能需要在<TT CLASS="VARNAME">CFLAGS</TT>或者<TT CLASS="VARNAME">CC</TT>环境变量中指定<TT CLASS="OPTION">-Xb</TT>。
这么做是因为编译<TT CLASS="FILENAME">tuplesort.c</TT>中引用的内联函数时有一个错误。
显然，在7.1.2（8.0.0）及以上版本的编译器中已被变更。</P></DIV><DIV CLASS="SECT3"><H3 CLASS="SECT3"><A NAME="AEN25978">15.7.6.7. UnixWare上的线程</A></H3><P> 对于线程，你<SPAN CLASS="emphasis"><I CLASS="EMPHASIS">必须</I></SPAN>在<SPAN CLASS="emphasis"><I CLASS="EMPHASIS">所有</I></SPAN>使用libpq的程序上使用<TT CLASS="OPTION">-Kpthread</TT>。
libpq使用的<CODE CLASS="FUNCTION">pthread_*</CODE>调用，
只有在指定<TT CLASS="OPTION">-Kpthread</TT>/<TT CLASS="OPTION">-Kthread</TT>标志时可用。</P></DIV></DIV><DIV CLASS="SECT2"><H2 CLASS="SECT2"><A NAME="INSTALLATION-NOTES-SOLARIS">15.7.7. Solaris</A></H2><P> PostgreSQL在Solaris上有很好的支持。版本越新的操作系统，遇到的问题越少;
详细信息请参见下面。</P><DIV CLASS="SECT3"><H3 CLASS="SECT3"><A NAME="AEN25993">15.7.7.1. 所需工具</A></H3><P> 您可以使用GCC或Sun的编译器套件进行编译。为更好的代码优化，
在SPARC架构上强烈推荐Sun的编译器。我们已经听到使用GCC 2.95.1时的问题报告; 推荐GCC 2.95.3或更高的版本。
如果您正在使用Sun的编译器，请注意不要选择<TT CLASS="FILENAME">/usr/ucb/cc</TT>;而使用
<TT CLASS="FILENAME">/opt/SUNWspro/bin/cc</TT>。</P><P> 您可以从<A HREF="http://www.oracle.com/technetwork/server-storage/solarisstudio/downloads/" TARGET="_top">http://www.oracle.com/technetwork/server-storage/solarisstudio/downloads/</A>下载Sun Studio。
许多GNU工具都被集成到Solaris 10中，或者它们目前在Solaris companion CD上被提供。
如果你喜欢适用于Solaris旧版本的包，你可以从<A HREF="http://www.sunfreeware.com" TARGET="_top">http://www.sunfreeware.com</A>中找到这些工具。
如果你喜欢源码，可以参阅<A HREF="http://www.gnu.org/order/ftp.html" TARGET="_top">http://www.gnu.org/order/ftp.html</A>。</P></DIV><DIV CLASS="SECT3"><H3 CLASS="SECT3"><A NAME="AEN26002">15.7.7.2. OpenSSL问题</A></H3><P>
当您编译PostgreSQL支持OpenSSL的时候，你可能会得到以下文件中的编译错误：
<P></P></P><UL><LI><P><TT CLASS="FILENAME">src/backend/libpq/crypt.c</TT></P></LI><LI><P><TT CLASS="FILENAME">src/backend/libpq/password.c</TT></P></LI><LI><P><TT CLASS="FILENAME">src/interfaces/libpq/fe-auth.c</TT></P></LI><LI><P><TT CLASS="FILENAME">src/interfaces/libpq/fe-connect.c</TT></P></LI></UL><P>
这是因为标准的头文件<TT CLASS="FILENAME">/usr/include/crypt.h</TT>与OpenSSL所提供的头文件之间有命名空间冲突。
</P><P> 升级您的OpenSSL到版本0.9.6a修复这个问题。Solaris 9及以上版本中有OpenSSL的较新版本。</P></DIV><DIV CLASS="SECT3"><H3 CLASS="SECT3"><A NAME="AEN26020">15.7.7.3. configure提示失败的测试程序</A></H3><P>
如果<TT CLASS="COMMAND">configure</TT>提示失败的测试程序，
这可能是运行时链接程序无法找到一些库的情况，
可能是libz, libreadline或一些其他非标准库，如libssl。
为了让它指向正确的位置，在<TT CLASS="COMMAND">configure</TT>命令行上设置<TT CLASS="ENVAR">LDFLAGS</TT>环境变量。
比如：
</P><PRE CLASS="PROGRAMLISTING">configure ... LDFLAGS="-R /usr/sfw/lib:/opt/sfw/lib:/usr/local/lib"</PRE><P>
参阅<SPAN CLASS="CITEREFENTRY"><SPAN CLASS="REFENTRYTITLE">ld</SPAN></SPAN>手册页获取更多详情。
</P></DIV><DIV CLASS="SECT3"><H3 CLASS="SECT3"><A NAME="AEN26030">15.7.7.4. 64位编译有时崩溃</A></H3><P>
在Solaris 7以及更早版本中，64位版本的libc中的<CODE CLASS="FUNCTION">vsnprintf</CODE>有问题，
从而导致PostgreSQL不稳定的core dump。
最简单的已知的解决方法是强制PostgreSQL使用它自己的<CODE CLASS="FUNCTION">vsnprintf</CODE>，而不是库的副本。
要做到这一点，运行<TT CLASS="COMMAND">configure</TT>之后
编辑<TT CLASS="COMMAND">configure</TT>产生的文件：
在<TT CLASS="FILENAME">src/Makefile.global</TT>中，
更改行
</P><PRE CLASS="PROGRAMLISTING">LIBOBJS =</PRE><P>
读取
</P><PRE CLASS="PROGRAMLISTING">LIBOBJS = snprintf.o</PRE><P>
（可能还有其他在这个变量中已经列出的文件。顺序无关紧要。）然后照常编译。
</P></DIV><DIV CLASS="SECT3"><H3 CLASS="SECT3"><A NAME="AEN26040">15.7.7.5. 编译以获得最佳性能</A></H3><P> SPARC架构上，强烈推荐Sun Studio编译。尝试使用<TT CLASS="OPTION">-xO5</TT>优化
标志产生显著快速的二进制文件。不要使用
任何的标志修改浮点运算的行为以及<TT CLASS="VARNAME">errno</TT>处理（例如，
<TT CLASS="OPTION">-fast</TT>）。这些标志可以加速PostgreSQL的一些非标准的行为，例如日期/时间的计算。</P><P> 如果您没有理由在SPARC上使用64位二进制文件，请选择32位版本。64位运算速度较慢，
并且64位二进制比32位更慢。另一方面，在AMD64 CPU族中的32位代码不是本地的，
这就是为什么32位代码在这个CPU族中显著慢的原因。</P></DIV><DIV CLASS="SECT3"><H3 CLASS="SECT3"><A NAME="AEN26047">15.7.7.6. 使用DTrace追踪PostgreSQL</A></H3><P> 是的，有可能使用DTrace。参阅
<A HREF="dynamic-trace.html">第 27.4 &#33410;</A>获取更多信息。
你也可以通过文章<A HREF="https://blogs.oracle.com/robertlor/entry/user_level_dtrace_probes_in" TARGET="_top">https://blogs.oracle.com/robertlor/entry/user_level_dtrace_probes_in</A>
查找更多的信息。</P><P>
如果您看到链接的<TT CLASS="COMMAND">postgres</TT>执行中断的错误信息如：
</P><PRE CLASS="SCREEN">Undefined                       first referenced
 symbol                             in file
AbortTransaction                    utils/probes.o
CommitTransaction                   utils/probes.o
ld: fatal: Symbol referencing errors. No output written to postgres
collect2: ld returned 1 exit status
gmake: *** [postgres] Error 1</PRE><P>
您的DTrace安装太旧而不能处理静态函数的探测。你需要Solaris 10u4或更高版本。
</P></DIV></DIV></DIV><DIV CLASS="NAVFOOTER"><HR ALIGN="LEFT" WIDTH="100%"><TABLE SUMMARY="Footer navigation table" WIDTH="100%" BORDER="0" CELLPADDING="0" CELLSPACING="0"><TR><TD WIDTH="33%" ALIGN="left" VALIGN="top"><A HREF="supported-platforms.html" ACCESSKEY="P">&#19978;&#19968;&#39029;</A></TD><TD WIDTH="34%" ALIGN="center" VALIGN="top"><A HREF="http://school.yunwei.edu/manual/PostgreSQL/index.html" ACCESSKEY="H">&#36215;&#22987;&#39029;</A></TD><TD WIDTH="33%" ALIGN="right" VALIGN="top"><A HREF="http://school.yunwei.edu/manual/PostgreSQL/install-windows.html" ACCESSKEY="N">&#19979;&#19968;&#39029;</A></TD></TR><TR><TD WIDTH="33%" ALIGN="left" VALIGN="top">支持的平台</TD><TD WIDTH="34%" ALIGN="center" VALIGN="top"><A HREF="http://school.yunwei.edu/manual/PostgreSQL/installation.html" ACCESSKEY="U">&#19978;&#19968;&#32423;</A></TD><TD WIDTH="33%" ALIGN="right" VALIGN="top"><SPAN CLASS="PRODUCTNAME">Windows</SPAN>下用源代码安装</TD></TR></TABLE></DIV></BODY></HTML>
