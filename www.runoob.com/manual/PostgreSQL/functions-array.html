<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<HTML><HEAD><TITLE>数组函数和操作符</TITLE><META NAME="GENERATOR" CONTENT="Modular DocBook HTML Stylesheet Version 1.79"><LINK REV="MADE" HREF="mailto:pgsql-docs@postgresql.org"><LINK REL="HOME" TITLE="PostgreSQL 9.3.1 中文手册" HREF="http://school.yunwei.edu/manual/PostgreSQL/index.html"><LINK REL="UP" TITLE="函数和操作符" HREF="http://school.yunwei.edu/manual/PostgreSQL/functions.html"><LINK REL="PREVIOUS" TITLE="条件表达式" HREF="functions-conditional.html"><LINK REL="NEXT" TITLE="范围函数和操作符" HREF="functions-range.html"><LINK REL="STYLESHEET" TYPE="text/css" HREF="http://school.yunwei.edu/manual/PostgreSQL/stylesheet.css"><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8"><META NAME="creation" CONTENT="2015-07-11T14:00:17"></HEAD><BODY CLASS="SECT1">
<div style="text-align:right">
<a style="margin : 0px 0px 0px 10px;" href="https://github.com/postgres-cn/pgdoc-cn/issues/new" target="_blank" title="在Github上报告问题（请注明问题内容及所在章节）">问题报告</a>
<a style="margin : 0px 0px 0px 10px;" href="https://github.com/postgres-cn/pgdoc-cn/edit/master/postgresql/doc/src/sgml/func.sgml" target="_blank" title="直接在Github上纠错本页面">纠错本页面</a>
</div>
<DIV CLASS="NAVHEADER"><TABLE SUMMARY="Header navigation table" WIDTH="100%" BORDER="0" CELLPADDING="0" CELLSPACING="0"><TR><TH COLSPAN="5" ALIGN="center" VALIGN="bottom"><A HREF="http://school.yunwei.edu/manual/PostgreSQL/index.html">PostgreSQL 9.3.1 中文手册</A></TH></TR><TR><TD WIDTH="10%" ALIGN="left" VALIGN="top"><A TITLE="条件表达式" HREF="functions-conditional.html" ACCESSKEY="P">&#19978;&#19968;&#39029;</A></TD><TD WIDTH="10%" ALIGN="left" VALIGN="top"><A HREF="http://school.yunwei.edu/manual/PostgreSQL/functions.html" ACCESSKEY="U">&#19978;&#19968;&#32423;</A></TD><TD WIDTH="60%" ALIGN="center" VALIGN="bottom">&#31456; 9. 函数和操作符</TD><TD WIDTH="20%" ALIGN="right" VALIGN="top"><A TITLE="范围函数和操作符" HREF="functions-range.html" ACCESSKEY="N">&#19979;&#19968;&#39029;</A></TD></TR></TABLE><HR ALIGN="LEFT" WIDTH="100%"></DIV><DIV CLASS="SECT1"><H1 CLASS="SECT1"><A NAME="FUNCTIONS-ARRAY">9.18. 数组函数和操作符</A></H1><P><A HREF="functions-array.html#ARRAY-OPERATORS-TABLE">&#34920; 9-42</A>显示了可以用于 array 类型的操作符。</P><DIV CLASS="TABLE"><A NAME="ARRAY-OPERATORS-TABLE"></A><P><B>&#34920; 9-42. Array 操作符</B></P><TABLE BORDER="1" CLASS="CALSTABLE"><COL><COL><COL><COL><THEAD><TR><TH>操作符</TH><TH>描述</TH><TH>例子</TH><TH>结果</TH></TR></THEAD><TBODY><TR><TD> <TT CLASS="LITERAL">=</TT> </TD><TD>等于</TD><TD><TT CLASS="LITERAL">ARRAY[1.1,2.1,3.1]::int[] = ARRAY[1,2,3]</TT></TD><TD><TT CLASS="LITERAL">t</TT></TD></TR><TR><TD> <TT CLASS="LITERAL">&lt;&gt;</TT> </TD><TD>不等于</TD><TD><TT CLASS="LITERAL">ARRAY[1,2,3] &lt;&gt; ARRAY[1,2,4]</TT></TD><TD><TT CLASS="LITERAL">t</TT></TD></TR><TR><TD> <TT CLASS="LITERAL">&lt;</TT> </TD><TD>小于</TD><TD><TT CLASS="LITERAL">ARRAY[1,2,3] &lt; ARRAY[1,2,4]</TT></TD><TD><TT CLASS="LITERAL">t</TT></TD></TR><TR><TD> <TT CLASS="LITERAL">&gt;</TT> </TD><TD>大于</TD><TD><TT CLASS="LITERAL">ARRAY[1,4,3] &gt; ARRAY[1,2,4]</TT></TD><TD><TT CLASS="LITERAL">t</TT></TD></TR><TR><TD> <TT CLASS="LITERAL">&lt;=</TT> </TD><TD>小于或等于</TD><TD><TT CLASS="LITERAL">ARRAY[1,2,3] &lt;= ARRAY[1,2,3]</TT></TD><TD><TT CLASS="LITERAL">t</TT></TD></TR><TR><TD> <TT CLASS="LITERAL">&gt;=</TT> </TD><TD>大于或等于</TD><TD><TT CLASS="LITERAL">ARRAY[1,4,3] &gt;= ARRAY[1,4,3]</TT></TD><TD><TT CLASS="LITERAL">t</TT></TD></TR><TR><TD> <TT CLASS="LITERAL">@&gt;</TT> </TD><TD>包含</TD><TD><TT CLASS="LITERAL">ARRAY[1,4,3] @&gt; ARRAY[3,1]</TT></TD><TD><TT CLASS="LITERAL">t</TT></TD></TR><TR><TD> <TT CLASS="LITERAL">&lt;@</TT> </TD><TD>被包含于</TD><TD><TT CLASS="LITERAL">ARRAY[2,7] &lt;@ ARRAY[1,7,4,2,6]</TT></TD><TD><TT CLASS="LITERAL">t</TT></TD></TR><TR><TD> <TT CLASS="LITERAL">&amp;&amp;</TT> </TD><TD>重叠(有共同元素)</TD><TD><TT CLASS="LITERAL">ARRAY[1,4,3] &amp;&amp; ARRAY[2,1]</TT></TD><TD><TT CLASS="LITERAL">t</TT></TD></TR><TR><TD> <TT CLASS="LITERAL">||</TT> </TD><TD>数组与数组连接</TD><TD><TT CLASS="LITERAL">ARRAY[1,2,3] || ARRAY[4,5,6]</TT></TD><TD><TT CLASS="LITERAL">{1,2,3,4,5,6}</TT></TD></TR><TR><TD> <TT CLASS="LITERAL">||</TT> </TD><TD>数组与数组连接</TD><TD><TT CLASS="LITERAL">ARRAY[1,2,3] || ARRAY[[4,5,6],[7,8,9]]</TT></TD><TD><TT CLASS="LITERAL">{{1,2,3},{4,5,6},{7,8,9}}</TT></TD></TR><TR><TD> <TT CLASS="LITERAL">||</TT> </TD><TD>元素与数组连接</TD><TD><TT CLASS="LITERAL">3 || ARRAY[4,5,6]</TT></TD><TD><TT CLASS="LITERAL">{3,4,5,6}</TT></TD></TR><TR><TD> <TT CLASS="LITERAL">||</TT> </TD><TD>数组与元素连接</TD><TD><TT CLASS="LITERAL">ARRAY[4,5,6] || 7</TT></TD><TD><TT CLASS="LITERAL">{4,5,6,7}</TT></TD></TR></TBODY></TABLE></DIV><P>数组比较是使用默认的 B-Tree 比较函数对所有元素逐一进行比较的。
多维数组的元素按照行顺序进行访问(最后的下标变化最快)。如果两个数组的内容相同但维数不等，
那么决定排序顺序的首要因素将是维数(原文：the first difference in the dimensionality information
determines the sort order)，这与<SPAN CLASS="PRODUCTNAME">PostgreSQL</SPAN> 8.2 之前的版本不同：
老版本认为内容相同的两个数组相等，即使它们的维数或下标范围并不相同。</P><P>参阅<A HREF="arrays.html">第 8.15 &#33410;</A>获取有关数组操作符行为的更多细节。
参阅<A HREF="indexes-types.html">第 11.2 &#33410;</A>获取哪个操作符支持索引操作的更多细节。</P><P><A HREF="functions-array.html#ARRAY-FUNCTIONS-TABLE">&#34920; 9-43</A>显示了可以用于数组类型的函数。
参阅<A HREF="arrays.html">第 8.15 &#33410;</A>获取更多信息以及使用这些函数的例子。</P><DIV CLASS="TABLE"><A NAME="ARRAY-FUNCTIONS-TABLE"></A><P><B>&#34920; 9-43. Array 函数</B></P><TABLE BORDER="1" CLASS="CALSTABLE"><COL><COL><COL><COL><COL><THEAD><TR><TH>函数</TH><TH>返回类型</TH><TH>描述</TH><TH>例子</TH><TH>结果</TH></TR></THEAD><TBODY><TR><TD> <TT CLASS="LITERAL"> <CODE CLASS="FUNCTION">array_append</CODE>(<TT CLASS="TYPE">anyarray</TT>, <TT CLASS="TYPE">anyelement</TT>)
</TT>
</TD><TD><TT CLASS="TYPE">anyarray</TT></TD><TD>向数组末尾添加元素</TD><TD><TT CLASS="LITERAL">array_append(ARRAY[1,2], 3)</TT></TD><TD><TT CLASS="LITERAL">{1,2,3}</TT></TD></TR><TR><TD> <TT CLASS="LITERAL"> <CODE CLASS="FUNCTION">array_cat</CODE>(<TT CLASS="TYPE">anyarray</TT>, <TT CLASS="TYPE">anyarray</TT>)
</TT>
</TD><TD><TT CLASS="TYPE">anyarray</TT></TD><TD>连接两个数组</TD><TD><TT CLASS="LITERAL">array_cat(ARRAY[1,2,3], ARRAY[4,5])</TT></TD><TD><TT CLASS="LITERAL">{1,2,3,4,5}</TT></TD></TR><TR><TD> <TT CLASS="LITERAL"> <CODE CLASS="FUNCTION">array_ndims</CODE>(<TT CLASS="TYPE">anyarray</TT>)
</TT>
</TD><TD><TT CLASS="TYPE">int</TT></TD><TD>返回数组的维数</TD><TD><TT CLASS="LITERAL">array_ndims(ARRAY[[1,2,3], [4,5,6]])</TT></TD><TD><TT CLASS="LITERAL">2</TT></TD></TR><TR><TD> <TT CLASS="LITERAL"> <CODE CLASS="FUNCTION">array_dims</CODE>(<TT CLASS="TYPE">anyarray</TT>)
</TT>
</TD><TD><TT CLASS="TYPE">text</TT></TD><TD>返回数组维数的文本表示</TD><TD><TT CLASS="LITERAL">array_dims(ARRAY[[1,2,3], [4,5,6]])</TT></TD><TD><TT CLASS="LITERAL">[1:2][1:3]</TT></TD></TR><TR><TD> <TT CLASS="LITERAL"> <CODE CLASS="FUNCTION">array_fill</CODE>(<TT CLASS="TYPE">anyelement</TT>, <TT CLASS="TYPE">int[]</TT>,
[<SPAN CLASS="OPTIONAL">, <TT CLASS="TYPE">int[]</TT></SPAN>])
</TT>
</TD><TD><TT CLASS="TYPE">anyarray</TT></TD><TD>返回数组初始化提供的值和维度，可选下界不是1</TD><TD><TT CLASS="LITERAL">array_fill(7, ARRAY[3], ARRAY[2])</TT></TD><TD><TT CLASS="LITERAL">[2:4]={7,7,7}</TT></TD></TR><TR><TD> <TT CLASS="LITERAL"> <CODE CLASS="FUNCTION">array_length</CODE>(<TT CLASS="TYPE">anyarray</TT>, <TT CLASS="TYPE">int</TT>)
</TT>
</TD><TD><TT CLASS="TYPE">int</TT></TD><TD>返回数组维度的长度</TD><TD><TT CLASS="LITERAL">array_length(array[1,2,3], 1)</TT></TD><TD><TT CLASS="LITERAL">3</TT></TD></TR><TR><TD> <TT CLASS="LITERAL"> <CODE CLASS="FUNCTION">array_lower</CODE>(<TT CLASS="TYPE">anyarray</TT>, <TT CLASS="TYPE">int</TT>)
</TT>
</TD><TD><TT CLASS="TYPE">int</TT></TD><TD>返回数组维数的下界</TD><TD><TT CLASS="LITERAL">array_lower('[0:2]={1,2,3}'::int[], 1)</TT></TD><TD><TT CLASS="LITERAL">0</TT></TD></TR><TR><TD> <TT CLASS="LITERAL"> <CODE CLASS="FUNCTION">array_prepend</CODE>(<TT CLASS="TYPE">anyelement</TT>, <TT CLASS="TYPE">anyarray</TT>)
</TT>
</TD><TD><TT CLASS="TYPE">anyarray</TT></TD><TD>向数组开头添加元素</TD><TD><TT CLASS="LITERAL">array_prepend(1, ARRAY[2,3])</TT></TD><TD><TT CLASS="LITERAL">{1,2,3}</TT></TD></TR><TR><TD> <TT CLASS="LITERAL"> <CODE CLASS="FUNCTION">array_remove</CODE>(<TT CLASS="TYPE">anyarray</TT>, <TT CLASS="TYPE">anyelement</TT>)
</TT>
</TD><TD><TT CLASS="TYPE">anyarray</TT></TD><TD>从数组中删除所有等于给定值的元素（数组必须是一维的）</TD><TD><TT CLASS="LITERAL">array_remove(ARRAY[1,2,3,2], 2)</TT></TD><TD><TT CLASS="LITERAL">{1,3}</TT></TD></TR><TR><TD> <TT CLASS="LITERAL"> <CODE CLASS="FUNCTION">array_replace</CODE>(<TT CLASS="TYPE">anyarray</TT>, <TT CLASS="TYPE">anyelement</TT>, <TT CLASS="TYPE">anyelement</TT>)
</TT>
</TD><TD><TT CLASS="TYPE">anyarray</TT></TD><TD>用新值替换每个等于给定值的数组元素</TD><TD><TT CLASS="LITERAL">array_replace(ARRAY[1,2,5,4], 5, 3)</TT></TD><TD><TT CLASS="LITERAL">{1,2,3,4}</TT></TD></TR><TR><TD> <TT CLASS="LITERAL"> <CODE CLASS="FUNCTION">array_to_string</CODE>(<TT CLASS="TYPE">anyarray</TT>, <TT CLASS="TYPE">text</TT> [<SPAN CLASS="OPTIONAL">, <TT CLASS="TYPE">text</TT></SPAN>])
</TT>
</TD><TD><TT CLASS="TYPE">text</TT></TD><TD>使用分隔符和null字符串连接数组元素</TD><TD><TT CLASS="LITERAL">array_to_string(ARRAY[1, 2, 3, NULL, 5], ',', '*')</TT></TD><TD><TT CLASS="LITERAL">1,2,3,*,5</TT></TD></TR><TR><TD> <TT CLASS="LITERAL"> <CODE CLASS="FUNCTION">array_upper</CODE>(<TT CLASS="TYPE">anyarray</TT>, <TT CLASS="TYPE">int</TT>)
</TT>
</TD><TD><TT CLASS="TYPE">int</TT></TD><TD>返回数组维数的上界</TD><TD><TT CLASS="LITERAL">array_upper(ARRAY[1,8,3,7], 1)</TT></TD><TD><TT CLASS="LITERAL">4</TT></TD></TR><TR><TD> <TT CLASS="LITERAL"> <CODE CLASS="FUNCTION">string_to_array</CODE>(<TT CLASS="TYPE">text</TT>, <TT CLASS="TYPE">text</TT> [<SPAN CLASS="OPTIONAL">, <TT CLASS="TYPE">text</TT></SPAN>])
</TT>
</TD><TD><TT CLASS="TYPE">text[]</TT></TD><TD>使用指定的分隔符和null字符串把字符串分裂成数组元素</TD><TD><TT CLASS="LITERAL">string_to_array('xx~^~yy~^~zz', '~^~', 'yy')</TT></TD><TD><TT CLASS="LITERAL">{xx,NULL,zz}</TT></TD></TR><TR><TD> <TT CLASS="LITERAL"> <CODE CLASS="FUNCTION">unnest</CODE>(<TT CLASS="TYPE">anyarray</TT>)
</TT>
</TD><TD><TT CLASS="TYPE">setof anyelement</TT></TD><TD>扩大一个数组为一组行</TD><TD><TT CLASS="LITERAL">unnest(ARRAY[1,2])</TT></TD><TD><PRE CLASS="LITERALLAYOUT">1
2</PRE>(2 rows)</TD></TR></TBODY></TABLE></DIV><P>在<CODE CLASS="FUNCTION">string_to_array</CODE>中，如果分隔符参数是NULL，
输入字符串中的每个字符将在结果数组中变成一个独立的元素。如果分隔符是一个空白字符串，
那么整个输入字符串将变为一元素的数组。否则输入字符串将在每个分隔字符串处分裂。</P><P>在<CODE CLASS="FUNCTION">string_to_array</CODE>中，如果省略null字符串参数或为NULL，
将没有输入字符串的子串被NULL代替。在<CODE CLASS="FUNCTION">array_to_string</CODE>中，
如果省略null字符串参数或为NULL，在数组中的任何null元素将简单的跳过，
并且不再输出字符串中出现。</P><DIV CLASS="NOTE"><BLOCKQUOTE CLASS="NOTE"><P><B>&#27880;&#24847;: </B>在<SPAN CLASS="PRODUCTNAME">PostgreSQL</SPAN>版本9.1之前，<CODE CLASS="FUNCTION">string_to_array</CODE>有两个行为上的不同。
第一，当输入字符串长度为零时，它将返回一个空（零元素）数组而不是NULL。第二，
如果分隔字符串是NULL时，函数分隔输入为单独的字符，而不是和以前一样返回NULL。</P></BLOCKQUOTE></DIV><P>也可以参阅<A HREF="functions-aggregate.html">第 9.20 &#33410;</A>获取关于
<CODE CLASS="FUNCTION">array_agg</CODE>聚集函数使用数组的信息。</P></DIV><DIV CLASS="NAVFOOTER"><HR ALIGN="LEFT" WIDTH="100%"><TABLE SUMMARY="Footer navigation table" WIDTH="100%" BORDER="0" CELLPADDING="0" CELLSPACING="0"><TR><TD WIDTH="33%" ALIGN="left" VALIGN="top"><A HREF="functions-conditional.html" ACCESSKEY="P">&#19978;&#19968;&#39029;</A></TD><TD WIDTH="34%" ALIGN="center" VALIGN="top"><A HREF="http://school.yunwei.edu/manual/PostgreSQL/index.html" ACCESSKEY="H">&#36215;&#22987;&#39029;</A></TD><TD WIDTH="33%" ALIGN="right" VALIGN="top"><A HREF="functions-range.html" ACCESSKEY="N">&#19979;&#19968;&#39029;</A></TD></TR><TR><TD WIDTH="33%" ALIGN="left" VALIGN="top">条件表达式</TD><TD WIDTH="34%" ALIGN="center" VALIGN="top"><A HREF="http://school.yunwei.edu/manual/PostgreSQL/functions.html" ACCESSKEY="U">&#19978;&#19968;&#32423;</A></TD><TD WIDTH="33%" ALIGN="right" VALIGN="top">范围函数和操作符</TD></TR></TABLE></DIV></BODY></HTML>
