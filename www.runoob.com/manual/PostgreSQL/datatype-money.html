<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<HTML><HEAD><TITLE>货币类型</TITLE><META NAME="GENERATOR" CONTENT="Modular DocBook HTML Stylesheet Version 1.79"><LINK REV="MADE" HREF="mailto:pgsql-docs@postgresql.org"><LINK REL="HOME" TITLE="PostgreSQL 9.3.1 中文手册" HREF="http://school.yunwei.edu/manual/PostgreSQL/index.html"><LINK REL="UP" TITLE="数据类型" HREF="http://school.yunwei.edu/manual/PostgreSQL/datatype.html"><LINK REL="PREVIOUS" TITLE="数值类型" HREF="datatype-numeric.html"><LINK REL="NEXT" TITLE="字符类型" HREF="datatype-character.html"><LINK REL="STYLESHEET" TYPE="text/css" HREF="http://school.yunwei.edu/manual/PostgreSQL/stylesheet.css"><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8"><META NAME="creation" CONTENT="2015-07-11T14:00:17"></HEAD><BODY CLASS="SECT1">
<div style="text-align:right">
<a style="margin : 0px 0px 0px 10px;" href="https://github.com/postgres-cn/pgdoc-cn/issues/new" target="_blank" title="在Github上报告问题（请注明问题内容及所在章节）">问题报告</a>
<a style="margin : 0px 0px 0px 10px;" href="https://github.com/postgres-cn/pgdoc-cn/edit/master/postgresql/doc/src/sgml/datatype.sgml" target="_blank" title="直接在Github上纠错本页面">纠错本页面</a>
</div>
<DIV CLASS="NAVHEADER"><TABLE SUMMARY="Header navigation table" WIDTH="100%" BORDER="0" CELLPADDING="0" CELLSPACING="0"><TR><TH COLSPAN="5" ALIGN="center" VALIGN="bottom"><A HREF="http://school.yunwei.edu/manual/PostgreSQL/index.html">PostgreSQL 9.3.1 中文手册</A></TH></TR><TR><TD WIDTH="10%" ALIGN="left" VALIGN="top"><A TITLE="数值类型" HREF="datatype-numeric.html" ACCESSKEY="P">&#19978;&#19968;&#39029;</A></TD><TD WIDTH="10%" ALIGN="left" VALIGN="top"><A HREF="http://school.yunwei.edu/manual/PostgreSQL/datatype.html" ACCESSKEY="U">&#19978;&#19968;&#32423;</A></TD><TD WIDTH="60%" ALIGN="center" VALIGN="bottom">&#31456; 8. 数据类型</TD><TD WIDTH="20%" ALIGN="right" VALIGN="top"><A TITLE="字符类型" HREF="datatype-character.html" ACCESSKEY="N">&#19979;&#19968;&#39029;</A></TD></TR></TABLE><HR ALIGN="LEFT" WIDTH="100%"></DIV><DIV CLASS="SECT1"><H1 CLASS="SECT1"><A NAME="DATATYPE-MONEY">8.2. 货币类型</A></H1><P><TT CLASS="TYPE">money</TT>类型存储带有固定小数精度的货币金额，可查阅
<A HREF="datatype-money.html#DATATYPE-MONEY-TABLE">&#34920; 8-3</A>。小数精度由<A HREF="runtime-config-client.html#GUC-LC-MONETARY">lc_monetary</A>
的设置来决定。表格中显示的范围假设有两位小数。可以以任意格式输入，包括整型，
浮点型，或者典型的货币格式，如<TT CLASS="LITERAL">'$1,000.00'</TT>。
根据区域字符集，输出一般是最后一种形式。 </P><DIV CLASS="TABLE"><A NAME="DATATYPE-MONEY-TABLE"></A><P><B>&#34920; 8-3. 货币类型</B></P><TABLE BORDER="1" CLASS="CALSTABLE"><COL><COL><COL><COL><THEAD><TR><TH>名字</TH><TH>存储容量</TH><TH>描述</TH><TH>范围</TH></TR></THEAD><TBODY><TR><TD>money</TD><TD>8 字节</TD><TD>货币金额</TD><TD>-92233720368547758.08 到 +92233720368547758.07</TD></TR></TBODY></TABLE></DIV><P>由于输出的数据类型对语言环境要求很细，因此，<TT CLASS="VARNAME">lc_monetary</TT>
设置的不同可能会造成无法将<TT CLASS="TYPE">money</TT>数据输入到数据库中。
为了避免这种问题的发生，在向一个新数据库进行转储之前，确保
<TT CLASS="VARNAME">lc_monetary</TT>与原数据库相同，或具有等价值。</P><P><TT CLASS="TYPE">numeric</TT>, <TT CLASS="TYPE">int</TT>和<TT CLASS="TYPE">bigint</TT>数据类型的值可以转化为
<TT CLASS="TYPE">money</TT>类型。从<TT CLASS="TYPE">real</TT>和<TT CLASS="TYPE">double precision</TT>
数据类型的转换可以通过先转化为<TT CLASS="TYPE">numeric</TT>类型，例如：
</P><PRE CLASS="PROGRAMLISTING">SELECT '12.34'::float8::numeric::money;</PRE><P>
然而，这是不被建议的。浮点数不应该用来处理货币类型，因为潜在的圆整可能导致错误。
</P><P>
<TT CLASS="TYPE">money</TT>值可以被转换为<TT CLASS="TYPE">numeric</TT>而不丢失精度。
转换为其他类型可能丢失精度，并且必须通过两步来完成：
</P><PRE CLASS="PROGRAMLISTING">SELECT '52093.89'::money::numeric::float8;</PRE><P>
</P><P>当一个<TT CLASS="TYPE">money</TT>值被另一个<TT CLASS="TYPE">money</TT>值除时，
结果是<TT CLASS="TYPE">double precision</TT>（也就是，一个纯数字，而不是money）；
在结果中货币单位相互取消。</P></DIV><DIV CLASS="NAVFOOTER"><HR ALIGN="LEFT" WIDTH="100%"><TABLE SUMMARY="Footer navigation table" WIDTH="100%" BORDER="0" CELLPADDING="0" CELLSPACING="0"><TR><TD WIDTH="33%" ALIGN="left" VALIGN="top"><A HREF="datatype-numeric.html" ACCESSKEY="P">&#19978;&#19968;&#39029;</A></TD><TD WIDTH="34%" ALIGN="center" VALIGN="top"><A HREF="http://school.yunwei.edu/manual/PostgreSQL/index.html" ACCESSKEY="H">&#36215;&#22987;&#39029;</A></TD><TD WIDTH="33%" ALIGN="right" VALIGN="top"><A HREF="datatype-character.html" ACCESSKEY="N">&#19979;&#19968;&#39029;</A></TD></TR><TR><TD WIDTH="33%" ALIGN="left" VALIGN="top">数值类型</TD><TD WIDTH="34%" ALIGN="center" VALIGN="top"><A HREF="http://school.yunwei.edu/manual/PostgreSQL/datatype.html" ACCESSKEY="U">&#19978;&#19968;&#32423;</A></TD><TD WIDTH="33%" ALIGN="right" VALIGN="top">字符类型</TD></TR></TABLE></DIV></BODY></HTML>
