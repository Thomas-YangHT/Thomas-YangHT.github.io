<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<HTML><HEAD><TITLE>制作文档</TITLE><META NAME="GENERATOR" CONTENT="Modular DocBook HTML Stylesheet Version 1.79"><LINK REV="MADE" HREF="mailto:pgsql-docs@postgresql.org"><LINK REL="HOME" TITLE="PostgreSQL 9.3.1 中文手册" HREF="http://school.yunwei.edu/manual/PostgreSQL/index.html"><LINK REL="UP" TITLE="文档" HREF="http://school.yunwei.edu/manual/PostgreSQL/docguide.html"><LINK REL="PREVIOUS" TITLE="工具集" HREF="docguide-toolsets.html"><LINK REL="NEXT" TITLE="文档写作" HREF="docguide-authoring.html"><LINK REL="STYLESHEET" TYPE="text/css" HREF="http://school.yunwei.edu/manual/PostgreSQL/stylesheet.css"><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8"><META NAME="creation" CONTENT="2015-07-11T14:00:17"></HEAD><BODY CLASS="SECT1">
<div style="text-align:right">
<a style="margin : 0px 0px 0px 10px;" href="https://github.com/postgres-cn/pgdoc-cn/issues/new" target="_blank" title="在Github上报告问题（请注明问题内容及所在章节）">问题报告</a>
<a style="margin : 0px 0px 0px 10px;" href="https://github.com/postgres-cn/pgdoc-cn/edit/master/postgresql/doc/src/sgml/docguide.sgml" target="_blank" title="直接在Github上纠错本页面">纠错本页面</a>
</div>
<DIV CLASS="NAVHEADER"><TABLE SUMMARY="Header navigation table" WIDTH="100%" BORDER="0" CELLPADDING="0" CELLSPACING="0"><TR><TH COLSPAN="5" ALIGN="center" VALIGN="bottom"><A HREF="http://school.yunwei.edu/manual/PostgreSQL/index.html">PostgreSQL 9.3.1 中文手册</A></TH></TR><TR><TD WIDTH="10%" ALIGN="left" VALIGN="top"><A TITLE="工具集" HREF="docguide-toolsets.html" ACCESSKEY="P">&#19978;&#19968;&#39029;</A></TD><TD WIDTH="10%" ALIGN="left" VALIGN="top"><A HREF="http://school.yunwei.edu/manual/PostgreSQL/docguide.html" ACCESSKEY="U">&#19978;&#19968;&#32423;</A></TD><TD WIDTH="60%" ALIGN="center" VALIGN="bottom">&#38468;&#24405; J. 文档</TD><TD WIDTH="20%" ALIGN="right" VALIGN="top"><A TITLE="文档写作" HREF="docguide-authoring.html" ACCESSKEY="N">&#19979;&#19968;&#39029;</A></TD></TR></TABLE><HR ALIGN="LEFT" WIDTH="100%"></DIV><DIV CLASS="SECT1"><H1 CLASS="SECT1"><A NAME="DOCGUIDE-BUILD">J.3. 制作文档</A></H1><P>一旦把所有的东西都设置好了，进入目录<TT CLASS="FILENAME">doc/src/sgml</TT>
然后运行下面其中一条命令(记得要用 GNU make)：</P><DIV CLASS="SECT2"><H2 CLASS="SECT2"><A NAME="AEN153493">J.3.1. HTML</A></H2><P>制作<ACRONYM CLASS="ACRONYM">HTML</ACRONYM>版本的文档：
</P><PRE CLASS="SCREEN"><SAMP
CLASS="PROMPT"
>doc/src/sgml$ </SAMP
><KBD
CLASS="USERINPUT"
>gmake html</KBD
></PRE><P>
这也是缺省目标。在子目录<TT CLASS="FILENAME">html</TT>里输出。</P><P>要创建一个适当的索引，可能处理几个相同的阶段。如果你不关心该索引，
只是想校对输出，使用<TT CLASS="LITERAL">draft</TT>:
</P><PRE CLASS="SCREEN"><SAMP
CLASS="PROMPT"
>doc/src/sgml$ </SAMP
><KBD
CLASS="USERINPUT"
>gmake draft</KBD
></PRE><P></P><P>要建立文档为一个HTML页，使用：
</P><PRE CLASS="SCREEN"><SAMP
CLASS="PROMPT"
>doc/src/sgml$ </SAMP
><KBD
CLASS="USERINPUT"
>gmake postgres.html</KBD
></PRE><P></P></DIV><DIV CLASS="SECT2"><H2 CLASS="SECT2"><A NAME="AEN153510">J.3.2. 手册页</A></H2><P>用DocBook XSL样式表把<SPAN CLASS="PRODUCTNAME">DocBook</SPAN>的<CODE CLASS="SGMLTAG">refentry</CODE>
页面转换成适于做手册页的 *roff 输出。这些手册页也是以 tar 归档的形式发布的，
与<ACRONYM CLASS="ACRONYM">HTML</ACRONYM>版本类似。要创建手册页包，用命令：
</P><PRE CLASS="PROGRAMLISTING">cd doc/src/sgml
gmake man</PRE><P></P></DIV><DIV CLASS="SECT2"><H2 CLASS="SECT2"><A NAME="AEN153517">J.3.3. 用<SPAN CLASS="APPLICATION">JadeTeX</SPAN>生成的打印输出</A></H2><P>如果你想用<SPAN CLASS="APPLICATION">JadeTex</SPAN>生成一个可打印的文档，可以用下面的命令：
<P></P></P><UL><LI><P>使用<ACRONYM CLASS="ACRONYM">DVI</ACRONYM>生成一个A4格式的PostScript：
</P><PRE CLASS="SCREEN"><SAMP
CLASS="PROMPT"
>doc/src/sgml$ </SAMP
><KBD
CLASS="USERINPUT"
>gmake postgres-A4.ps</KBD
></PRE><P>
U.S.信件的格式：
</P><PRE CLASS="SCREEN"><SAMP
CLASS="PROMPT"
>doc/src/sgml$ </SAMP
><KBD
CLASS="USERINPUT"
>gmake postgres-US.ps</KBD
></PRE><P></P></LI><LI><P>制作一个<ACRONYM CLASS="ACRONYM">PDF</ACRONYM>：
</P><PRE CLASS="SCREEN"><SAMP
CLASS="PROMPT"
>doc/src/sgml$ </SAMP
><KBD
CLASS="USERINPUT"
>gmake postgres-A4.pdf</KBD
></PRE><P>
或：
</P><PRE CLASS="SCREEN"><SAMP
CLASS="PROMPT"
>doc/src/sgml$ </SAMP
><KBD
CLASS="USERINPUT"
>gmake postgres-US.pdf</KBD
></PRE><P>
当然，你也可以从 Postscript 里制作<ACRONYM CLASS="ACRONYM">PDF</ACRONYM>版本，但是如果你直接生成
<ACRONYM CLASS="ACRONYM">PDF</ACRONYM>，那么它会有超链接和其它增强的特性。</P></LI></UL><P>
</P><P>当使用 JadeTeX 生成PostgreSQL文档时，你可能需要增大一些TeX的内部参数。
通过设置文件<TT CLASS="FILENAME">texmf.cnf</TT>来实现。下面的设置立即生效：
</P><PRE CLASS="PROGRAMLISTING">hash_extra.jadetex  = 200000
hash_extra.pdfjadetex  = 200000
pool_size.jadetex = 2000000
pool_size.pdfjadetex = 2000000
string_vacancies.jadetex = 150000
string_vacancies.pdfjadetex = 150000
max_strings.jadetex = 300000
max_strings.pdfjadetex = 300000
save_size.jadetex = 15000
save_size.pdfjadetex = 15000</PRE><P></P></DIV><DIV CLASS="SECT2"><H2 CLASS="SECT2"><A NAME="AEN153546">J.3.4. 溢出文本</A></H2><P>偶尔文本超出了打印的边缘，并且在极限情况下，超出了打印的纸张的宽度，例如，非包裹的文本，
宽表格。过宽的文本在TeX日志输出文件中产生<SPAN CLASS="QUOTE">"Overfull hbox"</SPAN>信息，例如，
<TT CLASS="FILENAME">postgres-US.log</TT> 或 <TT CLASS="FILENAME">postgres-A4.log</TT>。一英寸有72个点，
所以任何超过72个点的报告都太宽，可能不适合打印页（假设一英寸）。
要找到导致溢出的<ACRONYM CLASS="ACRONYM">SGML</ACRONYM>文本，首先找到上面提到的溢出信息的首页码，例如，
<TT CLASS="LITERAL">[50 ###]</TT> (page 50)，然后在<ACRONYM CLASS="ACRONYM">PDF</ACRONYM>文件中查找其后的页码(例如页 51)，
查看溢出文本并相应的调整<ACRONYM CLASS="ACRONYM">SGML</ACRONYM>。</P></DIV><DIV CLASS="SECT2"><H2 CLASS="SECT2"><A NAME="AEN153556">J.3.5. 通过<ACRONYM CLASS="ACRONYM">RTF</ACRONYM>生成打印输出</A></H2><P>你也可以通过把它转换成<ACRONYM CLASS="ACRONYM">RTF</ACRONYM>并且用一个办公套件进行格式微调的办法来创建一个
<SPAN CLASS="PRODUCTNAME">PostgreSQL</SPAN>文档的可打印的版本。根据你使用的不同的办公套件，
然后你就可以分别把文档转换成 <ACRONYM CLASS="ACRONYM">PDF</ACRONYM>格式的Postscript。
下面的步骤演示了使用<SPAN CLASS="PRODUCTNAME">Applixware</SPAN>实现的过程。</P><DIV CLASS="NOTE"><BLOCKQUOTE CLASS="NOTE"><P><B>&#27880;&#24847;: </B>目前看来<SPAN CLASS="PRODUCTNAME">PostgreSQL</SPAN>的当前版本的文档碰到了 OpenJade 的大小限制的一些毛病。
如果制作<ACRONYM CLASS="ACRONYM">RTF</ACRONYM>版本的时候停住了好长时间，而输出文件还是 0 ，
那么你很有可能碰到了这个毛病。不过，正常的制作要花 5 到 10 分钟，因此不要太快退出。</P></BLOCKQUOTE></DIV><DIV CLASS="PROCEDURE"><P><B><SPAN CLASS="PRODUCTNAME">Applixware</SPAN> <ACRONYM CLASS="ACRONYM">RTF</ACRONYM> 清理</B></P><P><SPAN CLASS="APPLICATION">OpenJade</SPAN>忽略了声明文本主体的缺省风格。以前，
这个未经查明的问题导致目录生成的长时间处理。不过，在<SPAN CLASS="PRODUCTNAME">Applixware</SPAN>
的工作人员的全力帮助下，这个病症被诊断出来并且找到了绕开的办法。</P><OL TYPE="1"><LI CLASS="STEP"><P>键入下面命令生成<ACRONYM CLASS="ACRONYM">RTF</ACRONYM>版本：
</P><PRE CLASS="SCREEN"><SAMP
CLASS="PROMPT"
>doc/src/sgml$ </SAMP
><KBD
CLASS="USERINPUT"
>gmake postgres.rtf</KBD
></PRE><P></P></LI><LI CLASS="STEP"><P>修复 RTF 文件，以正确声明所有风格，尤其是缺省风格。如果文档包含<CODE CLASS="SGMLTAG">refentry</CODE>段，
那么还必须把和前面的段落与当前段落绑定的格式化暗示替换为当前的段落和后面的段落绑定。
在<TT CLASS="FILENAME">doc/src/sgml</TT>里有一个<TT CLASS="COMMAND">fixrtf</TT>用于完成这样的修补：
</P><PRE CLASS="SCREEN"><SAMP
CLASS="PROMPT"
>doc/src/sgml$ </SAMP
><KBD
CLASS="USERINPUT"
>./fixrtf --refentry postgres.rtf</KBD
></PRE><P></P><P>该脚本把<TT CLASS="LITERAL">{\s0 Normal;}</TT>增加为文档的零级风格。根据
<SPAN CLASS="PRODUCTNAME">Applixware</SPAN>，RTF 标准会禁止增加一种隐含的零级风格，
尽管 Microsoft Word 碰巧可以处理这种情况。为了修复<CODE CLASS="SGMLTAG">refentry</CODE>段落，
该脚本把<TT CLASS="LITERAL">\keepn</TT>标记替换为<TT CLASS="LITERAL">\keep</TT>。</P></LI><LI CLASS="STEP"><P>在<SPAN CLASS="PRODUCTNAME">Applixware Words</SPAN>里打开新的文档，然后输入该<ACRONYM CLASS="ACRONYM">RTF</ACRONYM>文件。</P></LI><LI CLASS="STEP"><P>用<SPAN CLASS="PRODUCTNAME">Applixware</SPAN>生成一个新的目录(ToC)。</P><OL CLASS="SUBSTEPS" TYPE="a"><LI CLASS="STEP"><P>选择现有的 ToC 行，从第一行第一个字符到最后一行最后一个字符。</P></LI><LI CLASS="STEP"><P>用<SPAN CLASS="GUIMENU">Tools</SPAN>-&gt;<SPAN CLASS="GUISUBMENU">Book Building</SPAN>-&gt;<SPAN CLASS="GUIMENUITEM">制作一个新的 ToC</SPAN>。选择头三层头用于包含在 ToC 里。这将用本地的
<SPAN CLASS="PRODUCTNAME">Applixware</SPAN> ToC 代替从 RTF 里输入进来的行。</P></LI><LI CLASS="STEP"><P>使用<SPAN CLASS="GUIMENU">Format</SPAN>-&gt;<SPAN CLASS="GUIMENUITEM">Style</SPAN>
调整 ToC 格式，选择每三种 ToC 风格，然后为<TT CLASS="LITERAL">First</TT>和<TT CLASS="LITERAL">Left</TT>
调整边距。使用下面的值：
<DIV CLASS="INFORMALTABLE"><P></P><A NAME="AEN153619"></A><TABLE BORDER="1" CLASS="CALSTABLE"><COL><COL><COL><THEAD><TR><TH>风格</TH><TH>第一边距(英寸)</TH><TH>左边距(英寸)</TH></TR></THEAD><TBODY><TR><TD><TT CLASS="LITERAL">TOC-Heading 1</TT></TD><TD><TT CLASS="LITERAL">0.4</TT></TD><TD><TT CLASS="LITERAL">0.4</TT></TD></TR><TR><TD><TT CLASS="LITERAL">TOC-Heading 2</TT></TD><TD><TT CLASS="LITERAL">0.8</TT></TD><TD><TT CLASS="LITERAL">0.8</TT></TD></TR><TR><TD><TT CLASS="LITERAL">TOC-Heading 3</TT></TD><TD><TT CLASS="LITERAL">1.2</TT></TD><TD><TT CLASS="LITERAL">1.2</TT></TD></TR></TBODY></TABLE><P></P></DIV>
</P></LI></OL></LI><LI CLASS="STEP"><P> 对文档进行加工：
<P></P></P><UL><LI><P>调整分页符</P></LI><LI><P>调整表列宽</P></LI></UL><P>
</P></LI><LI CLASS="STEP"><P>用正确的值替换 ToC 里例子和图片部分右对齐的页数。这些对每个文档只需要花几分钟。</P></LI><LI CLASS="STEP"><P>如果索引是空的，那么从文档中删除它。</P></LI><LI CLASS="STEP"><P>重新生成并调整目录。</P><OL CLASS="SUBSTEPS" TYPE="a"><LI CLASS="STEP"><P>选择 ToC 字段。</P></LI><LI CLASS="STEP"><P>选择<SPAN CLASS="GUIMENU">Tools</SPAN>-&gt;<SPAN CLASS="GUISUBMENU">Book
Building</SPAN>-&gt;<SPAN CLASS="GUIMENUITEM">Create Table of
Contents</SPAN>。</P></LI><LI CLASS="STEP"><P>通过选择<SPAN CLASS="GUIMENU">Tools</SPAN>-&gt;<SPAN CLASS="GUISUBMENU">Field
Editing</SPAN>-&gt;<SPAN CLASS="GUIMENUITEM">Unprotect</SPAN>解除 ToC。</P></LI><LI CLASS="STEP"><P>删除 ToC 中的第一行，它是指向 ToC 本身的一条记录。</P></LI></OL></LI><LI CLASS="STEP"><P>把该文档保存为<SPAN CLASS="PRODUCTNAME">Applixware Words</SPAN>本地文档格式以便于最后的编辑。</P></LI><LI CLASS="STEP"><P>把该文档以 PostScript 格式<SPAN CLASS="QUOTE">"打印"</SPAN>到一个文件。</P></LI></OL></DIV></DIV><DIV CLASS="SECT2"><H2 CLASS="SECT2"><A NAME="AEN153684">J.3.6. 纯文本文件</A></H2><P>有好几个文件是以纯文本的模式发布的，主要是为了在安装过程中阅读。<TT CLASS="FILENAME">INSTALL</TT>
文件对应<A HREF="http://school.yunwei.edu/manual/PostgreSQL/installation.html">第 15 &#31456;</A>，只有一点用于不同环境的修改。要重建这个文件，
进入目录<TT CLASS="FILENAME">doc/src/sgml</TT>然后敲入<KBD CLASS="USERINPUT">gmake INSTALL</KBD>。
这样就会创建一个叫<TT CLASS="FILENAME">INSTALL.html</TT>的文件，你可以用
<SPAN CLASS="PRODUCTNAME">Netscape Navigator</SPAN>把它另存为一个文本文件，然后把它拷到现存文件的位置。
好像<SPAN CLASS="PRODUCTNAME">Netscape</SPAN>提供了最高的<ACRONYM CLASS="ACRONYM">HTML</ACRONYM>
到文本的转换质量(比<SPAN CLASS="APPLICATION">lynx</SPAN>和<SPAN CLASS="APPLICATION">w3m</SPAN>好)。</P><P>文件<TT CLASS="FILENAME">HISTORY</TT>可以用类似方法创建，用的命令是<KBD CLASS="USERINPUT">gmake HISTORY</KBD>。
对于<TT CLASS="FILENAME">src/test/regress/README</TT>文件，命令是<KBD CLASS="USERINPUT">gmake regress_README</KBD>。</P></DIV><DIV CLASS="SECT2"><H2 CLASS="SECT2"><A NAME="AEN153702">J.3.7. 语法检查</A></H2><P>制作文档可能需要很长时间。但是有一个方法用于只检查文档文件的语法正确性，只要花几秒钟：
</P><PRE CLASS="SCREEN"><SAMP
CLASS="PROMPT"
>doc/src/sgml$ </SAMP
><KBD
CLASS="USERINPUT"
>gmake check</KBD
></PRE><P></P></DIV></DIV><DIV CLASS="NAVFOOTER"><HR ALIGN="LEFT" WIDTH="100%"><TABLE SUMMARY="Footer navigation table" WIDTH="100%" BORDER="0" CELLPADDING="0" CELLSPACING="0"><TR><TD WIDTH="33%" ALIGN="left" VALIGN="top"><A HREF="docguide-toolsets.html" ACCESSKEY="P">&#19978;&#19968;&#39029;</A></TD><TD WIDTH="34%" ALIGN="center" VALIGN="top"><A HREF="http://school.yunwei.edu/manual/PostgreSQL/index.html" ACCESSKEY="H">&#36215;&#22987;&#39029;</A></TD><TD WIDTH="33%" ALIGN="right" VALIGN="top"><A HREF="docguide-authoring.html" ACCESSKEY="N">&#19979;&#19968;&#39029;</A></TD></TR><TR><TD WIDTH="33%" ALIGN="left" VALIGN="top">工具集</TD><TD WIDTH="34%" ALIGN="center" VALIGN="top"><A HREF="http://school.yunwei.edu/manual/PostgreSQL/docguide.html" ACCESSKEY="U">&#19978;&#19968;&#32423;</A></TD><TD WIDTH="33%" ALIGN="right" VALIGN="top">文档写作</TD></TR></TABLE></DIV></BODY></HTML>
