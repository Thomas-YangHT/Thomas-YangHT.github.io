<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<HTML><HEAD><TITLE>VALUES</TITLE><META NAME="GENERATOR" CONTENT="Modular DocBook HTML Stylesheet Version 1.79"><LINK REV="MADE" HREF="mailto:pgsql-docs@postgresql.org"><LINK REL="HOME" TITLE="PostgreSQL 9.3.1 中文手册" HREF="http://school.yunwei.edu/manual/PostgreSQL/index.html"><LINK REL="UP" TITLE="SQL 命令" HREF="http://school.yunwei.edu/manual/PostgreSQL/sql-commands.html"><LINK REL="PREVIOUS" TITLE="VACUUM" HREF="sql-vacuum.html"><LINK REL="NEXT" TITLE="PostgreSQL 客户端应用程序" HREF="http://school.yunwei.edu/manual/PostgreSQL/reference-client.html"><LINK REL="STYLESHEET" TYPE="text/css" HREF="http://school.yunwei.edu/manual/PostgreSQL/stylesheet.css"><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8"><META NAME="creation" CONTENT="2015-07-11T14:00:17"></HEAD><BODY CLASS="REFENTRY">
<div style="text-align:right">
<a style="margin : 0px 0px 0px 10px;" href="https://github.com/postgres-cn/pgdoc-cn/issues/new" target="_blank" title="在Github上报告问题（请注明问题内容及所在章节）">问题报告</a>
<a style="margin : 0px 0px 0px 10px;" href="https://github.com/postgres-cn/pgdoc-cn/edit/master/postgresql/doc/src/sgml/ref/values.sgml" target="_blank" title="直接在Github上纠错本页面">纠错本页面</a>
</div>
<DIV CLASS="NAVHEADER"><TABLE SUMMARY="Header navigation table" WIDTH="100%" BORDER="0" CELLPADDING="0" CELLSPACING="0"><TR><TH COLSPAN="5" ALIGN="center" VALIGN="bottom"><A HREF="http://school.yunwei.edu/manual/PostgreSQL/index.html">PostgreSQL 9.3.1 中文手册</A></TH></TR><TR><TD WIDTH="10%" ALIGN="left" VALIGN="top"><A TITLE="VACUUM" HREF="sql-vacuum.html" ACCESSKEY="P">&#19978;&#19968;&#39029;</A></TD><TD WIDTH="10%" ALIGN="left" VALIGN="top"><A HREF="http://school.yunwei.edu/manual/PostgreSQL/sql-commands.html" ACCESSKEY="U">&#19978;&#19968;&#32423;</A></TD><TD WIDTH="60%" ALIGN="center" VALIGN="bottom"></TD><TD WIDTH="20%" ALIGN="right" VALIGN="top"><A TITLE="PostgreSQL 客户端应用程序" HREF="http://school.yunwei.edu/manual/PostgreSQL/reference-client.html" ACCESSKEY="N">&#19979;&#19968;&#39029;</A></TD></TR></TABLE><HR ALIGN="LEFT" WIDTH="100%"></DIV><H1><A NAME="SQL-VALUES"></A>VALUES</H1><DIV CLASS="REFNAMEDIV"><A NAME="AEN81967"></A><H2>&#21517;&#31216;</H2>VALUES&nbsp;--&nbsp;计算一个或一组行</DIV><DIV CLASS="REFSYNOPSISDIV"><A NAME="AEN81972"></A><H2>&#22823;&#32434;</H2><PRE CLASS="SYNOPSIS">VALUES ( <TT
CLASS="REPLACEABLE"
><I
>expression</I
></TT
> [, ...] ) [, ...]
    [ ORDER BY <TT
CLASS="REPLACEABLE"
><I
>sort_expression</I
></TT
> [ ASC | DESC | USING <TT
CLASS="REPLACEABLE"
><I
>operator</I
></TT
> ] [, ...] ]
    [ LIMIT { <TT
CLASS="REPLACEABLE"
><I
>count</I
></TT
> | ALL } ]
    [ OFFSET <TT
CLASS="REPLACEABLE"
><I
>start</I
></TT
> [ ROW | ROWS ] ]
    [ FETCH { FIRST | NEXT } [ <TT
CLASS="REPLACEABLE"
><I
>count</I
></TT
> ] { ROW | ROWS } ONLY ]</PRE></DIV><DIV CLASS="REFSECT1"><A NAME="AEN81980"></A><H2>描述</H2><P><TT CLASS="COMMAND">VALUES</TT>根据给定的值表达式计算一个或一组行的值。
它通常用于在一个较大的命令内生成一个<SPAN CLASS="QUOTE">"常数表"</SPAN>，但是它也可以用于自身。</P><P>如果指定了多行，那么每一行都必须拥有相同的元素个数。
结果表字段的数据类型将根据表达式的明确或隐含的数据类型确定，
使用的规则与<TT CLASS="LITERAL">UNION</TT>(<A HREF="typeconv-union-case.html">第 10.5 &#33410;</A>)相同。</P><P>在大命令里面，<TT CLASS="COMMAND">VALUES</TT>允许出现在任何<TT CLASS="COMMAND">SELECT</TT>可以出现的地方。
因为它在语法上非常类似于<TT CLASS="COMMAND">SELECT</TT>，可以在<TT CLASS="COMMAND">VALUES</TT>命令中使用
<TT CLASS="LITERAL">ORDER BY</TT>, <TT CLASS="LITERAL">LIMIT</TT> (或相等的 <TT CLASS="LITERAL">FETCH FIRST</TT>),
和 <TT CLASS="LITERAL">OFFSET</TT>子句。</P></DIV><DIV CLASS="REFSECT1"><A NAME="AEN81997"></A><H2>参数</H2><P></P><DIV CLASS="VARIABLELIST"><DL><DT><TT CLASS="REPLACEABLE"><I>expression</I></TT></DT><DD><P>用于计算或插入结果表指定地点的常量或者表达式。在一个出现在<TT CLASS="COMMAND">INSERT</TT>
顶层的<TT CLASS="COMMAND">VALUES</TT>列表中，<TT CLASS="REPLACEABLE"><I>expression</I></TT>
可以被<TT CLASS="LITERAL">DEFAULT</TT>替换以表示插入目的字段的缺省值。除此以外，
当<TT CLASS="COMMAND">VALUES</TT>出现在其他场合的时候是不能使用<TT CLASS="LITERAL">DEFAULT</TT>的。</P></DD><DT><TT CLASS="REPLACEABLE"><I>sort_expression</I></TT></DT><DD><P>一个表示如何排序结果行的表达式或者整数常量。这个表达式可以按照<TT CLASS="LITERAL">column1</TT>,
<TT CLASS="LITERAL">column2</TT>等等引用<TT CLASS="COMMAND">VALUES</TT>的结果列。更多细节参见
<A HREF="sql-select.html#SQL-ORDERBY"><I><I>ORDER BY</I> 子句</I></A>。</P></DD><DT><TT CLASS="REPLACEABLE"><I>operator</I></TT></DT><DD><P>一个排序操作符。更多细节参见<A HREF="sql-select.html#SQL-ORDERBY"><I><I>ORDER BY</I> 子句</I></A>。</P></DD><DT><TT CLASS="REPLACEABLE"><I>count</I></TT></DT><DD><P>返回的最大行数。更多细节参见 <A HREF="sql-select.html#SQL-LIMIT"><I><I>LIMIT</I> 子句</I></A>。</P></DD><DT><TT CLASS="REPLACEABLE"><I>start</I></TT></DT><DD><P>在开始返回行之前跳过的行数。更多细节参见<A HREF="sql-select.html#SQL-LIMIT"><I><I>LIMIT</I> 子句</I></A>。</P></DD></DL></DIV></DIV><DIV CLASS="REFSECT1"><A NAME="AEN82038"></A><H2>注意</H2><P>应当避免使用<TT CLASS="COMMAND">VALUES</TT>返回数量非常大的结果行，否则可能会遭遇内存耗尽或者性能低下。
出现在<TT CLASS="COMMAND">INSERT</TT>中的<TT CLASS="COMMAND">VALUES</TT>是一个特殊情况，
因为目标字段类型可以从<TT CLASS="COMMAND">INSERT</TT>的目标表获知，并不需要通过扫描<TT CLASS="COMMAND">VALUES</TT>
列表来推测，所以在此情况下可以处理非常大的结果行。</P></DIV><DIV CLASS="REFSECT1"><A NAME="AEN82046"></A><H2>例子</H2><P>一个光秃秃的<TT CLASS="COMMAND">VALUES</TT>命令：
</P><PRE CLASS="PROGRAMLISTING">VALUES (1, 'one'), (2, 'two'), (3, 'three');</PRE><P>
这将返回一个三行两列的表，它在效果上相当于：
</P><PRE CLASS="PROGRAMLISTING">SELECT 1 AS column1, 'one' AS column2
UNION ALL
SELECT 2, 'two'
UNION ALL
SELECT 3, 'three';</PRE><P></P><P>通常，<TT CLASS="COMMAND">VALUES</TT>会用于一个大 SQL 命令中，最常见的是用于<TT CLASS="COMMAND">INSERT</TT>命令：
</P><PRE CLASS="PROGRAMLISTING">INSERT INTO films (code, title, did, date_prod, kind)
    VALUES ('T_601', 'Yojimbo', 106, '1961-06-16', 'Drama');</PRE><P></P><P>在用于<TT CLASS="COMMAND">INSERT</TT>时，<TT CLASS="COMMAND">VALUES</TT>列表中的项可以使用
<TT CLASS="LITERAL">DEFAULT</TT>来表示使用字段的缺省值：
</P><PRE CLASS="PROGRAMLISTING">INSERT INTO films VALUES
    ('UA502', 'Bananas', 105, DEFAULT, 'Comedy', '82 minutes'),
    ('T_601', 'Yojimbo', 106, DEFAULT, 'Drama', DEFAULT);</PRE><P></P><P><TT CLASS="COMMAND">VALUES</TT>还可以用于子<TT CLASS="COMMAND">SELECT</TT>可以应用的场合。
比如在一个<TT CLASS="LITERAL">FROM</TT>子句中：
</P><PRE CLASS="PROGRAMLISTING">SELECT f.*
  FROM films f, (VALUES('MGM', 'Horror'), ('UA', 'Sci-Fi')) AS t (studio, kind)
  WHERE f.studio = t.studio AND f.kind = t.kind;

UPDATE employees SET salary = salary * v.increase
  FROM (VALUES(1, 200000, 1.2), (2, 400000, 1.4)) AS v (depno, target, increase)
  WHERE employees.depno = v.depno AND employees.sales &gt;= v.target;</PRE><P>
当<TT CLASS="COMMAND">VALUES</TT>用于<TT CLASS="LITERAL">FROM</TT>子句中的时候，必须使用<TT CLASS="LITERAL">AS</TT>子句，
这与用于<TT CLASS="COMMAND">SELECT</TT>时一样。并不要求<TT CLASS="LITERAL">AS</TT>子句为每个字段都指定一个别名，
但是这样做是一个好习惯。<SPAN CLASS="PRODUCTNAME">PostgreSQL</SPAN>中<TT CLASS="COMMAND">VALUES</TT>
缺省的字段名是<TT CLASS="LITERAL">column1</TT>, <TT CLASS="LITERAL">column2</TT>等等，
但这些缺省的名字并不一定与其他数据库系统相同。
</P><P>当<TT CLASS="COMMAND">VALUES</TT>用于<TT CLASS="COMMAND">INSERT</TT>的时候，所有的值都将按照目标字段自动做类型转换。
但是在其他场合就可能必须明确指定恰当的数据类型。如果所有的项都是引号包围的字面常量，
强制指定第一个类型就可以确定所有的类型：
</P><PRE CLASS="PROGRAMLISTING">SELECT * FROM machines
WHERE ip_address IN (VALUES('192.168.0.1'::inet), ('192.168.0.10'), ('192.168.1.43'));</PRE><P></P><DIV CLASS="TIP"><BLOCKQUOTE CLASS="TIP"><P><B>&#25552;&#31034;: </B>对于简单的<TT CLASS="LITERAL">IN</TT>测试，更好的方法是依赖于<TT CLASS="LITERAL">IN</TT>的标量列表形式，
而不是使用上述<TT CLASS="COMMAND">VALUES</TT>查询。标量列表的方法写的更少，而且通常也更有效。</P></BLOCKQUOTE></DIV></DIV><DIV CLASS="REFSECT1"><A NAME="AEN82084"></A><H2>兼容性</H2><P><TT CLASS="COMMAND">VALUES</TT>符合 SQL 标准，此外，<TT CLASS="LITERAL">LIMIT</TT>
和<TT CLASS="LITERAL">OFFSET</TT>是<SPAN CLASS="PRODUCTNAME">PostgreSQL</SPAN>扩展；
又见<A HREF="sql-select.html">SELECT</A>。</P></DIV><DIV CLASS="REFSECT1"><A NAME="AEN82092"></A><H2>又见</H2><A HREF="sql-insert.html">INSERT</A>, <A HREF="sql-select.html">SELECT</A></DIV><DIV CLASS="NAVFOOTER"><HR ALIGN="LEFT" WIDTH="100%"><TABLE SUMMARY="Footer navigation table" WIDTH="100%" BORDER="0" CELLPADDING="0" CELLSPACING="0"><TR><TD WIDTH="33%" ALIGN="left" VALIGN="top"><A HREF="sql-vacuum.html" ACCESSKEY="P">&#19978;&#19968;&#39029;</A></TD><TD WIDTH="34%" ALIGN="center" VALIGN="top"><A HREF="http://school.yunwei.edu/manual/PostgreSQL/index.html" ACCESSKEY="H">&#36215;&#22987;&#39029;</A></TD><TD WIDTH="33%" ALIGN="right" VALIGN="top"><A HREF="http://school.yunwei.edu/manual/PostgreSQL/reference-client.html" ACCESSKEY="N">&#19979;&#19968;&#39029;</A></TD></TR><TR><TD WIDTH="33%" ALIGN="left" VALIGN="top">VACUUM</TD><TD WIDTH="34%" ALIGN="center" VALIGN="top"><A HREF="http://school.yunwei.edu/manual/PostgreSQL/sql-commands.html" ACCESSKEY="U">&#19978;&#19968;&#32423;</A></TD><TD WIDTH="33%" ALIGN="right" VALIGN="top">PostgreSQL 客户端应用程序</TD></TR></TABLE></DIV></BODY></HTML>
