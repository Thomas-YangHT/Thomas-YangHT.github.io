<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<HTML><HEAD><TITLE>fuzzystrmatch</TITLE><META NAME="GENERATOR" CONTENT="Modular DocBook HTML Stylesheet Version 1.79"><LINK REV="MADE" HREF="mailto:pgsql-docs@postgresql.org"><LINK REL="HOME" TITLE="PostgreSQL 9.3.1 中文手册" HREF="http://school.yunwei.edu/manual/PostgreSQL/index.html"><LINK REL="UP" TITLE="额外提供的模块" HREF="http://school.yunwei.edu/manual/PostgreSQL/contrib.html"><LINK REL="PREVIOUS" TITLE="file_fdw" HREF="file-fdw.html"><LINK REL="NEXT" TITLE="hstore" HREF="hstore.html"><LINK REL="STYLESHEET" TYPE="text/css" HREF="http://school.yunwei.edu/manual/PostgreSQL/stylesheet.css"><META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8"><META NAME="creation" CONTENT="2015-07-11T14:00:17"></HEAD><BODY CLASS="SECT1">
<div style="text-align:right">
<a style="margin : 0px 0px 0px 10px;" href="https://github.com/postgres-cn/pgdoc-cn/issues/new" target="_blank" title="在Github上报告问题（请注明问题内容及所在章节）">问题报告</a>
<a style="margin : 0px 0px 0px 10px;" href="https://github.com/postgres-cn/pgdoc-cn/edit/master/postgresql/doc/src/sgml/fuzzystrmatch.sgml" target="_blank" title="直接在Github上纠错本页面">纠错本页面</a>
</div>
<DIV CLASS="NAVHEADER"><TABLE SUMMARY="Header navigation table" WIDTH="100%" BORDER="0" CELLPADDING="0" CELLSPACING="0"><TR><TH COLSPAN="5" ALIGN="center" VALIGN="bottom"><A HREF="http://school.yunwei.edu/manual/PostgreSQL/index.html">PostgreSQL 9.3.1 中文手册</A></TH></TR><TR><TD WIDTH="10%" ALIGN="left" VALIGN="top"><A TITLE="file_fdw" HREF="file-fdw.html" ACCESSKEY="P">&#19978;&#19968;&#39029;</A></TD><TD WIDTH="10%" ALIGN="left" VALIGN="top"><A HREF="http://school.yunwei.edu/manual/PostgreSQL/contrib.html" ACCESSKEY="U">&#19978;&#19968;&#32423;</A></TD><TD WIDTH="60%" ALIGN="center" VALIGN="bottom">&#38468;&#24405; F. 额外提供的模块</TD><TD WIDTH="20%" ALIGN="right" VALIGN="top"><A TITLE="hstore" HREF="hstore.html" ACCESSKEY="N">&#19979;&#19968;&#39029;</A></TD></TR></TABLE><HR ALIGN="LEFT" WIDTH="100%"></DIV><DIV CLASS="SECT1"><H1 CLASS="SECT1"><A NAME="FUZZYSTRMATCH">F.15. fuzzystrmatch</A></H1><P><TT CLASS="FILENAME">fuzzystrmatch</TT>模块提供几个函数判断字符串之间的相似点和距离。</P><DIV CLASS="CAUTION"><P></P><TABLE CLASS="CAUTION" BORDER="1" WIDTH="100%"><TR><TD ALIGN="CENTER"><B>&#23567;&#24515;</B></TD></TR><TR><TD ALIGN="LEFT"><P>目前，<CODE CLASS="FUNCTION">soundex</CODE>, <CODE CLASS="FUNCTION">metaphone</CODE>, <CODE CLASS="FUNCTION">dmetaphone</CODE>, 和
<CODE CLASS="FUNCTION">dmetaphone_alt</CODE>不适合多字节编码（如UTF-8）。</P></TD></TR></TABLE></DIV><DIV CLASS="SECT2"><H2 CLASS="SECT2"><A NAME="AEN146038">F.15.1. Soundex</A></H2><P>Soundex 系统是一种通过转换为相同代码匹配相似发音名字的方法。
最初是在1880、1900和1910年用于美国的人口普查。注意Soundex对于非英文的名字不是很有帮助。</P><P><TT CLASS="FILENAME">fuzzystrmatch</TT>模块提供和Soundex代码一起使用的两个函数:</P><PRE CLASS="SYNOPSIS">soundex(text) returns text
difference(text, text) returns int</PRE><P><CODE CLASS="FUNCTION">soundex</CODE>函数转换字符串为Soundex代码。<CODE CLASS="FUNCTION">difference</CODE>
函数转换两个字符串为它们的Soundex代码然后报告匹配代码位置的数量。
因为Soundex代码有四个字符，结果范围从零到四，零表示没有匹配而四表示完全匹配。
（因此，这个函数取名不当，<CODE CLASS="FUNCTION">similarity</CODE>本是一个好名字。）</P><P>这里是一些有用的示例：</P><PRE CLASS="PROGRAMLISTING">SELECT soundex('hello world!');

SELECT soundex('Anne'), soundex('Ann'), difference('Anne', 'Ann');
SELECT soundex('Anne'), soundex('Andrew'), difference('Anne', 'Andrew');
SELECT soundex('Anne'), soundex('Margaret'), difference('Anne', 'Margaret');

CREATE TABLE s (nm text);

INSERT INTO s VALUES ('john');
INSERT INTO s VALUES ('joan');
INSERT INTO s VALUES ('wobbly');
INSERT INTO s VALUES ('jack');

SELECT * FROM s WHERE soundex(nm) = soundex('john');

SELECT * FROM s WHERE difference(s.nm, 'john') &gt; 2;</PRE></DIV><DIV CLASS="SECT2"><H2 CLASS="SECT2"><A NAME="AEN146054">F.15.2. Levenshtein</A></H2><P>这个函数计算两个字符串之间的Levenshtein距离：</P><PRE CLASS="SYNOPSIS">levenshtein(text source, text target, int ins_cost, int del_cost, int sub_cost) returns int
levenshtein(text source, text target) returns int
levenshtein_less_equal(text source, text target, int ins_cost, int del_cost, int sub_cost, int max_d) returns int
levenshtein_less_equal(text source, text target, int max_d) returns int</PRE><P><TT CLASS="LITERAL">source</TT>和<TT CLASS="LITERAL">target</TT>都可以是任意非空字符串，最多为255字节。
cost参数声明对于一个字符插入、删除或替换分别改变多少。可以省略cost参数，
就像该函数的第二种语法；这种情况下，他们缺省都是1。<TT CLASS="LITERAL">levenshtein_less_equal</TT>
对于低距离是levenshtein函数的快速版本。如果实际距离小于或等于max_d，
那么<TT CLASS="LITERAL">levenshtein_less_equal</TT>返回实际值。否则这个函数返回大于max_d的值。</P><P>示例：</P><PRE CLASS="SCREEN">test=# SELECT levenshtein('GUMBO', 'GAMBOL');
 levenshtein
-------------
           2
(1 row)

test=# SELECT levenshtein('GUMBO', 'GAMBOL', 2,1,1);
 levenshtein
-------------
           3
(1 row)

test=# SELECT levenshtein_less_equal('extensive', 'exhaustive',2);
 levenshtein_less_equal
------------------------
                      3
(1 row)

test=# SELECT levenshtein_less_equal('extensive', 'exhaustive',4);
 levenshtein_less_equal
------------------------
                      4
(1 row)</PRE></DIV><DIV CLASS="SECT2"><H2 CLASS="SECT2"><A NAME="AEN146069">F.15.3. Metaphone</A></H2><P>Metaphone，类似于Soundex，基于为输入字符串构造一个典型的代码的想法。
如果两个字符串有相同的代码那么认为它们相似。</P><P>这个函数计算输入字符串的metaphone代码：</P><PRE CLASS="SYNOPSIS">metaphone(text source, int max_output_length) returns text</PRE><P><TT CLASS="LITERAL">source</TT>必须为一个非空字符串，最多为255个字符。
<TT CLASS="LITERAL">max_output_length</TT>设置输出metaphone代码的最大长度；
如果实际比这长，那么输出截断为这个长度。</P><P>示例：</P><PRE CLASS="SCREEN">test=# SELECT metaphone('GUMBO', 4);
 metaphone
-----------
 KM
(1 row)</PRE></DIV><DIV CLASS="SECT2"><H2 CLASS="SECT2"><A NAME="AEN146081">F.15.4. Double Metaphone</A></H2><P>Double Metaphone系统为一个给定的输入字符串计算两个<SPAN CLASS="QUOTE">"听起来像"</SPAN>的字符串&mdash;
一个<SPAN CLASS="QUOTE">"原先的"</SPAN>和一个<SPAN CLASS="QUOTE">"替换的"</SPAN>。大多数情况下它们相同，
但是取决于发音它们对于非英文名有一点不同。这些函数计算原先的和替换的代码：</P><PRE CLASS="SYNOPSIS">dmetaphone(text source) returns text
dmetaphone_alt(text source) returns text</PRE><P>这里对于输入字符串没有长度限制。</P><P>示例：</P><PRE CLASS="SCREEN">test=# select dmetaphone('gumbo');
 dmetaphone
------------
 KMP
(1 row)</PRE></DIV></DIV><DIV CLASS="NAVFOOTER"><HR ALIGN="LEFT" WIDTH="100%"><TABLE SUMMARY="Footer navigation table" WIDTH="100%" BORDER="0" CELLPADDING="0" CELLSPACING="0"><TR><TD WIDTH="33%" ALIGN="left" VALIGN="top"><A HREF="file-fdw.html" ACCESSKEY="P">&#19978;&#19968;&#39029;</A></TD><TD WIDTH="34%" ALIGN="center" VALIGN="top"><A HREF="http://school.yunwei.edu/manual/PostgreSQL/index.html" ACCESSKEY="H">&#36215;&#22987;&#39029;</A></TD><TD WIDTH="33%" ALIGN="right" VALIGN="top"><A HREF="hstore.html" ACCESSKEY="N">&#19979;&#19968;&#39029;</A></TD></TR><TR><TD WIDTH="33%" ALIGN="left" VALIGN="top">file_fdw</TD><TD WIDTH="34%" ALIGN="center" VALIGN="top"><A HREF="http://school.yunwei.edu/manual/PostgreSQL/contrib.html" ACCESSKEY="U">&#19978;&#19968;&#32423;</A></TD><TD WIDTH="33%" ALIGN="right" VALIGN="top">hstore</TD></TR></TABLE></DIV></BODY></HTML>
