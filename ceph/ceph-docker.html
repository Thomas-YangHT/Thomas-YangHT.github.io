<html>
<head>
  <title>Evernote Export</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/307027 (zh-CN, DDL); Windows/10.0.0 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="3655"/>

<div>
<span><div style="-evernote-webclip:true"><br/><div style="font-size: 16px; display: inline-block;"><div style="outline:currentcolor none 0px;box-sizing:border-box;"><div style="box-sizing:inherit;outline:currentcolor none 0px;font-family:&quot;SF Pro Display&quot;, Roboto, Noto, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Microsoft YaHei&quot;, sans-serif;font-size:14px;line-height:1.57143;background-color:rgb(245, 246, 247);color:rgb(51, 51, 51);"><div style="outline:currentcolor none 0px;box-sizing:border-box;"><span style="box-sizing:inherit;outline:currentcolor none 0px;"><div style="box-sizing:inherit;outline:currentcolor none 0px;background:rgb(255, 255, 255) none repeat scroll 0% 0%;box-shadow:rgba(0, 0, 0, 0.05) 0px 2px 4px 0px;">
	<div style="box-sizing:inherit;outline:currentcolor none 0px;padding:0px;margin:0px;border-bottom:1px solid rgb(224, 224, 224);padding-top:24px;z-index:9;background-color:rgb(255, 255, 255);">
		<div style="box-sizing:inherit;outline:currentcolor none 0px;padding:0px;margin:0px;">
			<div style="box-sizing:inherit;outline:currentcolor none 0px;padding:0px;margin:0px;margin-bottom:16px;">
				<span style="box-sizing:inherit;outline:currentcolor none 0px;display:inline-block;width:26px;height:26px;line-height:26px;text-align:center;font-size:12px;border-radius:50%;color:rgb(202, 12, 22);border:1px solid rgb(244, 206, 208);margin-top:4px;margin-right:8px;float:left;">原</span>				<h1 style="box-sizing:inherit;outline:currentcolor none 0px;padding:0px;margin:0px;font-size:24px;word-break:break-all;">Ceph集群Docker容器化部署</h1>
			</div>
			<div style="box-sizing:inherit;outline:currentcolor none 0px;padding:0px;margin:0px;padding-bottom:14px;">
				<div style="box-sizing:inherit;outline:currentcolor none 0px;padding:0px;margin:0px;color:rgb(133, 133, 133);display:flex;">
																				<span style="box-sizing:inherit;outline:currentcolor none 0px;margin-right:14px;">2018年05月16日 14:00:28</span>
					<div style="box-sizing:inherit;outline:currentcolor none 0px;padding:0px;margin:0px;margin-left:auto;float:right;">
						<span style="box-sizing:inherit;outline:currentcolor none 0px;margin-right:14px;">阅读数：169</span>
																	</div>
				</div>
			</div>
			
		</div>
	</div>
	<div style="box-sizing:inherit;outline:currentcolor none 0px;display:block;position:relative;padding-top:16px;">
		<div style="box-sizing:inherit;outline:currentcolor none 0px;padding:0px;margin:0px;word-break:break-all;">
                    
						<div style="box-sizing:inherit;outline:currentcolor none 0px;padding:0px;margin:0px;font-family:-apple-system, SF UI Text, Arial, PingFang SC, Hiragino Sans GB, Microsoft YaHei, WenQuanYi Micro Hei, sans-serif, SimHei, SimSun;word-break:break-all;">
                <p style="outline:currentcolor none 0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;">目标：使用Docker部署Ceph存储集群</p><p style="outline:currentcolor none 0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;">环境：CentOS 7</p><p style="outline:currentcolor none 0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;">步骤：建立Ceph专用网络-&gt;建立Monitor-&gt;建立OSD-&gt;建立RGW并测试对象存储-&gt;建立MDS并测试文件系统-&gt;建立MGR</p><p style="outline:currentcolor none 0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;">前期准备：Linux主机需提前安装Docker</p><p style="outline:currentcolor none 0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;"><strong style="outline:currentcolor none 0px;box-sizing:border-box;font-weight:700;word-break:break-all;">1.建立Ceph专用网络</strong></p><p style="outline:currentcolor none 0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;">为了和docker预设网络区别，新建一个ceph集群专用网络：</p><p style="outline:currentcolor none 0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;"><em style="outline:currentcolor none 0px;box-sizing:border-box;font-style:italic;word-break:break-all;">docker network create --driver bridge ceph-net</em></p><p style="outline:currentcolor none 0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;"><img src="ceph-docker_files/20180516110634407.png" type="image/png" data-filename="20180516110634407.png" alt="" height="27" style="outline:currentcolor none 0px;box-sizing:border-box;margin:0px;word-break:break-all;max-width:100%;cursor:zoom-in;" width="521"/><br style="outline:currentcolor none 0px;box-sizing:border-box;word-break:break-all;"/></p><p style="outline:currentcolor none 0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;"><em style="outline:currentcolor none 0px;box-sizing:border-box;font-style:italic;word-break:break-all;">docker network inspect ceph-net</em></p><p style="outline:currentcolor none 0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;"><img src="ceph-docker_files/20180516110726246.png" type="image/png" data-filename="20180516110726246.png" alt="" height="366" style="outline:currentcolor none 0px;box-sizing:border-box;margin:0px;word-break:break-all;max-width:100%;cursor:zoom-in;" width="535"/><br style="outline:currentcolor none 0px;box-sizing:border-box;word-break:break-all;"/></p><p style="outline:currentcolor none 0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;"><strong style="outline:currentcolor none 0px;box-sizing:border-box;font-weight:700;word-break:break-all;">2.建立Monitor</strong></p><p style="outline:currentcolor none 0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;">完成专用网络构建后，开始部署ceph集群，第一步为启动Ceph Monitor - 集群监控容器。</p><p style="outline:currentcolor none 0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;">Ceph Monitor 维护着展示集群状态的各种图表。</p><p style="outline:currentcolor none 0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;">路径设置：<em style="outline:currentcolor none 0px;box-sizing:border-box;font-style:italic;word-break:break-all;">DIR $(pwd)</em></p><p style="outline:currentcolor none 0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;"><em style="outline:currentcolor none 0px;box-sizing:border-box;font-style:italic;word-break:break-all;">docker run -d --net=ceph-net -v ${DIR}/ceph:/etc/ceph -v ${DIR}/lib/ceph/:/var/lib/ceph/ -e MON_IP=172.19.0.2 -e CEPH_PUBLIC_NETWORK=172.19.0.0/16 --name=mon1 ceph/daemon mon</em></p><p style="outline:currentcolor none 0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;"><img src="ceph-docker_files/20180516112316305.png" type="image/png" data-filename="20180516112316305.png" alt="" height="24" style="outline:currentcolor none 0px;box-sizing:border-box;margin:0px;word-break:break-all;max-width:100%;cursor:zoom-in;" width="712"/><br style="outline:currentcolor none 0px;box-sizing:border-box;word-break:break-all;"/></p><p style="outline:currentcolor none 0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;">查看monitor部署情况：</p><p style="outline:currentcolor none 0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;"><em style="outline:currentcolor none 0px;box-sizing:border-box;font-style:italic;word-break:break-all;">docker exec -ti mon1 ceph -v</em></p><p style="outline:currentcolor none 0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;"><img src="ceph-docker_files/20180516111610915.png" type="image/png" data-filename="20180516111610915.png" alt="" height="27" style="outline:currentcolor none 0px;box-sizing:border-box;margin:0px;word-break:break-all;max-width:100%;cursor:zoom-in;" width="528"/><br style="outline:currentcolor none 0px;box-sizing:border-box;word-break:break-all;"/></p><p style="outline:currentcolor none 0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;"><em style="outline:currentcolor none 0px;box-sizing:border-box;font-style:italic;word-break:break-all;">docker exec -ti mon1 ceph -s</em></p><p style="outline:currentcolor none 0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;"><img src="ceph-docker_files/20180516111644632.png" type="image/png" data-filename="20180516111644632.png" alt="" height="213" style="outline:currentcolor none 0px;box-sizing:border-box;margin:0px;word-break:break-all;max-width:100%;cursor:zoom-in;" width="407"/><br style="outline:currentcolor none 0px;box-sizing:border-box;word-break:break-all;"/></p><p style="outline:currentcolor none 0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;"><strong style="outline:currentcolor none 0px;box-sizing:border-box;font-weight:700;word-break:break-all;">3.建立OSD</strong></p><p style="outline:currentcolor none 0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;">Ceph OSD为对象存储守护进程，提供实际的存储，默认情况下ceph集群需要部署3个OSD。</p><p style="outline:currentcolor none 0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;">环境准备：为Linux主机添加3块20GB硬盘(/dev/vdb、/dev/vdc、/dev/vdd)</p><p style="outline:currentcolor none 0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;"><em style="outline:currentcolor none 0px;box-sizing:border-box;font-style:italic;word-break:break-all;">docker run -d --net=ceph-net --privileged=true --pid=host -v ${DIR}/ceph:/etc/ceph -v ${DIR}/lib/ceph/:/var/lib/ceph/ -v /dev/:/dev/ -e OSD_DEVICE=/dev/vdb -e OSD_TYPE=disk -e OSD_FORCE_ZAP=1 --name osd1 ceph/daemon osd</em></p><p style="outline:currentcolor none 0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;"><img src="ceph-docker_files/20180516112202970.png" type="image/png" data-filename="20180516112202970.png" alt="" height="24" style="outline:currentcolor none 0px;box-sizing:border-box;margin:0px;word-break:break-all;max-width:100%;cursor:zoom-in;" width="712"/><br style="outline:currentcolor none 0px;box-sizing:border-box;word-break:break-all;"/></p><p style="outline:currentcolor none 0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;">查看osd部署情况：</p><p style="outline:currentcolor none 0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;"><em style="outline:currentcolor none 0px;box-sizing:border-box;font-style:italic;word-break:break-all;">docker exec -ti osd1 df | grep &quot;osd&quot;</em></p><p style="outline:currentcolor none 0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;"><img src="ceph-docker_files/2018051611272730.png" type="image/png" data-filename="2018051611272730.png" alt="" height="28" style="outline:currentcolor none 0px;box-sizing:border-box;margin:0px;word-break:break-all;max-width:100%;cursor:zoom-in;" width="475"/><br style="outline:currentcolor none 0px;box-sizing:border-box;word-break:break-all;"/></p><p style="outline:currentcolor none 0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;"><em style="outline:currentcolor none 0px;box-sizing:border-box;font-style:italic;word-break:break-all;">docker exec -ti mon1 ceph -s</em></p><p style="outline:currentcolor none 0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;"><img src="ceph-docker_files/20180516112855849.png" type="image/png" data-filename="20180516112855849.png" alt="" height="227" style="outline:currentcolor none 0px;box-sizing:border-box;margin:0px;word-break:break-all;max-width:100%;cursor:zoom-in;" width="416"/><br style="outline:currentcolor none 0px;box-sizing:border-box;word-break:break-all;"/></p><p style="outline:currentcolor none 0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;">osd2与osd3部署过程类似，只需将/dev设备换成对应的即可。</p><p style="outline:currentcolor none 0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;"><strong style="outline:currentcolor none 0px;box-sizing:border-box;font-weight:700;word-break:break-all;">4.建立RGW并测试对象存储</strong></p><p style="outline:currentcolor none 0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;">Ceph RGW - Rados网关：提供S3与Swift相容的API，存储数据至对象存储。</p><p style="outline:currentcolor none 0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;"><em style="outline:currentcolor none 0px;box-sizing:border-box;font-style:italic;word-break:break-all;">docker run -d --net=ceph-net -v ${DIR}/lib/ceph/:/var/lib/ceph/  -v ${DIR}/ceph:/etc/ceph -p 8080:8080 --name=rgw1 ceph/daemon rgw</em></p><p style="outline:currentcolor none 0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;"><img src="ceph-docker_files/20180516113504525.png" type="image/png" data-filename="20180516113504525.png" alt="" height="19" style="outline:currentcolor none 0px;box-sizing:border-box;margin:0px;word-break:break-all;max-width:100%;cursor:zoom-in;" width="712"/><br style="outline:currentcolor none 0px;box-sizing:border-box;word-break:break-all;"/></p><p style="outline:currentcolor none 0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;">curl工具测试部署情况：</p><p style="outline:currentcolor none 0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;"><em style="outline:currentcolor none 0px;box-sizing:border-box;font-style:italic;word-break:break-all;">curl -H &quot;Content-Type: application/json&quot; &quot;http://127.0.0.1:8080&quot;</em></p><p style="outline:currentcolor none 0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;"><img src="ceph-docker_files/20180516125201952.png" type="image/png" data-filename="20180516125201952.png" alt="" height="40" style="outline:currentcolor none 0px;box-sizing:border-box;margin:0px;word-break:break-all;max-width:100%;cursor:zoom-in;" width="673"/><br style="outline:currentcolor none 0px;box-sizing:border-box;word-break:break-all;"/></p><p style="outline:currentcolor none 0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;">下载测试文件：</p><p style="outline:currentcolor none 0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;"><em style="outline:currentcolor none 0px;box-sizing:border-box;font-style:italic;word-break:break-all;">wget &quot;https://gist.githubusercontent.com/kairen/e0dec164fa6664f40784f303076233a5/raw/33add5a18cb7d6f18531d8d481562d017557747c/s3client&quot;</em><br style="outline:currentcolor none 0px;box-sizing:border-box;word-break:break-all;"/></p><p style="outline:currentcolor none 0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;">chmod u+x s3clinet</p><p style="outline:currentcolor none 0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;">安装执行依赖：</p><p style="outline:currentcolor none 0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;"><em style="outline:currentcolor none 0px;box-sizing:border-box;font-style:italic;word-break:break-all;">yum install python-pip</em></p><p style="outline:currentcolor none 0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;"><em style="outline:currentcolor none 0px;box-sizing:border-box;font-style:italic;word-break:break-all;">pip install boto</em></p><p style="outline:currentcolor none 0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;">对象存储测试：</p><p style="outline:currentcolor none 0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;">(1)创建一个使用者</p><p style="outline:currentcolor none 0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;"><em style="outline:currentcolor none 0px;box-sizing:border-box;font-style:italic;word-break:break-all;">docker exec -ti rgw1 radosgw-admin user create --uid=&quot;test&quot; --display-name=&quot;I'm Test account&quot; --email=&quot;test@example.com&quot;</em></p><p style="outline:currentcolor none 0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;"><img src="ceph-docker_files/20180516130147362.png" type="image/png" data-filename="20180516130147362.png" alt="" height="381" style="outline:currentcolor none 0px;box-sizing:border-box;margin:0px;word-break:break-all;max-width:100%;cursor:zoom-in;" width="712"/><br style="outline:currentcolor none 0px;box-sizing:border-box;word-break:break-all;"/></p><p style="outline:currentcolor none 0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;">(2)创建环境参数配置文件</p><p style="outline:currentcolor none 0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;"><em style="outline:currentcolor none 0px;box-sizing:border-box;font-style:italic;word-break:break-all;">vim s3key.sh</em></p><p style="outline:currentcolor none 0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;"><img src="ceph-docker_files/20180516134219789.png" type="image/png" data-filename="20180516134219789.png" alt="" height="58" style="outline:currentcolor none 0px;box-sizing:border-box;margin:0px;word-break:break-all;max-width:100%;cursor:zoom-in;" width="414"/><br style="outline:currentcolor none 0px;box-sizing:border-box;word-break:break-all;"/></p><p style="outline:currentcolor none 0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;">key信息对照test用户</p><p style="outline:currentcolor none 0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;">(3)列出当前bucket</p><p style="outline:currentcolor none 0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;"><em style="outline:currentcolor none 0px;box-sizing:border-box;font-style:italic;word-break:break-all;">./s3client list</em></p><p style="outline:currentcolor none 0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;"><img src="ceph-docker_files/20180516134239465.png" type="image/png" data-filename="20180516134239465.png" alt="" height="24" style="outline:currentcolor none 0px;box-sizing:border-box;margin:0px;word-break:break-all;max-width:100%;cursor:zoom-in;" width="333"/><br style="outline:currentcolor none 0px;box-sizing:border-box;word-break:break-all;"/></p><p style="outline:currentcolor none 0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;">(4)创建一个bucket并上传文件</p><p style="outline:currentcolor none 0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;"><em style="outline:currentcolor none 0px;box-sizing:border-box;font-style:italic;word-break:break-all;">./s3client create files</em></p><p style="outline:currentcolor none 0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;"><img src="ceph-docker_files/20180516134418724.png" type="image/png" data-filename="20180516134418724.png" alt="" height="27" style="outline:currentcolor none 0px;box-sizing:border-box;margin:0px;word-break:break-all;max-width:100%;cursor:zoom-in;" width="377"/><br style="outline:currentcolor none 0px;box-sizing:border-box;word-break:break-all;"/></p><p style="outline:currentcolor none 0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;"><em style="outline:currentcolor none 0px;box-sizing:border-box;font-style:italic;word-break:break-all;">./s3client upload files s3key.sh /</em></p><p style="outline:currentcolor none 0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;"><img src="ceph-docker_files/20180516134445927.png" type="image/png" data-filename="20180516134445927.png" alt="" height="29" style="outline:currentcolor none 0px;box-sizing:border-box;margin:0px;word-break:break-all;max-width:100%;cursor:zoom-in;" width="449"/><br style="outline:currentcolor none 0px;box-sizing:border-box;word-break:break-all;"/></p><p style="outline:currentcolor none 0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;"><em style="outline:currentcolor none 0px;box-sizing:border-box;font-style:italic;word-break:break-all;">./s3client list files</em></p><p style="outline:currentcolor none 0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;"><img src="ceph-docker_files/20180516134602734.png" type="image/png" data-filename="20180516134602734.png" alt="" height="40" style="outline:currentcolor none 0px;box-sizing:border-box;margin:0px;word-break:break-all;max-width:100%;cursor:zoom-in;" width="477"/><br style="outline:currentcolor none 0px;box-sizing:border-box;word-break:break-all;"/></p><p style="outline:currentcolor none 0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;"><strong style="outline:currentcolor none 0px;box-sizing:border-box;font-weight:700;word-break:break-all;">5.建立MDS并测试文件系统</strong></p><p style="outline:currentcolor none 0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;">Ceph MDS - 元数据服务器，为ceph文件系统存储元数据。</p><p style="outline:currentcolor none 0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;"><em style="outline:currentcolor none 0px;box-sizing:border-box;font-style:italic;word-break:break-all;">docker run -d --net=ceph-net -v ${DIR}/lib/ceph/:/var/lib/ceph/ -v ${DIR}/ceph:/etc/ceph -e CEPHFS_CREATE=1 --name=mds1 ceph/daemon mds</em></p><p style="outline:currentcolor none 0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;"><img src="ceph-docker_files/20180516134810165.png" type="image/png" data-filename="20180516134810165.png" alt="" height="17" style="outline:currentcolor none 0px;box-sizing:border-box;margin:0px;word-break:break-all;max-width:100%;cursor:zoom-in;" width="712"/><br style="outline:currentcolor none 0px;box-sizing:border-box;word-break:break-all;"/></p><p style="outline:currentcolor none 0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;">查看部署情况：</p><p style="outline:currentcolor none 0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;"><em style="outline:currentcolor none 0px;box-sizing:border-box;font-style:italic;word-break:break-all;">docker exec -ti mds1 ceph mds stat</em></p><p style="outline:currentcolor none 0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;"><img src="ceph-docker_files/20180516135045304.png" type="image/png" data-filename="20180516135045304.png" alt="" height="27" style="outline:currentcolor none 0px;box-sizing:border-box;margin:0px;word-break:break-all;max-width:100%;cursor:zoom-in;" width="450"/><br style="outline:currentcolor none 0px;box-sizing:border-box;word-break:break-all;"/></p><p style="outline:currentcolor none 0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;"><em style="outline:currentcolor none 0px;box-sizing:border-box;font-style:italic;word-break:break-all;">docker exec -ti mds1 ceph fs ls</em></p><p style="outline:currentcolor none 0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;"><img src="ceph-docker_files/20180516135057203.png" type="image/png" data-filename="20180516135057203.png" alt="" height="27" style="outline:currentcolor none 0px;box-sizing:border-box;margin:0px;word-break:break-all;max-width:100%;cursor:zoom-in;" width="472"/><br style="outline:currentcolor none 0px;box-sizing:border-box;word-break:break-all;"/></p><p style="outline:currentcolor none 0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;"><strong style="outline:currentcolor none 0px;box-sizing:border-box;font-weight:700;word-break:break-all;">6.建立MGR</strong></p><p style="outline:currentcolor none 0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;">Ceph MGR - 集群管理组件</p><p style="outline:currentcolor none 0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;"><em style="outline:currentcolor none 0px;box-sizing:border-box;font-style:italic;word-break:break-all;">docker run -d --net=ceph-net -v ${DIR}/ceph:/etc/ceph -v ${DIR}/lib/ceph/:/var/lib/ceph/ --name=mgr1 ceph/daemon mgr</em></p><p style="outline:currentcolor none 0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;"><img src="ceph-docker_files/20180516135728441.png" type="image/png" data-filename="20180516135728441.png" alt="" height="20" style="outline:currentcolor none 0px;box-sizing:border-box;margin:0px;word-break:break-all;max-width:100%;cursor:zoom-in;" width="712"/><br style="outline:currentcolor none 0px;box-sizing:border-box;word-break:break-all;"/></p><p style="outline:currentcolor none 0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;"><em style="outline:currentcolor none 0px;box-sizing:border-box;font-style:italic;word-break:break-all;">docker ps</em></p><p style="outline:currentcolor none 0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;"><img src="ceph-docker_files/20180516135834631.png" type="image/png" data-filename="20180516135834631.png" alt="" height="102" style="outline:currentcolor none 0px;box-sizing:border-box;margin:0px;word-break:break-all;max-width:100%;cursor:zoom-in;" width="712"/><br style="outline:currentcolor none 0px;box-sizing:border-box;word-break:break-all;"/></p><p style="outline:currentcolor none 0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;"><em style="outline:currentcolor none 0px;box-sizing:border-box;font-style:italic;word-break:break-all;">docker exec -it mon1 ceph -s</em></p><p style="outline:currentcolor none 0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;"><img src="ceph-docker_files/20180516135912609.png" type="image/png" data-filename="20180516135912609.png" alt="" height="245" style="outline:currentcolor none 0px;box-sizing:border-box;margin:0px;word-break:break-all;max-width:100%;cursor:zoom-in;" width="401"/><br style="outline:currentcolor none 0px;box-sizing:border-box;word-break:break-all;"/></p><p style="outline:currentcolor none 0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;">以上，Ceph集群容器化部署完成。</p><p style="outline:currentcolor none 0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;"><br style="outline:currentcolor none 0px;box-sizing:border-box;word-break:break-all;"/></p><p style="outline:currentcolor none 0px;padding:0px;box-sizing:border-box;margin:0px 0px 16px;font-size:16px;color:rgb(79, 79, 79);font-weight:400;line-height:26px;text-align:justify;word-break:break-all;"><br style="outline:currentcolor none 0px;box-sizing:border-box;word-break:break-all;"/></p>            </div>
                <span style="display:block;height:0px;visibility:hidden;clear:both;"></span></div>
				
        	</div>
	
		<div style="box-sizing:inherit;outline:currentcolor none 0px;padding:0px;margin:0px;padding-bottom:16px;margin-top:16px;border-bottom:1px solid rgb(227, 227, 227);position:relative;height:55px;overflow:hidden;">
				<div style="box-sizing:inherit;outline:currentcolor none 0px;padding:0px;margin:0px;font-size:12px;color:rgb(153, 153, 153);">
			版权声明：本文为博主原创文章，未经博主允许不得转载。			https://blog.csdn.net/xingyuzhe/article/details/80324323		</div>
						<div style="box-sizing:inherit;outline:currentcolor none 0px;padding:0px;margin:0px;margin-bottom:8px;font-size:12px;margin-top:8px;">
			<span style="box-sizing:inherit;outline:currentcolor none 0px;color:rgb(77, 77, 77);">文章标签：</span>
						<a href="http://so.csdn.net/so/search/s.do?q=ceph&amp;t=blog" style="box-sizing:inherit;outline:currentcolor none 0px;text-decoration:none;cursor:pointer;display:inline-block;word-break:break-all;margin-right:8px;padding:0px 8px;height:24px;min-width:24px;line-height:24px;border:1px solid rgb(204, 204, 204);border-radius:100px;color:rgb(77, 77, 77);text-align:center;" target="_blank">ceph						</a><a href="http://so.csdn.net/so/search/s.do?q=docker&amp;t=blog" style="box-sizing:inherit;outline:currentcolor none 0px;text-decoration:none;cursor:pointer;display:inline-block;word-break:break-all;margin-right:8px;padding:0px 8px;height:24px;min-width:24px;line-height:24px;border:1px solid rgb(204, 204, 204);border-radius:100px;color:rgb(77, 77, 77);text-align:center;" target="_blank">docker						</a>
		</div>
						<div style="box-sizing:inherit;outline:currentcolor none 0px;padding:0px;margin:0px;margin-bottom:8px;font-size:12px;">
			<span style="box-sizing:inherit;outline:currentcolor none 0px;color:rgb(77, 77, 77);">个人分类：</span>
						<a href="https://blog.csdn.net/xingyuzhe/article/category/7662168" style="box-sizing:inherit;outline:currentcolor none 0px;text-decoration:none;cursor:pointer;display:inline-block;margin-right:24px;color:rgb(121, 165, 229);word-break:break-all;" target="_blank">Ceph						</a>
		</div>
					<div style="box-sizing:inherit;outline:currentcolor none 0px;margin:0px;position:absolute;font-size:12px;color:rgb(51, 153, 234);letter-spacing:0px;line-height:20px;cursor:pointer;padding:4px 4px 4px 16px;background-color:rgb(255, 255, 255);left:174px;width:auto;top:25px;">▼查看关于本篇文章更多信息</div></div>
	</div></span></div></div></div></div><br/></div></span>
</div></body></html> 