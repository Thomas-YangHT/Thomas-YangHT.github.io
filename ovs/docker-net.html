<html>
<head>
  <title>Evernote Export</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/307027 (zh-CN, DDL); Windows/10.0.0 (Win64);"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="1831"/>

<div>
<span><div><div>#Docker 主机间网络的四种打通方式</div><div><span style="font-weight: bold;">1静态路由;</span></div><div><span style="font-weight: bold;">2.ovswitch大二层</span></div><div><span style="font-weight: bold;">3.flaneld路由+隧道</span></div><div><span style="font-weight: bold;">4quagga动态路由</span></div><div><br/></div><div>四种方式：</div><div><a href="http://f.dataguru.cn/thread-576199-1-2.html">http://f.dataguru.cn/thread-576199-1-2.html</a></div><div><br/></div><div><img src="docker-net_files/Image.png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div><br/></div><div><hr/></div><div>前言：前面的部分一直都是单机跑docker，但实际生产环境不可能只用一台来跑。肯定会用到多台，因为他们都是内部私有ip，那么多台主机之间的容器如何通信？这个是个很头疼的问题！目前主流几种方法如下：</div><div>1、使用路由机制打通网络</div><div>2、使用Open vSwitch（OVS）打通网络</div><div>3、使用flannel来打通网络</div><div>4、使用Quagga来实现自动学习路由</div><div><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: 微软雅黑, 宋体; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(241, 241, 241);"/></div><div><span style="font-weight: bold;">第一种：</span><span style="font-weight: bold;">使用路由机制打通网络</span></div><div>使用<a href="http://www.dataguru.cn/article-4696-1.html?union_site=innerlink" style="text-decoration: underline;">Linux</a>的路由来打通网络</div><div>优点：</div><ul><li><div>常规路由技术</div></li><li><div>使用传统网络技术</div></li><li><div>简单</div></li><li><div>高性能</div></li></ul><div><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: 微软雅黑, 宋体; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(241, 241, 241);"/></div><div>缺点：</div><ul><li><div>与现有网络融为一体</div></li><li><div>灵活性低</div></li></ul><div><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: 微软雅黑, 宋体; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(241, 241, 241);"/></div><div>现在有两台Docker实例：</div><div><img src="docker-net_files/Image [1].png" type="image/png" data-filename="Image.png" style="word-wrap: break-word; cursor: pointer; max-width: 700px;" width="600"/></div><div>file:///C:/Users/Don/Documents/My%20Knowledge/temp/d12921d0-891e-4a7f-9f37-4addd92a86fc_128_files/6325797f-dd7c-433e-aacc-dd447f7cbbaf.png</div><div><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: 微软雅黑, 宋体; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(241, 241, 241);"/></div><div>具体如图，因为Docker默认的内部ip为172.17.42网段，所以必须要修改其中一台的默认网段以免ip冲突。</div><div>#vim /etc/sysconfig/docker-network</div><div><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: 微软雅黑, 宋体; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(241, 241, 241);"/></div><div>DOCKER_NETWORK_OPTIONS= --bip=172.18.42.1/16 -H fd:// -H=unix:///var/run/docker.sock</div><div><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: 微软雅黑, 宋体; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(241, 241, 241);"/></div><div>#systemctl daemon-reload</div><div>#reboot</div><div><img src="docker-net_files/Image [2].png" type="image/png" data-filename="Image.png" style="word-wrap: break-word; cursor: pointer; max-width: 700px;" width="578"/></div><div>file:///C:/Users/Don/Documents/My%20Knowledge/temp/d12921d0-891e-4a7f-9f37-4addd92a86fc_128_files/96e55b20-d530-4526-ac7a-7763b2628350.png</div><div><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: 微软雅黑, 宋体; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(241, 241, 241);"/></div><div>ok。现在就可以开始操作了。</div><div>其实就是执行两台route add命令</div><div>docker 130上执行 route add -net 172.18.0.0/16 gw 192.168.18.128</div><div>docker 128上执行 route add -net 172.17.0.0/16 gw 192.168.18.130</div><div>ok，现在两台宿主机里的容器就可以通信了。</div><div><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: 微软雅黑, 宋体; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(241, 241, 241);"/></div><div><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: 微软雅黑, 宋体; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(241, 241, 241);"/></div><div><span style="font-weight: bold;">第二种：</span><span style="font-weight: bold;">使用Open vSwitch（OVS）打通网络</span></div><div>是一种主流的虚拟化大二层技术</div><div>优点：</div><ul><li><div>灵活</div></li><li><div>对现有物理网络没要求</div></li><li><div>业界主流</div></li></ul><div><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: 微软雅黑, 宋体; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(241, 241, 241);"/></div><div>缺点：</div><ul><li><div>软件封装导致性能下降</div></li><li><div>复杂度相对较高</div></li><li><div>排错难度高</div></li></ul><div><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: 微软雅黑, 宋体; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(241, 241, 241);"/></div><div>流程图如下：</div><div><img src="docker-net_files/Image [3].png" type="image/png" data-filename="Image.png" style="word-wrap: break-word; cursor: pointer; max-width: 700px;" width="600"/></div><div><img src="docker-net_files/Image [4].png" type="image/png" data-filename="Image.png" style="word-wrap: break-word; cursor: pointer; max-width: 700px;" width="600"/></div><div>file:///C:/Users/Don/Documents/My%20Knowledge/temp/d12921d0-891e-4a7f-9f37-4addd92a86fc_128_files/75f44505-cf9f-47bf-bc49-8fa40b8d3f03.png</div><div><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: 微软雅黑, 宋体; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(241, 241, 241);"/></div><div>file:///C:/Users/Don/Documents/My%20Knowledge/temp/d12921d0-891e-4a7f-9f37-4addd92a86fc_128_files/33f2ed6e-ad14-4839-87ac-ad43333d8c3d.png</div><div><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: 微软雅黑, 宋体; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(241, 241, 241);"/></div><div>首先安装ovs的rpm包</div><div><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: 微软雅黑, 宋体; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(241, 241, 241);"/></div><div><a href="http://f.dataguru.cn/wiz://open_attachment?guid=32ffdc1f-9df9-4f53-9470-a87a2aa2da50" style="text-decoration: underline;">file:///C:/Users/Don/Documents/My%20Knowledge/temp/d12921d0-891e-4a7f-9f37-4addd92a86fc_128_files/267978203.png</a></div><div><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: 微软雅黑, 宋体; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(241, 241, 241);"/></div><div># yum install openvswitch-2.4.0-1.x86_64.rpm    #安装软件包</div><div># /etc/init.d/openvswitch restart               #重启服务</div><div># /etc/init.d/openvswitch status                #查看状态</div><div>安装网桥管理工具</div><div><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: 微软雅黑, 宋体; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(241, 241, 241);"/></div><div>#yum -y install bridge-utils</div><div><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: 微软雅黑, 宋体; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(241, 241, 241);"/></div><div>配置网络</div><div>ovs-vsctl add-br br0</div><div>ovs-vsctl add-port br0 gre1 -- set interface gre1 type=gre option:remote_ip=192.168.18.128</div><div>#添加br0到本地docker0，使得容器流量通过ovs流经tunnel</div><div>brctl addif docker0 br0</div><div><br style="word-wrap: break-word;"/></div><div>ip link set dev br0 up</div><div>ip link set dev docker0 up</div><div>iptables -t nat -F; iptables -F</div><div>ip route add 172.17.0.0/16 dev docker0</div><div><br style="word-wrap: break-word;"/></div><div>其余节点同样的配置，注意ip地址即可。</div><div><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: 微软雅黑, 宋体; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(241, 241, 241);"/></div><div><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: 微软雅黑, 宋体; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(241, 241, 241);"/></div><div><span style="font-weight: bold;">第三种：</span><span style="font-weight: bold;">使用flannel来打通网络</span></div><div>新设计的Flannel，一种结合了路由机制与隧道技术</div><div>原理：每个主机配置一个ip段和子网个数。例如，可以配置一个覆盖网络使用 10.100.0.0/16段，每个主机/24个子网。因此主机a可以接受10.100.5.0/24，主机B可以接受10.100.18.0/24的包。flannel使用etcd来维护分配的子网到实际的ip地址之间的映射。对于数据路径，flannel 使用udp来封装ip数据报，转发到远程主机。选择UDP作为转发协议是因为他能穿透防火墙。例如，AWS Classic无法转发IPoIP or GRE 网络包，是因为它的安全组仅仅支持TCP/UDP/ICMP。</div><div>下图解释了数据报通过覆盖网络转发的路线：</div><div><img src="docker-net_files/Image.jpg" type="image/jpeg" data-filename="Image.jpg" style="word-wrap: break-word; cursor: pointer; max-width: 700px;" width="600"/></div><div><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: 微软雅黑, 宋体; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(241, 241, 241);"/></div><div>file:///C:/Users/Don/Documents/My%20Knowledge/temp/d12921d0-891e-4a7f-9f37-4addd92a86fc_128_files/b0997f01-6d7f-4265-993d-f17bde472efc.jpg</div><div><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: 微软雅黑, 宋体; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(241, 241, 241);"/></div><div>部署也不是很复杂，仅需要etcd和flannel两项支持即可。</div><div>etcd一般部署在单独机器上，那么flannel就部署在docker节点上，每个docker节点上都需部署。</div><div>1、部署etcd，假设地址为192.168.1.121</div><div>yum -y install etcd                                                            #安装软件包</div><div>vim /etc/etcd/etcd.conf                                                        #修改配置文件</div><div>修改为如下：（默认只监听本地回环地址）</div><div>    ETCD_LISTEN_CLIENT_URLS=&quot;http://0.0.0.0:2379&quot;</div><div>    ETCD_ADVERTISE_CLIENT_URLS=&quot;<a href="http://0.0.0.0:2379%22/" style="text-decoration: underline;">http://0.0.0.0:2379&quot;</a></div><div>systemctl restart etcd                                                         #重启服务</div><div>etcdctl set /<a href="http://coreos.com/network/config">coreos.com/network/config</a> '{ &quot;Network&quot;: &quot;10.1.0.0/16&quot; }'          #添加一条网络配置记录，这个配置将用于flannel分配给每个Docker的虚拟IP地址段</div><div><br style="word-wrap: break-word;"/></div><div>2、部署flannel</div><div><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: 微软雅黑, 宋体; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(241, 241, 241);"/></div><div>从<a href="https://github.com/coreos/flannel/releases" style="text-decoration: underline;">https://github.com/coreos/flannel/releases</a> 下载稳定版本，这里以0.5.5版本为例。</div><div>tar zxf flannel-0.5.5-linux-amd64.tar.gz      #解压文件</div><div>cp flannel-0.5.5/* /usr/bin/                  #拷贝可执行文件至系统变量path</div><div><br style="word-wrap: break-word;"/></div><div>使用systemd来管理flannel服务</div><div><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: 微软雅黑, 宋体; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(241, 241, 241);"/></div><div>vim /usr/lib/systemd/system/flanneld.service</div><div><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: 微软雅黑, 宋体; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(241, 241, 241);"/></div><div>[Unit]</div><div>Description=Flanneld overlay address etcd agent</div><div>After=network.target</div><div>Before=docker.service</div><div>[Service]</div><div>Type=notify</div><div>EnvironmentFile=/etc/sysconfig/flanneld</div><div>EnvironmentFile=-/etc/sysconfig/docker-network</div><div>ExecStart=/usr/bin/flanneld -etcd-endpoints=${FLANNEL_ETCD} $FLANNEL_OPTIONS</div><div>[Install]</div><div>RequiredBy=docker.service</div><div>WantedBy=multi-user.target</div><div><br style="word-wrap: break-word;"/></div><div>设置etcd地址</div><div><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: 微软雅黑, 宋体; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(241, 241, 241);"/></div><div>vim /etc/sysconfig/flanneld</div><div>FLANNEL_ETCD= &quot;http://192.168.1.121:2379&quot;</div><div><br style="word-wrap: break-word;"/></div><div>由于flannel将覆盖docker0网桥，所以如果Docker服务已启动，则停止Docker服务</div><div><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: 微软雅黑, 宋体; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(241, 241, 241);"/></div><div>编写flannel启动脚本，并加入自启动</div><div>vim /etc/init.d/start_flannel.sh</div><div>#!/bin/bash</div><div>systemctl stop docker                     #停止docker服务</div><div>systemctl restart flanneld                #启动flannel服务</div><div>mk-docker-opts.sh -i                      #生成环境变量</div><div>source /run/flannel/subnet.env            #将环境变量生效</div><div>ifconfig docker0 ${FLANNEL_SUBNET}        #设置docker0的网卡ip</div><div>systemctl start docker                    #启动docker服务</div><div><br style="word-wrap: break-word;"/></div><div>ok，现在跨主机容器间已经可以通信。</div><div><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: 微软雅黑, 宋体; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(241, 241, 241);"/></div><div><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: 微软雅黑, 宋体; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(241, 241, 241);"/></div><div><span style="font-weight: bold;">第四种：</span><span style="font-weight: bold;">使用Quagga来实现自动学习路由</span></div><div><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: 微软雅黑, 宋体; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(241, 241, 241);"/></div><div>其实这种方式是基于第一种方式的路由技术，只不过路由信息不需要自己手动添加，而是自动学习。试想一下，如果有10台docker，那么每台docker就需要手动写9条路由信息，是不是很惨？</div><div>Linux上安装路由器的软件名为Quagga，它可以配置很多种企业级的动态路由协议。我使用的是RIPV2和OSPF同时开启，但安装Quagga的方法和配置命令，太过于繁琐。所以网上有大神将其Docker化了。</div><div><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: 微软雅黑, 宋体; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(241, 241, 241);"/></div><div>下载Quagga镜像：</div><div>docker pull index.alauda.cn/georce/router</div><div><br style="word-wrap: break-word;"/></div><div><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: 微软雅黑, 宋体; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(241, 241, 241);"/></div><div>备用地址：<a href="http://pan.baidu.com/s/1sj26X8T" style="text-decoration: underline;">http://pan.baidu.com/s/1sj26X8T</a></div><div>特别需要注意的是：docker0的网段不能一样，所以需要修改docker的子网地址，参考第一种的设置办法</div><div>运行镜像：</div><div>docker run -itd --name=router --privileged --net=host index.alauda.cn/georce/router</div><div><br style="word-wrap: break-word;"/></div><div>执行 ip route 查看下路由表，已有别的docker0的网段信息。</div><div><img src="docker-net_files/Image [5].png" type="image/png" data-filename="Image.png" style="word-wrap: break-word; cursor: pointer; max-width: 700px;" width="600"/></div><div><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: 微软雅黑, 宋体; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(241, 241, 241);"/></div><div>file:///C:/Users/Don/Documents/My%20Knowledge/temp/d12921d0-891e-4a7f-9f37-4addd92a86fc_128_files/4ee4e27c-94ed-4b68-8cd3-838467346fe3.png</div><div><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: 微软雅黑, 宋体; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(241, 241, 241);"/></div><div>file:///C:/Users/Don/Documents/My%20Knowledge/temp/d12921d0-891e-4a7f-9f37-4addd92a86fc_128_files/cd3ce34f-621a-488b-818d-ff2c69e365f0.png</div><div><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: 微软雅黑, 宋体; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(241, 241, 241);"/></div><div><img src="docker-net_files/Image [6].png" type="image/png" data-filename="Image.png" style="word-wrap: break-word; cursor: pointer; max-width: 700px;" width="600"/></div><div><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: 微软雅黑, 宋体; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(241, 241, 241);"/></div><div><br style="word-wrap: break-word; color: rgb(68, 68, 68); font-family: 微软雅黑, 宋体; font-size: 14px; font-variant-ligatures: normal; font-variant-caps: normal; letter-spacing: normal; orphans: 2; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background-color: rgb(241, 241, 241);"/></div><div><br/></div></div><div><br/></div></span>
</div></body></html> 